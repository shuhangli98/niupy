import numpy as np
import scipy
import time

from functools import reduce

from niupy.eom_tools import *

def get_template_c(nlow, ncore, nocc, nact, nvir):
    c = {
         'ICA': np.zeros((nlow, ncore, nocc, nact)),
         'IIA': np.zeros((nlow, ncore, ncore, nact)),
         'I': np.zeros((nlow, ncore)),
         'IAV': np.zeros((nlow, ncore, nact, nvir)),
         'ICV': np.zeros((nlow, ncore, nocc, nvir)),
         'IIV': np.zeros((nlow, ncore, ncore, nvir)),
         'iAa': np.zeros((nlow, ncore, nact, nact)),
         'iCa': np.zeros((nlow, ncore, nocc, nact)),
         'cIa': np.zeros((nlow, nocc, ncore, nact)),
         'iIa': np.zeros((nlow, ncore, ncore, nact)),
         'iAv': np.zeros((nlow, ncore, nact, nvir)),
         'iCv': np.zeros((nlow, ncore, nocc, nvir)),
         'aIv': np.zeros((nlow, nact, ncore, nvir)),
         'cIv': np.zeros((nlow, nocc, ncore, nvir)),
         'iIv': np.zeros((nlow, ncore, ncore, nvir)),
         'IAA': np.zeros((nlow, ncore, nact, nact)),
         'aIa': np.zeros((nlow, nact, ncore, nact)),
        }
    return c

def get_S12(eom_dsrg):
    einsum = eom_dsrg.einsum
    template_c = eom_dsrg.template_c
    gamma1 = eom_dsrg.gamma1
    eta1 = eom_dsrg.eta1
    lambda2 = eom_dsrg.lambda2
    lambda3 = eom_dsrg.lambda3
    lambda4 = eom_dsrg.lambda4
    tol = eom_dsrg.tol_s
    tol_semi = eom_dsrg.tol_semi
    num_ortho = 0
    sigma = {}
    c = {}
    # ICA block
    if eom_dsrg.verbose: print("Starts ICA block")
    shape_block = template_c['ICA'].shape[1:]
    shape_size = np.prod(shape_block)
    c['ICA'] = np.zeros((shape_size, *shape_block))
    sigma['ICA'] = np.zeros((shape_size, *shape_block))
    c_vec = dict_to_vec(c, shape_size)
    np.fill_diagonal(c_vec, 1)
    c = vec_to_dict(c, c_vec)
    del c_vec
    c = antisymmetrize(c, ea=False)
    if eom_dsrg.verbose: print('Starts contraction')
    sigma['ICA'] += +1.00000000 * np.einsum('pCKA,AO->pCKO',c['ICA'],eta1['AA'],optimize=True)
    sigma = antisymmetrize(sigma, ea=False)
    c.clear()
    vec = dict_to_vec(sigma, shape_size)
    sigma.clear()
    if eom_dsrg.verbose: print('Starts diagonalization', flush = True)
    sevals, sevecs = np.linalg.eigh(vec)
    if np.any(sevals < -tol):
        raise ValueError('Negative overlap eigenvalues found in ICA block')
    del vec
    if eom_dsrg.verbose: print('Diagonalization done')
    trunc_indices = np.where(sevals > tol)[0]
    eom_dsrg.S12.ICA = sevecs[:, trunc_indices] / np.sqrt(sevals[trunc_indices])
    num_ortho += eom_dsrg.S12.ICA.shape[1]
    del sevals, sevecs, trunc_indices

    # IIA block
    if eom_dsrg.verbose: print("Starts IIA block")
    shape_block = template_c['IIA'].shape[1:]
    shape_size = np.prod(shape_block)
    c['IIA'] = np.zeros((shape_size, *shape_block))
    sigma['IIA'] = np.zeros((shape_size, *shape_block))
    c_vec = dict_to_vec(c, shape_size)
    np.fill_diagonal(c_vec, 1)
    c = vec_to_dict(c, c_vec)
    del c_vec
    c = antisymmetrize(c, ea=False)
    if eom_dsrg.verbose: print('Starts contraction')
    sigma['IIA'] += +0.50000000 * np.einsum('pCDA,AO->pCDO',c['IIA'],eta1['AA'],optimize=True)
    sigma = antisymmetrize(sigma, ea=False)
    c.clear()
    vec = dict_to_vec(sigma, shape_size)
    sigma.clear()
    if eom_dsrg.verbose: print('Starts diagonalization', flush = True)
    sevals, sevecs = np.linalg.eigh(vec)
    if np.any(sevals < -tol):
        raise ValueError('Negative overlap eigenvalues found in IIA block')
    del vec
    if eom_dsrg.verbose: print('Diagonalization done')
    trunc_indices = np.where(sevals > tol)[0]
    eom_dsrg.S12.IIA = sevecs[:, trunc_indices] / np.sqrt(sevals[trunc_indices])
    num_ortho += eom_dsrg.S12.IIA.shape[1]
    del sevals, sevecs, trunc_indices

    # I block
    if eom_dsrg.verbose: print("Starts I block")
    shape_block = template_c['I'].shape[1:]
    shape_size = np.prod(shape_block)
    c['I'] = np.zeros((shape_size, *shape_block))
    sigma['I'] = np.zeros((shape_size, *shape_block))
    c_vec = dict_to_vec(c, shape_size)
    np.fill_diagonal(c_vec, 1)
    c = vec_to_dict(c, c_vec)
    del c_vec
    c = antisymmetrize(c, ea=False)
    if eom_dsrg.verbose: print('Starts contraction')
    sigma['I'] += +1.00000000 * np.einsum('pC->pC',c['I'],optimize=True)
    sigma = antisymmetrize(sigma, ea=False)
    c.clear()
    vec = dict_to_vec(sigma, shape_size)
    sigma.clear()
    if eom_dsrg.verbose: print('Starts diagonalization', flush = True)
    sevals, sevecs = np.linalg.eigh(vec)
    if np.any(sevals < -tol):
        raise ValueError('Negative overlap eigenvalues found in I block')
    del vec
    if eom_dsrg.verbose: print('Diagonalization done')
    trunc_indices = np.where(sevals > tol)[0]
    eom_dsrg.S12.I = sevecs[:, trunc_indices] / np.sqrt(sevals[trunc_indices])
    num_ortho += eom_dsrg.S12.I.shape[1]
    del sevals, sevecs, trunc_indices

    # IAV block
    if eom_dsrg.verbose: print("Starts IAV block")
    shape_block = template_c['IAV'].shape[1:]
    shape_size = np.prod(shape_block)
    c['IAV'] = np.zeros((shape_size, *shape_block))
    sigma['IAV'] = np.zeros((shape_size, *shape_block))
    c_vec = dict_to_vec(c, shape_size)
    np.fill_diagonal(c_vec, 1)
    c = vec_to_dict(c, c_vec)
    del c_vec
    c = antisymmetrize(c, ea=False)
    if eom_dsrg.verbose: print('Starts contraction')
    sigma['IAV'] += +1.00000000 * np.einsum('pCAE,OA->pCOE',c['IAV'],gamma1['AA'],optimize=True)
    sigma = antisymmetrize(sigma, ea=False)
    c.clear()
    vec = dict_to_vec(sigma, shape_size)
    sigma.clear()
    if eom_dsrg.verbose: print('Starts diagonalization', flush = True)
    sevals, sevecs = np.linalg.eigh(vec)
    if np.any(sevals < -tol):
        raise ValueError('Negative overlap eigenvalues found in IAV block')
    del vec
    if eom_dsrg.verbose: print('Diagonalization done')
    trunc_indices = np.where(sevals > tol)[0]
    eom_dsrg.S12.IAV = sevecs[:, trunc_indices] / np.sqrt(sevals[trunc_indices])
    num_ortho += eom_dsrg.S12.IAV.shape[1]
    del sevals, sevecs, trunc_indices

    # ICV block
    if eom_dsrg.verbose: print("Starts ICV block")
    shape_block = template_c['ICV'].shape[1:]
    shape_size = np.prod(shape_block)
    c['ICV'] = np.zeros((shape_size, *shape_block))
    sigma['ICV'] = np.zeros((shape_size, *shape_block))
    c_vec = dict_to_vec(c, shape_size)
    np.fill_diagonal(c_vec, 1)
    c = vec_to_dict(c, c_vec)
    del c_vec
    c = antisymmetrize(c, ea=False)
    if eom_dsrg.verbose: print('Starts contraction')
    sigma['ICV'] += +1.00000000 * np.einsum('pCKE->pCKE',c['ICV'],optimize=True)
    sigma = antisymmetrize(sigma, ea=False)
    c.clear()
    vec = dict_to_vec(sigma, shape_size)
    sigma.clear()
    if eom_dsrg.verbose: print('Starts diagonalization', flush = True)
    sevals, sevecs = np.linalg.eigh(vec)
    if np.any(sevals < -tol):
        raise ValueError('Negative overlap eigenvalues found in ICV block')
    del vec
    if eom_dsrg.verbose: print('Diagonalization done')
    trunc_indices = np.where(sevals > tol)[0]
    eom_dsrg.S12.ICV = sevecs[:, trunc_indices] / np.sqrt(sevals[trunc_indices])
    num_ortho += eom_dsrg.S12.ICV.shape[1]
    del sevals, sevecs, trunc_indices

    # IIV block
    if eom_dsrg.verbose: print("Starts IIV block")
    shape_block = template_c['IIV'].shape[1:]
    shape_size = np.prod(shape_block)
    c['IIV'] = np.zeros((shape_size, *shape_block))
    sigma['IIV'] = np.zeros((shape_size, *shape_block))
    c_vec = dict_to_vec(c, shape_size)
    np.fill_diagonal(c_vec, 1)
    c = vec_to_dict(c, c_vec)
    del c_vec
    c = antisymmetrize(c, ea=False)
    if eom_dsrg.verbose: print('Starts contraction')
    sigma['IIV'] += +0.50000000 * np.einsum('pCDE->pCDE',c['IIV'],optimize=True)
    sigma = antisymmetrize(sigma, ea=False)
    c.clear()
    vec = dict_to_vec(sigma, shape_size)
    sigma.clear()
    if eom_dsrg.verbose: print('Starts diagonalization', flush = True)
    sevals, sevecs = np.linalg.eigh(vec)
    if np.any(sevals < -tol):
        raise ValueError('Negative overlap eigenvalues found in IIV block')
    del vec
    if eom_dsrg.verbose: print('Diagonalization done')
    trunc_indices = np.where(sevals > tol)[0]
    eom_dsrg.S12.IIV = sevecs[:, trunc_indices] / np.sqrt(sevals[trunc_indices])
    num_ortho += eom_dsrg.S12.IIV.shape[1]
    del sevals, sevecs, trunc_indices

    # iAa block
    if eom_dsrg.verbose: print("Starts iAa block")
    shape_block = template_c['iAa'].shape[1:]
    shape_size = np.prod(shape_block)
    c['iAa'] = np.zeros((shape_size, *shape_block))
    sigma['iAa'] = np.zeros((shape_size, *shape_block))
    c_vec = dict_to_vec(c, shape_size)
    np.fill_diagonal(c_vec, 1)
    c = vec_to_dict(c, c_vec)
    del c_vec
    c = antisymmetrize(c, ea=False)
    if eom_dsrg.verbose: print('Starts contraction')
    sigma['iAa'] += +1.00000000 * np.einsum('pcAa,ao,OA->pcOo',c['iAa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('pcAa,aOoA->pcOo',c['iAa'],lambda2['aAaA'],optimize=True)
    sigma = antisymmetrize(sigma, ea=False)
    c.clear()
    vec = dict_to_vec(sigma, shape_size)
    sigma.clear()
    if eom_dsrg.verbose: print('Starts diagonalization', flush = True)
    sevals, sevecs = np.linalg.eigh(vec)
    if np.any(sevals < -tol):
        raise ValueError('Negative overlap eigenvalues found in iAa block')
    del vec
    if eom_dsrg.verbose: print('Diagonalization done')
    trunc_indices = np.where(sevals > tol)[0]
    eom_dsrg.S12.iAa = sevecs[:, trunc_indices] / np.sqrt(sevals[trunc_indices])
    num_ortho += eom_dsrg.S12.iAa.shape[1]
    del sevals, sevecs, trunc_indices

    # iCa block
    if eom_dsrg.verbose: print("Starts iCa block")
    shape_block = template_c['iCa'].shape[1:]
    shape_size = np.prod(shape_block)
    c['iCa'] = np.zeros((shape_size, *shape_block))
    sigma['iCa'] = np.zeros((shape_size, *shape_block))
    c_vec = dict_to_vec(c, shape_size)
    np.fill_diagonal(c_vec, 1)
    c = vec_to_dict(c, c_vec)
    del c_vec
    c = antisymmetrize(c, ea=False)
    if eom_dsrg.verbose: print('Starts contraction')
    sigma['iCa'] += +1.00000000 * np.einsum('pcKa,ao->pcKo',c['iCa'],eta1['aa'],optimize=True)
    sigma = antisymmetrize(sigma, ea=False)
    c.clear()
    vec = dict_to_vec(sigma, shape_size)
    sigma.clear()
    if eom_dsrg.verbose: print('Starts diagonalization', flush = True)
    sevals, sevecs = np.linalg.eigh(vec)
    if np.any(sevals < -tol):
        raise ValueError('Negative overlap eigenvalues found in iCa block')
    del vec
    if eom_dsrg.verbose: print('Diagonalization done')
    trunc_indices = np.where(sevals > tol)[0]
    eom_dsrg.S12.iCa = sevecs[:, trunc_indices] / np.sqrt(sevals[trunc_indices])
    num_ortho += eom_dsrg.S12.iCa.shape[1]
    del sevals, sevecs, trunc_indices

    # cIa block
    if eom_dsrg.verbose: print("Starts cIa block")
    shape_block = template_c['cIa'].shape[1:]
    shape_size = np.prod(shape_block)
    c['cIa'] = np.zeros((shape_size, *shape_block))
    sigma['cIa'] = np.zeros((shape_size, *shape_block))
    c_vec = dict_to_vec(c, shape_size)
    np.fill_diagonal(c_vec, 1)
    c = vec_to_dict(c, c_vec)
    del c_vec
    c = antisymmetrize(c, ea=False)
    if eom_dsrg.verbose: print('Starts contraction')
    sigma['cIa'] += +1.00000000 * np.einsum('pkCa,ao->pkCo',c['cIa'],eta1['aa'],optimize=True)
    sigma = antisymmetrize(sigma, ea=False)
    c.clear()
    vec = dict_to_vec(sigma, shape_size)
    sigma.clear()
    if eom_dsrg.verbose: print('Starts diagonalization', flush = True)
    sevals, sevecs = np.linalg.eigh(vec)
    if np.any(sevals < -tol):
        raise ValueError('Negative overlap eigenvalues found in cIa block')
    del vec
    if eom_dsrg.verbose: print('Diagonalization done')
    trunc_indices = np.where(sevals > tol)[0]
    eom_dsrg.S12.cIa = sevecs[:, trunc_indices] / np.sqrt(sevals[trunc_indices])
    num_ortho += eom_dsrg.S12.cIa.shape[1]
    del sevals, sevecs, trunc_indices

    # iIa block
    if eom_dsrg.verbose: print("Starts iIa block")
    shape_block = template_c['iIa'].shape[1:]
    shape_size = np.prod(shape_block)
    c['iIa'] = np.zeros((shape_size, *shape_block))
    sigma['iIa'] = np.zeros((shape_size, *shape_block))
    c_vec = dict_to_vec(c, shape_size)
    np.fill_diagonal(c_vec, 1)
    c = vec_to_dict(c, c_vec)
    del c_vec
    c = antisymmetrize(c, ea=False)
    if eom_dsrg.verbose: print('Starts contraction')
    sigma['iIa'] += +1.00000000 * np.einsum('pcCa,ao->pcCo',c['iIa'],eta1['aa'],optimize=True)
    sigma = antisymmetrize(sigma, ea=False)
    c.clear()
    vec = dict_to_vec(sigma, shape_size)
    sigma.clear()
    if eom_dsrg.verbose: print('Starts diagonalization', flush = True)
    sevals, sevecs = np.linalg.eigh(vec)
    if np.any(sevals < -tol):
        raise ValueError('Negative overlap eigenvalues found in iIa block')
    del vec
    if eom_dsrg.verbose: print('Diagonalization done')
    trunc_indices = np.where(sevals > tol)[0]
    eom_dsrg.S12.iIa = sevecs[:, trunc_indices] / np.sqrt(sevals[trunc_indices])
    num_ortho += eom_dsrg.S12.iIa.shape[1]
    del sevals, sevecs, trunc_indices

    # iAv block
    if eom_dsrg.verbose: print("Starts iAv block")
    shape_block = template_c['iAv'].shape[1:]
    shape_size = np.prod(shape_block)
    c['iAv'] = np.zeros((shape_size, *shape_block))
    sigma['iAv'] = np.zeros((shape_size, *shape_block))
    c_vec = dict_to_vec(c, shape_size)
    np.fill_diagonal(c_vec, 1)
    c = vec_to_dict(c, c_vec)
    del c_vec
    c = antisymmetrize(c, ea=False)
    if eom_dsrg.verbose: print('Starts contraction')
    sigma['iAv'] += +1.00000000 * np.einsum('pcAe,OA->pcOe',c['iAv'],gamma1['AA'],optimize=True)
    sigma = antisymmetrize(sigma, ea=False)
    c.clear()
    vec = dict_to_vec(sigma, shape_size)
    sigma.clear()
    if eom_dsrg.verbose: print('Starts diagonalization', flush = True)
    sevals, sevecs = np.linalg.eigh(vec)
    if np.any(sevals < -tol):
        raise ValueError('Negative overlap eigenvalues found in iAv block')
    del vec
    if eom_dsrg.verbose: print('Diagonalization done')
    trunc_indices = np.where(sevals > tol)[0]
    eom_dsrg.S12.iAv = sevecs[:, trunc_indices] / np.sqrt(sevals[trunc_indices])
    num_ortho += eom_dsrg.S12.iAv.shape[1]
    del sevals, sevecs, trunc_indices

    # iCv block
    if eom_dsrg.verbose: print("Starts iCv block")
    shape_block = template_c['iCv'].shape[1:]
    shape_size = np.prod(shape_block)
    c['iCv'] = np.zeros((shape_size, *shape_block))
    sigma['iCv'] = np.zeros((shape_size, *shape_block))
    c_vec = dict_to_vec(c, shape_size)
    np.fill_diagonal(c_vec, 1)
    c = vec_to_dict(c, c_vec)
    del c_vec
    c = antisymmetrize(c, ea=False)
    if eom_dsrg.verbose: print('Starts contraction')
    sigma['iCv'] += +1.00000000 * np.einsum('pcKe->pcKe',c['iCv'],optimize=True)
    sigma = antisymmetrize(sigma, ea=False)
    c.clear()
    vec = dict_to_vec(sigma, shape_size)
    sigma.clear()
    if eom_dsrg.verbose: print('Starts diagonalization', flush = True)
    sevals, sevecs = np.linalg.eigh(vec)
    if np.any(sevals < -tol):
        raise ValueError('Negative overlap eigenvalues found in iCv block')
    del vec
    if eom_dsrg.verbose: print('Diagonalization done')
    trunc_indices = np.where(sevals > tol)[0]
    eom_dsrg.S12.iCv = sevecs[:, trunc_indices] / np.sqrt(sevals[trunc_indices])
    num_ortho += eom_dsrg.S12.iCv.shape[1]
    del sevals, sevecs, trunc_indices

    # aIv block
    if eom_dsrg.verbose: print("Starts aIv block")
    shape_block = template_c['aIv'].shape[1:]
    shape_size = np.prod(shape_block)
    c['aIv'] = np.zeros((shape_size, *shape_block))
    sigma['aIv'] = np.zeros((shape_size, *shape_block))
    c_vec = dict_to_vec(c, shape_size)
    np.fill_diagonal(c_vec, 1)
    c = vec_to_dict(c, c_vec)
    del c_vec
    c = antisymmetrize(c, ea=False)
    if eom_dsrg.verbose: print('Starts contraction')
    sigma['aIv'] += +1.00000000 * np.einsum('paCe,oa->poCe',c['aIv'],gamma1['aa'],optimize=True)
    sigma = antisymmetrize(sigma, ea=False)
    c.clear()
    vec = dict_to_vec(sigma, shape_size)
    sigma.clear()
    if eom_dsrg.verbose: print('Starts diagonalization', flush = True)
    sevals, sevecs = np.linalg.eigh(vec)
    if np.any(sevals < -tol):
        raise ValueError('Negative overlap eigenvalues found in aIv block')
    del vec
    if eom_dsrg.verbose: print('Diagonalization done')
    trunc_indices = np.where(sevals > tol)[0]
    eom_dsrg.S12.aIv = sevecs[:, trunc_indices] / np.sqrt(sevals[trunc_indices])
    num_ortho += eom_dsrg.S12.aIv.shape[1]
    del sevals, sevecs, trunc_indices

    # cIv block
    if eom_dsrg.verbose: print("Starts cIv block")
    shape_block = template_c['cIv'].shape[1:]
    shape_size = np.prod(shape_block)
    c['cIv'] = np.zeros((shape_size, *shape_block))
    sigma['cIv'] = np.zeros((shape_size, *shape_block))
    c_vec = dict_to_vec(c, shape_size)
    np.fill_diagonal(c_vec, 1)
    c = vec_to_dict(c, c_vec)
    del c_vec
    c = antisymmetrize(c, ea=False)
    if eom_dsrg.verbose: print('Starts contraction')
    sigma['cIv'] += +1.00000000 * np.einsum('pkCe->pkCe',c['cIv'],optimize=True)
    sigma = antisymmetrize(sigma, ea=False)
    c.clear()
    vec = dict_to_vec(sigma, shape_size)
    sigma.clear()
    if eom_dsrg.verbose: print('Starts diagonalization', flush = True)
    sevals, sevecs = np.linalg.eigh(vec)
    if np.any(sevals < -tol):
        raise ValueError('Negative overlap eigenvalues found in cIv block')
    del vec
    if eom_dsrg.verbose: print('Diagonalization done')
    trunc_indices = np.where(sevals > tol)[0]
    eom_dsrg.S12.cIv = sevecs[:, trunc_indices] / np.sqrt(sevals[trunc_indices])
    num_ortho += eom_dsrg.S12.cIv.shape[1]
    del sevals, sevecs, trunc_indices

    # iIv block
    if eom_dsrg.verbose: print("Starts iIv block")
    shape_block = template_c['iIv'].shape[1:]
    shape_size = np.prod(shape_block)
    c['iIv'] = np.zeros((shape_size, *shape_block))
    sigma['iIv'] = np.zeros((shape_size, *shape_block))
    c_vec = dict_to_vec(c, shape_size)
    np.fill_diagonal(c_vec, 1)
    c = vec_to_dict(c, c_vec)
    del c_vec
    c = antisymmetrize(c, ea=False)
    if eom_dsrg.verbose: print('Starts contraction')
    sigma['iIv'] += +1.00000000 * np.einsum('pcCe->pcCe',c['iIv'],optimize=True)
    sigma = antisymmetrize(sigma, ea=False)
    c.clear()
    vec = dict_to_vec(sigma, shape_size)
    sigma.clear()
    if eom_dsrg.verbose: print('Starts diagonalization', flush = True)
    sevals, sevecs = np.linalg.eigh(vec)
    if np.any(sevals < -tol):
        raise ValueError('Negative overlap eigenvalues found in iIv block')
    del vec
    if eom_dsrg.verbose: print('Diagonalization done')
    trunc_indices = np.where(sevals > tol)[0]
    eom_dsrg.S12.iIv = sevecs[:, trunc_indices] / np.sqrt(sevals[trunc_indices])
    num_ortho += eom_dsrg.S12.iIv.shape[1]
    del sevals, sevecs, trunc_indices

    # ['IAA', 'aIa'] composite block
    if eom_dsrg.verbose: print("Starts ['IAA', 'aIa'] composite block", flush = True)
    shape_size = 0
    shape_block = template_c['IAA'].shape[1:]
    shape_size += np.prod(shape_block)
    shape_block = template_c['aIa'].shape[1:]
    shape_size += np.prod(shape_block)
    for key in ['IAA', 'aIa']:
        shape_block = template_c[key].shape[1:]
        c[key] = np.zeros((shape_size, *shape_block))
        sigma[key] = np.zeros((shape_size, *shape_block))
    c_vec = dict_to_vec(c, shape_size)
    np.fill_diagonal(c_vec, 1)
    c = vec_to_dict(c, c_vec)
    del c_vec
    c = antisymmetrize(c, ea=False)
    if eom_dsrg.verbose: print('Starts contraction')
    sigma['aIa'] += +1.00000000 * np.einsum('pbCr,ro,ab->paCo',c['aIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('pbCr,arob->paCo',c['aIa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('pCOA,aAoO->paCo',c['IAA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('poCa,aAoO->pCAO',c['aIa'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('pCBR,RO,AB->pCAO',c['IAA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('pCBR,AROB->pCAO',c['IAA'],lambda2['AAAA'],optimize=True)
    sigma = antisymmetrize(sigma, ea=False)
    c.clear()
    vec = dict_to_vec(sigma, shape_size)
    sigma.clear()
    if eom_dsrg.verbose: print('Starts diagonalization', flush = True)
    print(f'Symmetric: {np.allclose(vec, vec.T)}', flush = True)
    sevals, sevecs = scipy.linalg.eigh(vec)
    if np.any(sevals < -tol):
        raise ValueError("Negative overlap eigenvalues found in ['IAA', 'aIa'] space")
    del vec
    if eom_dsrg.verbose: print('Diagonalization done', flush = True)
    trunc_indices = np.where(sevals > tol)[0]
    eom_dsrg.S12.IAA = sevecs[:, trunc_indices] / np.sqrt(sevals[trunc_indices])
    num_ortho += eom_dsrg.S12.IAA.shape[1]
    del sevals, sevecs, trunc_indices

    if eom_dsrg.verbose: print(f'Number of orthogonalized operators: {num_ortho}')

def compute_preconditioner(eom_dsrg):
    einsum = eom_dsrg.einsum
    template_c = eom_dsrg.template_c
    Hbar = eom_dsrg.Hbar
    gamma1 = eom_dsrg.gamma1
    eta1 = eom_dsrg.eta1
    lambda2 = eom_dsrg.lambda2
    lambda3 = eom_dsrg.lambda3
    lambda4 = eom_dsrg.lambda4
    sigma = {}
    c = {}
    delta = {'ii': np.identity(eom_dsrg.ncore), 'II': np.identity(eom_dsrg.ncore), 'cc': np.identity(eom_dsrg.nocc), 'CC': np.identity(eom_dsrg.nocc), 'aa': np.identity(eom_dsrg.nact), 'AA': np.identity(eom_dsrg.nact), 'vv': np.identity(eom_dsrg.nvir), 'VV': np.identity(eom_dsrg.nvir)}
    diagonal = []
    # ICA block
    if eom_dsrg.verbose: print("Starts ICA block precond")
    shape_block = template_c['ICA'].shape[1:]
    northo = eom_dsrg.S12.ICA.shape[1]
    if northo != 0:
        c['ICA'] = np.zeros((northo, *shape_block))
        sigma['ICA'] = np.zeros((northo, *shape_block))
        c = vec_to_dict(c, eom_dsrg.S12.ICA)
        c = antisymmetrize(c, ea=False)
        sigma['ICA'] += -1.00000000 * np.einsum('oa,pCKA,aAoO->pCKO',Hbar['aa'],c['ICA'],lambda2['aAaA'],optimize=True)
        sigma['ICA'] += -0.25000000 * np.einsum('oabr,pCKA,brAoaO->pCKO',Hbar['aaaa'],c['ICA'],lambda3['aaAaaA'],optimize=True)
        sigma['ICA'] += +1.00000000 * np.einsum('oCaD,pDKA,aAoO->pCKO',Hbar['aIaI'],c['ICA'],lambda2['aAaA'],optimize=True)
        sigma['ICA'] += +1.00000000 * np.einsum('oKaL,pCLA,aAoO->pCKO',Hbar['aCaC'],c['ICA'],lambda2['aAaA'],optimize=True)
        sigma['ICA'] += -1.00000000 * np.einsum('oOaA,pCKR,RO,aAoB->pCKB',Hbar['aAaA'],c['ICA'],eta1['AA'],lambda2['aAaA'],optimize=True)
        sigma['ICA'] += -1.00000000 * np.einsum('oOaA,pCKR,AB,aRoO->pCKB',Hbar['aAaA'],c['ICA'],eta1['AA'],lambda2['aAaA'],optimize=True)
        sigma['ICA'] += -1.00000000 * np.einsum('oOaA,pCKR,aARoOB->pCKB',Hbar['aAaA'],c['ICA'],lambda3['aAAaAA'],optimize=True)
        sigma['ICA'] += -1.00000000 * np.einsum('CD,pDKA,AO->pCKO',Hbar['II'],c['ICA'],eta1['AA'],optimize=True)
        sigma['ICA'] += +1.00000000 * np.einsum('CKDL,pDLA,AO->pCKO',Hbar['ICIC'],c['ICA'],eta1['AA'],optimize=True)
        sigma['ICA'] += -1.00000000 * np.einsum('CODA,pDKR,AB,RO->pCKB',Hbar['IAIA'],c['ICA'],eta1['AA'],eta1['AA'],optimize=True)
        sigma['ICA'] += +1.00000000 * np.einsum('CODA,pDKR,AROB->pCKB',Hbar['IAIA'],c['ICA'],lambda2['AAAA'],optimize=True)
        sigma['ICA'] += -1.00000000 * np.einsum('KL,pCLA,AO->pCKO',Hbar['CC'],c['ICA'],eta1['AA'],optimize=True)
        sigma['ICA'] += -1.00000000 * np.einsum('KOLA,pCLR,AB,RO->pCKB',Hbar['CACA'],c['ICA'],eta1['AA'],eta1['AA'],optimize=True)
        sigma['ICA'] += +1.00000000 * np.einsum('KOLA,pCLR,AROB->pCKB',Hbar['CACA'],c['ICA'],lambda2['AAAA'],optimize=True)
        sigma['ICA'] += +1.00000000 * np.einsum('OA,pCKR,AB,RO->pCKB',Hbar['AA'],c['ICA'],eta1['AA'],eta1['AA'],optimize=True)
        sigma['ICA'] += -1.00000000 * np.einsum('OA,pCKR,AROB->pCKB',Hbar['AA'],c['ICA'],lambda2['AAAA'],optimize=True)
        sigma['ICA'] += -0.50000000 * np.einsum('OABR,pCKT,TA,BROS->pCKS',Hbar['AAAA'],c['ICA'],eta1['AA'],lambda2['AAAA'],optimize=True)
        sigma['ICA'] += +0.50000000 * np.einsum('OABR,pCKT,BS,RTOA->pCKS',Hbar['AAAA'],c['ICA'],eta1['AA'],lambda2['AAAA'],optimize=True)
        sigma['ICA'] += -0.25000000 * np.einsum('OABR,pCKT,BRTOAS->pCKS',Hbar['AAAA'],c['ICA'],lambda3['AAAAAA'],optimize=True)
        sigma = antisymmetrize(sigma, ea=False)
        c.clear()
        vec = dict_to_vec(sigma, northo)
        sigma.clear()
        vmv = eom_dsrg.S12.ICA.T @ vec
        diagonal.append(vmv.diagonal())
        del vec, vmv

    # IIA block
    if eom_dsrg.verbose: print("Starts IIA block precond")
    shape_block = template_c['IIA'].shape[1:]
    northo = eom_dsrg.S12.IIA.shape[1]
    if northo != 0:
        c['IIA'] = np.zeros((northo, *shape_block))
        sigma['IIA'] = np.zeros((northo, *shape_block))
        c = vec_to_dict(c, eom_dsrg.S12.IIA)
        c = antisymmetrize(c, ea=False)
        sigma['IIA'] += -0.50000000 * np.einsum('oa,pCDA,aAoO->pCDO',Hbar['aa'],c['IIA'],lambda2['aAaA'],optimize=True)
        sigma['IIA'] += -0.12500000 * np.einsum('oabr,pCDA,brAoaO->pCDO',Hbar['aaaa'],c['IIA'],lambda3['aaAaaA'],optimize=True)
        sigma['IIA'] += +1.00000000 * np.einsum('oCaD,pDIA,aAoO->pCIO',Hbar['aIaI'],c['IIA'],lambda2['aAaA'],optimize=True)
        sigma['IIA'] += -0.50000000 * np.einsum('oOaA,pCDR,RO,aAoB->pCDB',Hbar['aAaA'],c['IIA'],eta1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IIA'] += -0.50000000 * np.einsum('oOaA,pCDR,AB,aRoO->pCDB',Hbar['aAaA'],c['IIA'],eta1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IIA'] += -0.50000000 * np.einsum('oOaA,pCDR,aARoOB->pCDB',Hbar['aAaA'],c['IIA'],lambda3['aAAaAA'],optimize=True)
        sigma['IIA'] += -1.00000000 * np.einsum('CD,pDIA,AO->pCIO',Hbar['II'],c['IIA'],eta1['AA'],optimize=True)
        sigma['IIA'] += +0.25000000 * np.einsum('CDIJ,pIJA,AO->pCDO',Hbar['IIII'],c['IIA'],eta1['AA'],optimize=True)
        sigma['IIA'] += -1.00000000 * np.einsum('CODA,pDIR,AB,RO->pCIB',Hbar['IAIA'],c['IIA'],eta1['AA'],eta1['AA'],optimize=True)
        sigma['IIA'] += +1.00000000 * np.einsum('CODA,pDIR,AROB->pCIB',Hbar['IAIA'],c['IIA'],lambda2['AAAA'],optimize=True)
        sigma['IIA'] += +0.50000000 * np.einsum('OA,pCDR,AB,RO->pCDB',Hbar['AA'],c['IIA'],eta1['AA'],eta1['AA'],optimize=True)
        sigma['IIA'] += -0.50000000 * np.einsum('OA,pCDR,AROB->pCDB',Hbar['AA'],c['IIA'],lambda2['AAAA'],optimize=True)
        sigma['IIA'] += -0.25000000 * np.einsum('OABR,pCDT,TA,BROS->pCDS',Hbar['AAAA'],c['IIA'],eta1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IIA'] += +0.25000000 * np.einsum('OABR,pCDT,BS,RTOA->pCDS',Hbar['AAAA'],c['IIA'],eta1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IIA'] += -0.12500000 * np.einsum('OABR,pCDT,BRTOAS->pCDS',Hbar['AAAA'],c['IIA'],lambda3['AAAAAA'],optimize=True)
        sigma = antisymmetrize(sigma, ea=False)
        c.clear()
        vec = dict_to_vec(sigma, northo)
        sigma.clear()
        vmv = eom_dsrg.S12.IIA.T @ vec
        diagonal.append(vmv.diagonal())
        del vec, vmv

    # I block
    if eom_dsrg.verbose: print("Starts I block precond")
    shape_block = template_c['I'].shape[1:]
    northo = eom_dsrg.S12.I.shape[1]
    if northo != 0:
        c['I'] = np.zeros((northo, *shape_block))
        sigma['I'] = np.zeros((northo, *shape_block))
        c = vec_to_dict(c, eom_dsrg.S12.I)
        c = antisymmetrize(c, ea=False)
        sigma['I'] += -1.00000000 * np.einsum('CD,pD->pC',Hbar['II'],c['I'],optimize=True)
        sigma = antisymmetrize(sigma, ea=False)
        c.clear()
        vec = dict_to_vec(sigma, northo)
        sigma.clear()
        vmv = eom_dsrg.S12.I.T @ vec
        diagonal.append(vmv.diagonal())
        del vec, vmv

    # IAV block
    if eom_dsrg.verbose: print("Starts IAV block precond")
    shape_block = template_c['IAV'].shape[1:]
    northo = eom_dsrg.S12.IAV.shape[1]
    if northo != 0:
        c['IAV'] = np.zeros((northo, *shape_block))
        sigma['IAV'] = np.zeros((northo, *shape_block))
        c = vec_to_dict(c, eom_dsrg.S12.IAV)
        c = antisymmetrize(c, ea=False)
        sigma['IAV'] += +1.00000000 * np.einsum('oa,pCAE,aOoA->pCOE',Hbar['aa'],c['IAV'],lambda2['aAaA'],optimize=True)
        sigma['IAV'] += +0.25000000 * np.einsum('oabr,pCAE,brOoaA->pCOE',Hbar['aaaa'],c['IAV'],lambda3['aaAaaA'],optimize=True)
        sigma['IAV'] += -1.00000000 * np.einsum('oCaD,pDAE,aOoA->pCOE',Hbar['aIaI'],c['IAV'],lambda2['aAaA'],optimize=True)
        sigma['IAV'] += +1.00000000 * np.einsum('oEaF,pCAE,aOoA->pCOF',Hbar['aVaV'],c['IAV'],lambda2['aAaA'],optimize=True)
        sigma['IAV'] += -1.00000000 * np.einsum('oOaA,pCRE,BO,aAoR->pCBE',Hbar['aAaA'],c['IAV'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAV'] += -1.00000000 * np.einsum('oOaA,pCRE,AR,aBoO->pCBE',Hbar['aAaA'],c['IAV'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAV'] += +1.00000000 * np.einsum('oOaA,pCRE,aABoOR->pCBE',Hbar['aAaA'],c['IAV'],lambda3['aAAaAA'],optimize=True)
        sigma['IAV'] += -1.00000000 * np.einsum('CD,pDAE,OA->pCOE',Hbar['II'],c['IAV'],gamma1['AA'],optimize=True)
        sigma['IAV'] += -1.00000000 * np.einsum('CEDF,pDAE,OA->pCOF',Hbar['IVIV'],c['IAV'],gamma1['AA'],optimize=True)
        sigma['IAV'] += +1.00000000 * np.einsum('CODA,pDRE,AR,BO->pCBE',Hbar['IAIA'],c['IAV'],gamma1['AA'],gamma1['AA'],optimize=True)
        sigma['IAV'] += -1.00000000 * np.einsum('CODA,pDRE,ABOR->pCBE',Hbar['IAIA'],c['IAV'],lambda2['AAAA'],optimize=True)
        sigma['IAV'] += +1.00000000 * np.einsum('EF,pCAE,OA->pCOF',Hbar['VV'],c['IAV'],gamma1['AA'],optimize=True)
        sigma['IAV'] += -1.00000000 * np.einsum('EOFA,pCRE,AR,BO->pCBF',Hbar['VAVA'],c['IAV'],gamma1['AA'],gamma1['AA'],optimize=True)
        sigma['IAV'] += +1.00000000 * np.einsum('EOFA,pCRE,ABOR->pCBF',Hbar['VAVA'],c['IAV'],lambda2['AAAA'],optimize=True)
        sigma['IAV'] += -1.00000000 * np.einsum('OA,pCRE,AR,BO->pCBE',Hbar['AA'],c['IAV'],gamma1['AA'],gamma1['AA'],optimize=True)
        sigma['IAV'] += +1.00000000 * np.einsum('OA,pCRE,ABOR->pCBE',Hbar['AA'],c['IAV'],lambda2['AAAA'],optimize=True)
        sigma['IAV'] += +0.50000000 * np.einsum('OABR,pCTE,SO,BRAT->pCSE',Hbar['AAAA'],c['IAV'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAV'] += -0.50000000 * np.einsum('OABR,pCTE,RT,BSOA->pCSE',Hbar['AAAA'],c['IAV'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAV'] += +0.25000000 * np.einsum('OABR,pCTE,BRSOAT->pCSE',Hbar['AAAA'],c['IAV'],lambda3['AAAAAA'],optimize=True)
        sigma = antisymmetrize(sigma, ea=False)
        c.clear()
        vec = dict_to_vec(sigma, northo)
        sigma.clear()
        vmv = eom_dsrg.S12.IAV.T @ vec
        diagonal.append(vmv.diagonal())
        del vec, vmv

    # ICV block
    if eom_dsrg.verbose: print("Starts ICV block precond")
    shape_block = template_c['ICV'].shape[1:]
    northo = eom_dsrg.S12.ICV.shape[1]
    if northo != 0:
        c['ICV'] = np.zeros((northo, *shape_block))
        sigma['ICV'] = np.zeros((northo, *shape_block))
        c = vec_to_dict(c, eom_dsrg.S12.ICV)
        c = antisymmetrize(c, ea=False)
        sigma['ICV'] += -1.00000000 * np.einsum('CD,pDKE->pCKE',Hbar['II'],c['ICV'],optimize=True)
        sigma['ICV'] += +1.00000000 * np.einsum('CKDL,pDLE->pCKE',Hbar['ICIC'],c['ICV'],optimize=True)
        sigma['ICV'] += -1.00000000 * np.einsum('CEDF,pDKE->pCKF',Hbar['IVIV'],c['ICV'],optimize=True)
        sigma['ICV'] += -1.00000000 * np.einsum('KL,pCLE->pCKE',Hbar['CC'],c['ICV'],optimize=True)
        sigma['ICV'] += -1.00000000 * np.einsum('KELF,pCLE->pCKF',Hbar['CVCV'],c['ICV'],optimize=True)
        sigma['ICV'] += +1.00000000 * np.einsum('EF,pCKE->pCKF',Hbar['VV'],c['ICV'],optimize=True)
        sigma = antisymmetrize(sigma, ea=False)
        c.clear()
        vec = dict_to_vec(sigma, northo)
        sigma.clear()
        vmv = eom_dsrg.S12.ICV.T @ vec
        diagonal.append(vmv.diagonal())
        del vec, vmv

    # IIV block
    if eom_dsrg.verbose: print("Starts IIV block precond")
    shape_block = template_c['IIV'].shape[1:]
    northo = eom_dsrg.S12.IIV.shape[1]
    if northo != 0:
        c['IIV'] = np.zeros((northo, *shape_block))
        sigma['IIV'] = np.zeros((northo, *shape_block))
        c = vec_to_dict(c, eom_dsrg.S12.IIV)
        c = antisymmetrize(c, ea=False)
        sigma['IIV'] += -1.00000000 * np.einsum('CD,pDIE->pCIE',Hbar['II'],c['IIV'],optimize=True)
        sigma['IIV'] += +0.25000000 * np.einsum('CDIJ,pIJE->pCDE',Hbar['IIII'],c['IIV'],optimize=True)
        sigma['IIV'] += -1.00000000 * np.einsum('CEDF,pDIE->pCIF',Hbar['IVIV'],c['IIV'],optimize=True)
        sigma['IIV'] += +0.50000000 * np.einsum('EF,pCDE->pCDF',Hbar['VV'],c['IIV'],optimize=True)
        sigma = antisymmetrize(sigma, ea=False)
        c.clear()
        vec = dict_to_vec(sigma, northo)
        sigma.clear()
        vmv = eom_dsrg.S12.IIV.T @ vec
        diagonal.append(vmv.diagonal())
        del vec, vmv

    # iAa block
    if eom_dsrg.verbose: print("Starts iAa block precond")
    shape_block = template_c['iAa'].shape[1:]
    northo = eom_dsrg.S12.iAa.shape[1]
    if northo != 0:
        c['iAa'] = np.zeros((northo, *shape_block))
        sigma['iAa'] = np.zeros((northo, *shape_block))
        c = vec_to_dict(c, eom_dsrg.S12.iAa)
        c = antisymmetrize(c, ea=False)
        sigma['iAa'] += -1.00000000 * np.einsum('cd,pdAa,ao,OA->pcOo',Hbar['ii'],c['iAa'],eta1['aa'],gamma1['AA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('cd,pdAa,aOoA->pcOo',Hbar['ii'],c['iAa'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('coda,pdAr,ro,aObA->pcOb',Hbar['iaia'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('coda,pdAr,ab,ro,OA->pcOb',Hbar['iaia'],c['iAa'],eta1['aa'],eta1['aa'],gamma1['AA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('coda,pdAr,ab,rOoA->pcOb',Hbar['iaia'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('coda,pdAr,rb,aOoA->pcOb',Hbar['iaia'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('coda,pdAr,OA,arob->pcOb',Hbar['iaia'],c['iAa'],gamma1['AA'],lambda2['aaaa'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('coda,pdAr,arOobA->pcOb',Hbar['iaia'],c['iAa'],lambda3['aaAaaA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('cOdA,pdRa,ao,AR,BO->pcBo',Hbar['iAiA'],c['iAa'],eta1['aa'],gamma1['AA'],gamma1['AA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('cOdA,pdRa,ao,ABOR->pcBo',Hbar['iAiA'],c['iAa'],eta1['aa'],lambda2['AAAA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('cOdA,pdRa,BO,aAoR->pcBo',Hbar['iAiA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('cOdA,pdRa,AR,aBoO->pcBo',Hbar['iAiA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('cOdA,pdRa,BR,aAoO->pcBo',Hbar['iAiA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('cOdA,pdRa,aABoOR->pcBo',Hbar['iAiA'],c['iAa'],lambda3['aAAaAA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oa,pcAr,ro,aObA->pcOb',Hbar['aa'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('oa,pcAr,ab,ro,OA->pcOb',Hbar['aa'],c['iAa'],eta1['aa'],eta1['aa'],gamma1['AA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oa,pcAr,ab,rOoA->pcOb',Hbar['aa'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('oa,pcAr,rb,aOoA->pcOb',Hbar['aa'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oa,pcAr,OA,arob->pcOb',Hbar['aa'],c['iAa'],gamma1['AA'],lambda2['aaaa'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oa,pcAr,arOobA->pcOb',Hbar['aa'],c['iAa'],lambda3['aaAaaA'],optimize=True)
        sigma['iAa'] += -0.50000000 * np.einsum('oabr,pcAt,ta,OA,bros->pcOs',Hbar['aaaa'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aaaa'],optimize=True)
        sigma['iAa'] += -0.50000000 * np.einsum('oabr,pcAt,ta,brOosA->pcOs',Hbar['aaaa'],c['iAa'],eta1['aa'],lambda3['aaAaaA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oabr,pcAt,bs,ta,rOoA->pcOs',Hbar['aaaa'],c['iAa'],eta1['aa'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += +0.50000000 * np.einsum('oabr,pcAt,bs,OA,rtoa->pcOs',Hbar['aaaa'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aaaa'],optimize=True)
        sigma['iAa'] += +0.50000000 * np.einsum('oabr,pcAt,bs,rtOoaA->pcOs',Hbar['aaaa'],c['iAa'],eta1['aa'],lambda3['aaAaaA'],optimize=True)
        sigma['iAa'] += +0.25000000 * np.einsum('oabr,pcAt,ts,brOoaA->pcOs',Hbar['aaaa'],c['iAa'],eta1['aa'],lambda3['aaAaaA'],optimize=True)
        sigma['iAa'] += -0.25000000 * np.einsum('oabr,pcAt,OA,brtoas->pcOs',Hbar['aaaa'],c['iAa'],gamma1['AA'],lambda3['aaaaaa'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oabr,pcAt,rOaA,btos->pcOs',Hbar['aaaa'],c['iAa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
        sigma['iAa'] += +0.50000000 * np.einsum('oabr,pcAt,tOaA,bros->pcOs',Hbar['aaaa'],c['iAa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
        sigma['iAa'] += +0.50000000 * np.einsum('oabr,pcAt,rOsA,btoa->pcOs',Hbar['aaaa'],c['iAa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
        sigma['iAa'] += -0.25000000 * np.einsum('oabr,pcAt,brtOoasA->pcOs',Hbar['aaaa'],c['iAa'],lambda4['aaaAaaaA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,ro,BO,aAbR->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,ro,AR,aBbO->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,ro,BR,aAbO->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,ro,aABbOR->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],lambda3['aAAaAA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,ab,ro,AR,BO->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],eta1['aa'],gamma1['AA'],gamma1['AA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,ab,ro,ABOR->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],eta1['aa'],lambda2['AAAA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,ab,BO,rAoR->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,ab,AR,rBoO->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,ab,BR,rAoO->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,ab,rABoOR->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],lambda3['aAAaAA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,rb,BO,aAoR->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,rb,AR,aBoO->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,rb,aABoOR->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],lambda3['aAAaAA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,BO,arAobR->pcBb',Hbar['aAaA'],c['iAa'],gamma1['AA'],lambda3['aaAaaA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,AR,BO,arob->pcBb',Hbar['aAaA'],c['iAa'],gamma1['AA'],gamma1['AA'],lambda2['aaaa'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,AR,arBobO->pcBb',Hbar['aAaA'],c['iAa'],gamma1['AA'],lambda3['aaAaaA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,BR,arAobO->pcBb',Hbar['aAaA'],c['iAa'],gamma1['AA'],lambda3['aaAaaA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,aAbO,rBoR->pcBb',Hbar['aAaA'],c['iAa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,aBbO,rAoR->pcBb',Hbar['aAaA'],c['iAa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,rAbO,aBoR->pcBb',Hbar['aAaA'],c['iAa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,rBbO,aAoR->pcBb',Hbar['aAaA'],c['iAa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,aAbR,rBoO->pcBb',Hbar['aAaA'],c['iAa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,aBbR,rAoO->pcBb',Hbar['aAaA'],c['iAa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,rAbR,aBoO->pcBb',Hbar['aAaA'],c['iAa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,ABOR,arob->pcBb',Hbar['aAaA'],c['iAa'],lambda2['AAAA'],lambda2['aaaa'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,arABobOR->pcBb',Hbar['aAaA'],c['iAa'],lambda4['aaAAaaAA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('OA,pcRa,ao,AR,BO->pcBo',Hbar['AA'],c['iAa'],eta1['aa'],gamma1['AA'],gamma1['AA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('OA,pcRa,ao,ABOR->pcBo',Hbar['AA'],c['iAa'],eta1['aa'],lambda2['AAAA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('OA,pcRa,BO,aAoR->pcBo',Hbar['AA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('OA,pcRa,AR,aBoO->pcBo',Hbar['AA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('OA,pcRa,BR,aAoO->pcBo',Hbar['AA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('OA,pcRa,aABoOR->pcBo',Hbar['AA'],c['iAa'],lambda3['aAAaAA'],optimize=True)
        sigma['iAa'] += +0.50000000 * np.einsum('OABR,pcTa,ao,SO,BRAT->pcSo',Hbar['AAAA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['iAa'] += -0.50000000 * np.einsum('OABR,pcTa,ao,RT,BSOA->pcSo',Hbar['AAAA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['iAa'] += +0.25000000 * np.einsum('OABR,pcTa,ao,BRSOAT->pcSo',Hbar['AAAA'],c['iAa'],eta1['aa'],lambda3['AAAAAA'],optimize=True)
        sigma['iAa'] += +0.50000000 * np.einsum('OABR,pcTa,SA,aBRoOT->pcSo',Hbar['AAAA'],c['iAa'],gamma1['AA'],lambda3['aAAaAA'],optimize=True)
        sigma['iAa'] += +1.00000000 * np.einsum('OABR,pcTa,RT,SA,aBoO->pcSo',Hbar['AAAA'],c['iAa'],gamma1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += +0.50000000 * np.einsum('OABR,pcTa,RT,aBSoOA->pcSo',Hbar['AAAA'],c['iAa'],gamma1['AA'],lambda3['aAAaAA'],optimize=True)
        sigma['iAa'] += -0.25000000 * np.einsum('OABR,pcTa,ST,aBRoOA->pcSo',Hbar['AAAA'],c['iAa'],gamma1['AA'],lambda3['aAAaAA'],optimize=True)
        sigma['iAa'] += +0.50000000 * np.einsum('OABR,pcTa,BSOA,aRoT->pcSo',Hbar['AAAA'],c['iAa'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += +0.50000000 * np.einsum('OABR,pcTa,BROT,aSoA->pcSo',Hbar['AAAA'],c['iAa'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += -1.00000000 * np.einsum('OABR,pcTa,RSAT,aBoO->pcSo',Hbar['AAAA'],c['iAa'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
        sigma['iAa'] += -0.25000000 * np.einsum('OABR,pcTa,aBRSoOAT->pcSo',Hbar['AAAA'],c['iAa'],lambda4['aAAAaAAA'],optimize=True)
        sigma = antisymmetrize(sigma, ea=False)
        c.clear()
        vec = dict_to_vec(sigma, northo)
        sigma.clear()
        vmv = eom_dsrg.S12.iAa.T @ vec
        diagonal.append(vmv.diagonal())
        del vec, vmv

    # iCa block
    if eom_dsrg.verbose: print("Starts iCa block precond")
    shape_block = template_c['iCa'].shape[1:]
    northo = eom_dsrg.S12.iCa.shape[1]
    if northo != 0:
        c['iCa'] = np.zeros((northo, *shape_block))
        sigma['iCa'] = np.zeros((northo, *shape_block))
        c = vec_to_dict(c, eom_dsrg.S12.iCa)
        c = antisymmetrize(c, ea=False)
        sigma['iCa'] += -1.00000000 * np.einsum('cd,pdKa,ao->pcKo',Hbar['ii'],c['iCa'],eta1['aa'],optimize=True)
        sigma['iCa'] += -1.00000000 * np.einsum('coda,pdKr,ab,ro->pcKb',Hbar['iaia'],c['iCa'],eta1['aa'],eta1['aa'],optimize=True)
        sigma['iCa'] += +1.00000000 * np.einsum('coda,pdKr,arob->pcKb',Hbar['iaia'],c['iCa'],lambda2['aaaa'],optimize=True)
        sigma['iCa'] += +1.00000000 * np.einsum('cKdL,pdLa,ao->pcKo',Hbar['iCiC'],c['iCa'],eta1['aa'],optimize=True)
        sigma['iCa'] += +1.00000000 * np.einsum('cOdA,pdKa,aAoO->pcKo',Hbar['iAiA'],c['iCa'],lambda2['aAaA'],optimize=True)
        sigma['iCa'] += +1.00000000 * np.einsum('oa,pcKr,ab,ro->pcKb',Hbar['aa'],c['iCa'],eta1['aa'],eta1['aa'],optimize=True)
        sigma['iCa'] += -1.00000000 * np.einsum('oa,pcKr,arob->pcKb',Hbar['aa'],c['iCa'],lambda2['aaaa'],optimize=True)
        sigma['iCa'] += -0.50000000 * np.einsum('oabr,pcKt,ta,bros->pcKs',Hbar['aaaa'],c['iCa'],eta1['aa'],lambda2['aaaa'],optimize=True)
        sigma['iCa'] += +0.50000000 * np.einsum('oabr,pcKt,bs,rtoa->pcKs',Hbar['aaaa'],c['iCa'],eta1['aa'],lambda2['aaaa'],optimize=True)
        sigma['iCa'] += -0.25000000 * np.einsum('oabr,pcKt,brtoas->pcKs',Hbar['aaaa'],c['iCa'],lambda3['aaaaaa'],optimize=True)
        sigma['iCa'] += -1.00000000 * np.einsum('oKaL,pcLr,ab,ro->pcKb',Hbar['aCaC'],c['iCa'],eta1['aa'],eta1['aa'],optimize=True)
        sigma['iCa'] += +1.00000000 * np.einsum('oKaL,pcLr,arob->pcKb',Hbar['aCaC'],c['iCa'],lambda2['aaaa'],optimize=True)
        sigma['iCa'] += -1.00000000 * np.einsum('oOaA,pcKr,ro,aAbO->pcKb',Hbar['aAaA'],c['iCa'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['iCa'] += -1.00000000 * np.einsum('oOaA,pcKr,ab,rAoO->pcKb',Hbar['aAaA'],c['iCa'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['iCa'] += -1.00000000 * np.einsum('oOaA,pcKr,arAobO->pcKb',Hbar['aAaA'],c['iCa'],lambda3['aaAaaA'],optimize=True)
        sigma['iCa'] += -1.00000000 * np.einsum('KL,pcLa,ao->pcKo',Hbar['CC'],c['iCa'],eta1['aa'],optimize=True)
        sigma['iCa'] += +1.00000000 * np.einsum('KOLA,pcLa,aAoO->pcKo',Hbar['CACA'],c['iCa'],lambda2['aAaA'],optimize=True)
        sigma['iCa'] += -1.00000000 * np.einsum('OA,pcKa,aAoO->pcKo',Hbar['AA'],c['iCa'],lambda2['aAaA'],optimize=True)
        sigma['iCa'] += -0.25000000 * np.einsum('OABR,pcKa,aBRoOA->pcKo',Hbar['AAAA'],c['iCa'],lambda3['aAAaAA'],optimize=True)
        sigma = antisymmetrize(sigma, ea=False)
        c.clear()
        vec = dict_to_vec(sigma, northo)
        sigma.clear()
        vmv = eom_dsrg.S12.iCa.T @ vec
        diagonal.append(vmv.diagonal())
        del vec, vmv

    # cIa block
    if eom_dsrg.verbose: print("Starts cIa block precond")
    shape_block = template_c['cIa'].shape[1:]
    northo = eom_dsrg.S12.cIa.shape[1]
    if northo != 0:
        c['cIa'] = np.zeros((northo, *shape_block))
        sigma['cIa'] = np.zeros((northo, *shape_block))
        c = vec_to_dict(c, eom_dsrg.S12.cIa)
        c = antisymmetrize(c, ea=False)
        sigma['cIa'] += -1.00000000 * np.einsum('kl,plCa,ao->pkCo',Hbar['cc'],c['cIa'],eta1['aa'],optimize=True)
        sigma['cIa'] += -1.00000000 * np.einsum('kola,plCr,ab,ro->pkCb',Hbar['caca'],c['cIa'],eta1['aa'],eta1['aa'],optimize=True)
        sigma['cIa'] += +1.00000000 * np.einsum('kola,plCr,arob->pkCb',Hbar['caca'],c['cIa'],lambda2['aaaa'],optimize=True)
        sigma['cIa'] += +1.00000000 * np.einsum('kClD,plDa,ao->pkCo',Hbar['cIcI'],c['cIa'],eta1['aa'],optimize=True)
        sigma['cIa'] += +1.00000000 * np.einsum('kOlA,plCa,aAoO->pkCo',Hbar['cAcA'],c['cIa'],lambda2['aAaA'],optimize=True)
        sigma['cIa'] += +1.00000000 * np.einsum('oa,pkCr,ab,ro->pkCb',Hbar['aa'],c['cIa'],eta1['aa'],eta1['aa'],optimize=True)
        sigma['cIa'] += -1.00000000 * np.einsum('oa,pkCr,arob->pkCb',Hbar['aa'],c['cIa'],lambda2['aaaa'],optimize=True)
        sigma['cIa'] += -0.50000000 * np.einsum('oabr,pkCt,ta,bros->pkCs',Hbar['aaaa'],c['cIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
        sigma['cIa'] += +0.50000000 * np.einsum('oabr,pkCt,bs,rtoa->pkCs',Hbar['aaaa'],c['cIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
        sigma['cIa'] += -0.25000000 * np.einsum('oabr,pkCt,brtoas->pkCs',Hbar['aaaa'],c['cIa'],lambda3['aaaaaa'],optimize=True)
        sigma['cIa'] += -1.00000000 * np.einsum('oCaD,pkDr,ab,ro->pkCb',Hbar['aIaI'],c['cIa'],eta1['aa'],eta1['aa'],optimize=True)
        sigma['cIa'] += +1.00000000 * np.einsum('oCaD,pkDr,arob->pkCb',Hbar['aIaI'],c['cIa'],lambda2['aaaa'],optimize=True)
        sigma['cIa'] += -1.00000000 * np.einsum('oOaA,pkCr,ro,aAbO->pkCb',Hbar['aAaA'],c['cIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['cIa'] += -1.00000000 * np.einsum('oOaA,pkCr,ab,rAoO->pkCb',Hbar['aAaA'],c['cIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['cIa'] += -1.00000000 * np.einsum('oOaA,pkCr,arAobO->pkCb',Hbar['aAaA'],c['cIa'],lambda3['aaAaaA'],optimize=True)
        sigma['cIa'] += -1.00000000 * np.einsum('CD,pkDa,ao->pkCo',Hbar['II'],c['cIa'],eta1['aa'],optimize=True)
        sigma['cIa'] += +1.00000000 * np.einsum('CODA,pkDa,aAoO->pkCo',Hbar['IAIA'],c['cIa'],lambda2['aAaA'],optimize=True)
        sigma['cIa'] += -1.00000000 * np.einsum('OA,pkCa,aAoO->pkCo',Hbar['AA'],c['cIa'],lambda2['aAaA'],optimize=True)
        sigma['cIa'] += -0.25000000 * np.einsum('OABR,pkCa,aBRoOA->pkCo',Hbar['AAAA'],c['cIa'],lambda3['aAAaAA'],optimize=True)
        sigma = antisymmetrize(sigma, ea=False)
        c.clear()
        vec = dict_to_vec(sigma, northo)
        sigma.clear()
        vmv = eom_dsrg.S12.cIa.T @ vec
        diagonal.append(vmv.diagonal())
        del vec, vmv

    # iIa block
    if eom_dsrg.verbose: print("Starts iIa block precond")
    shape_block = template_c['iIa'].shape[1:]
    northo = eom_dsrg.S12.iIa.shape[1]
    if northo != 0:
        c['iIa'] = np.zeros((northo, *shape_block))
        sigma['iIa'] = np.zeros((northo, *shape_block))
        c = vec_to_dict(c, eom_dsrg.S12.iIa)
        c = antisymmetrize(c, ea=False)
        sigma['iIa'] += -1.00000000 * np.einsum('cd,pdCa,ao->pcCo',Hbar['ii'],c['iIa'],eta1['aa'],optimize=True)
        sigma['iIa'] += -1.00000000 * np.einsum('coda,pdCr,ab,ro->pcCb',Hbar['iaia'],c['iIa'],eta1['aa'],eta1['aa'],optimize=True)
        sigma['iIa'] += +1.00000000 * np.einsum('coda,pdCr,arob->pcCb',Hbar['iaia'],c['iIa'],lambda2['aaaa'],optimize=True)
        sigma['iIa'] += +1.00000000 * np.einsum('cCdD,pdDa,ao->pcCo',Hbar['iIiI'],c['iIa'],eta1['aa'],optimize=True)
        sigma['iIa'] += +1.00000000 * np.einsum('cOdA,pdCa,aAoO->pcCo',Hbar['iAiA'],c['iIa'],lambda2['aAaA'],optimize=True)
        sigma['iIa'] += +1.00000000 * np.einsum('oa,pcCr,ab,ro->pcCb',Hbar['aa'],c['iIa'],eta1['aa'],eta1['aa'],optimize=True)
        sigma['iIa'] += -1.00000000 * np.einsum('oa,pcCr,arob->pcCb',Hbar['aa'],c['iIa'],lambda2['aaaa'],optimize=True)
        sigma['iIa'] += -0.50000000 * np.einsum('oabr,pcCt,ta,bros->pcCs',Hbar['aaaa'],c['iIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
        sigma['iIa'] += +0.50000000 * np.einsum('oabr,pcCt,bs,rtoa->pcCs',Hbar['aaaa'],c['iIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
        sigma['iIa'] += -0.25000000 * np.einsum('oabr,pcCt,brtoas->pcCs',Hbar['aaaa'],c['iIa'],lambda3['aaaaaa'],optimize=True)
        sigma['iIa'] += -1.00000000 * np.einsum('oCaD,pcDr,ab,ro->pcCb',Hbar['aIaI'],c['iIa'],eta1['aa'],eta1['aa'],optimize=True)
        sigma['iIa'] += +1.00000000 * np.einsum('oCaD,pcDr,arob->pcCb',Hbar['aIaI'],c['iIa'],lambda2['aaaa'],optimize=True)
        sigma['iIa'] += -1.00000000 * np.einsum('oOaA,pcCr,ro,aAbO->pcCb',Hbar['aAaA'],c['iIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['iIa'] += -1.00000000 * np.einsum('oOaA,pcCr,ab,rAoO->pcCb',Hbar['aAaA'],c['iIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['iIa'] += -1.00000000 * np.einsum('oOaA,pcCr,arAobO->pcCb',Hbar['aAaA'],c['iIa'],lambda3['aaAaaA'],optimize=True)
        sigma['iIa'] += -1.00000000 * np.einsum('CD,pcDa,ao->pcCo',Hbar['II'],c['iIa'],eta1['aa'],optimize=True)
        sigma['iIa'] += +1.00000000 * np.einsum('CODA,pcDa,aAoO->pcCo',Hbar['IAIA'],c['iIa'],lambda2['aAaA'],optimize=True)
        sigma['iIa'] += -1.00000000 * np.einsum('OA,pcCa,aAoO->pcCo',Hbar['AA'],c['iIa'],lambda2['aAaA'],optimize=True)
        sigma['iIa'] += -0.25000000 * np.einsum('OABR,pcCa,aBRoOA->pcCo',Hbar['AAAA'],c['iIa'],lambda3['aAAaAA'],optimize=True)
        sigma = antisymmetrize(sigma, ea=False)
        c.clear()
        vec = dict_to_vec(sigma, northo)
        sigma.clear()
        vmv = eom_dsrg.S12.iIa.T @ vec
        diagonal.append(vmv.diagonal())
        del vec, vmv

    # iAv block
    if eom_dsrg.verbose: print("Starts iAv block precond")
    shape_block = template_c['iAv'].shape[1:]
    northo = eom_dsrg.S12.iAv.shape[1]
    if northo != 0:
        c['iAv'] = np.zeros((northo, *shape_block))
        sigma['iAv'] = np.zeros((northo, *shape_block))
        c = vec_to_dict(c, eom_dsrg.S12.iAv)
        c = antisymmetrize(c, ea=False)
        sigma['iAv'] += -1.00000000 * np.einsum('cd,pdAe,OA->pcOe',Hbar['ii'],c['iAv'],gamma1['AA'],optimize=True)
        sigma['iAv'] += -1.00000000 * np.einsum('cedf,pdAe,OA->pcOf',Hbar['iviv'],c['iAv'],gamma1['AA'],optimize=True)
        sigma['iAv'] += -1.00000000 * np.einsum('coda,pdAe,aOoA->pcOe',Hbar['iaia'],c['iAv'],lambda2['aAaA'],optimize=True)
        sigma['iAv'] += +1.00000000 * np.einsum('cOdA,pdRe,AR,BO->pcBe',Hbar['iAiA'],c['iAv'],gamma1['AA'],gamma1['AA'],optimize=True)
        sigma['iAv'] += -1.00000000 * np.einsum('cOdA,pdRe,ABOR->pcBe',Hbar['iAiA'],c['iAv'],lambda2['AAAA'],optimize=True)
        sigma['iAv'] += +1.00000000 * np.einsum('ef,pcAe,OA->pcOf',Hbar['vv'],c['iAv'],gamma1['AA'],optimize=True)
        sigma['iAv'] += +1.00000000 * np.einsum('eofa,pcAe,aOoA->pcOf',Hbar['vava'],c['iAv'],lambda2['aAaA'],optimize=True)
        sigma['iAv'] += -1.00000000 * np.einsum('eOfA,pcRe,AR,BO->pcBf',Hbar['vAvA'],c['iAv'],gamma1['AA'],gamma1['AA'],optimize=True)
        sigma['iAv'] += +1.00000000 * np.einsum('eOfA,pcRe,ABOR->pcBf',Hbar['vAvA'],c['iAv'],lambda2['AAAA'],optimize=True)
        sigma['iAv'] += +1.00000000 * np.einsum('oa,pcAe,aOoA->pcOe',Hbar['aa'],c['iAv'],lambda2['aAaA'],optimize=True)
        sigma['iAv'] += +0.25000000 * np.einsum('oabr,pcAe,brOoaA->pcOe',Hbar['aaaa'],c['iAv'],lambda3['aaAaaA'],optimize=True)
        sigma['iAv'] += -1.00000000 * np.einsum('oOaA,pcRe,BO,aAoR->pcBe',Hbar['aAaA'],c['iAv'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['iAv'] += -1.00000000 * np.einsum('oOaA,pcRe,AR,aBoO->pcBe',Hbar['aAaA'],c['iAv'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['iAv'] += +1.00000000 * np.einsum('oOaA,pcRe,aABoOR->pcBe',Hbar['aAaA'],c['iAv'],lambda3['aAAaAA'],optimize=True)
        sigma['iAv'] += -1.00000000 * np.einsum('OA,pcRe,AR,BO->pcBe',Hbar['AA'],c['iAv'],gamma1['AA'],gamma1['AA'],optimize=True)
        sigma['iAv'] += +1.00000000 * np.einsum('OA,pcRe,ABOR->pcBe',Hbar['AA'],c['iAv'],lambda2['AAAA'],optimize=True)
        sigma['iAv'] += +0.50000000 * np.einsum('OABR,pcTe,SO,BRAT->pcSe',Hbar['AAAA'],c['iAv'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['iAv'] += -0.50000000 * np.einsum('OABR,pcTe,RT,BSOA->pcSe',Hbar['AAAA'],c['iAv'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['iAv'] += +0.25000000 * np.einsum('OABR,pcTe,BRSOAT->pcSe',Hbar['AAAA'],c['iAv'],lambda3['AAAAAA'],optimize=True)
        sigma = antisymmetrize(sigma, ea=False)
        c.clear()
        vec = dict_to_vec(sigma, northo)
        sigma.clear()
        vmv = eom_dsrg.S12.iAv.T @ vec
        diagonal.append(vmv.diagonal())
        del vec, vmv

    # iCv block
    if eom_dsrg.verbose: print("Starts iCv block precond")
    shape_block = template_c['iCv'].shape[1:]
    northo = eom_dsrg.S12.iCv.shape[1]
    if northo != 0:
        c['iCv'] = np.zeros((northo, *shape_block))
        sigma['iCv'] = np.zeros((northo, *shape_block))
        c = vec_to_dict(c, eom_dsrg.S12.iCv)
        c = antisymmetrize(c, ea=False)
        sigma['iCv'] += -1.00000000 * np.einsum('cd,pdKe->pcKe',Hbar['ii'],c['iCv'],optimize=True)
        sigma['iCv'] += -1.00000000 * np.einsum('cedf,pdKe->pcKf',Hbar['iviv'],c['iCv'],optimize=True)
        sigma['iCv'] += +1.00000000 * np.einsum('cKdL,pdLe->pcKe',Hbar['iCiC'],c['iCv'],optimize=True)
        sigma['iCv'] += +1.00000000 * np.einsum('ef,pcKe->pcKf',Hbar['vv'],c['iCv'],optimize=True)
        sigma['iCv'] += -1.00000000 * np.einsum('eKfL,pcLe->pcKf',Hbar['vCvC'],c['iCv'],optimize=True)
        sigma['iCv'] += -1.00000000 * np.einsum('KL,pcLe->pcKe',Hbar['CC'],c['iCv'],optimize=True)
        sigma = antisymmetrize(sigma, ea=False)
        c.clear()
        vec = dict_to_vec(sigma, northo)
        sigma.clear()
        vmv = eom_dsrg.S12.iCv.T @ vec
        diagonal.append(vmv.diagonal())
        del vec, vmv

    # aIv block
    if eom_dsrg.verbose: print("Starts aIv block precond")
    shape_block = template_c['aIv'].shape[1:]
    northo = eom_dsrg.S12.aIv.shape[1]
    if northo != 0:
        c['aIv'] = np.zeros((northo, *shape_block))
        sigma['aIv'] = np.zeros((northo, *shape_block))
        c = vec_to_dict(c, eom_dsrg.S12.aIv)
        c = antisymmetrize(c, ea=False)
        sigma['aIv'] += +1.00000000 * np.einsum('ef,paCe,oa->poCf',Hbar['vv'],c['aIv'],gamma1['aa'],optimize=True)
        sigma['aIv'] += -1.00000000 * np.einsum('eofa,prCe,ar,bo->pbCf',Hbar['vava'],c['aIv'],gamma1['aa'],gamma1['aa'],optimize=True)
        sigma['aIv'] += +1.00000000 * np.einsum('eofa,prCe,abor->pbCf',Hbar['vava'],c['aIv'],lambda2['aaaa'],optimize=True)
        sigma['aIv'] += -1.00000000 * np.einsum('eCfD,paDe,oa->poCf',Hbar['vIvI'],c['aIv'],gamma1['aa'],optimize=True)
        sigma['aIv'] += +1.00000000 * np.einsum('eOfA,paCe,oAaO->poCf',Hbar['vAvA'],c['aIv'],lambda2['aAaA'],optimize=True)
        sigma['aIv'] += -1.00000000 * np.einsum('oa,prCe,ar,bo->pbCe',Hbar['aa'],c['aIv'],gamma1['aa'],gamma1['aa'],optimize=True)
        sigma['aIv'] += +1.00000000 * np.einsum('oa,prCe,abor->pbCe',Hbar['aa'],c['aIv'],lambda2['aaaa'],optimize=True)
        sigma['aIv'] += +0.50000000 * np.einsum('oabr,ptCe,so,brat->psCe',Hbar['aaaa'],c['aIv'],gamma1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIv'] += -0.50000000 * np.einsum('oabr,ptCe,rt,bsoa->psCe',Hbar['aaaa'],c['aIv'],gamma1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIv'] += +0.25000000 * np.einsum('oabr,ptCe,brsoat->psCe',Hbar['aaaa'],c['aIv'],lambda3['aaaaaa'],optimize=True)
        sigma['aIv'] += +1.00000000 * np.einsum('oCaD,prDe,ar,bo->pbCe',Hbar['aIaI'],c['aIv'],gamma1['aa'],gamma1['aa'],optimize=True)
        sigma['aIv'] += -1.00000000 * np.einsum('oCaD,prDe,abor->pbCe',Hbar['aIaI'],c['aIv'],lambda2['aaaa'],optimize=True)
        sigma['aIv'] += -1.00000000 * np.einsum('oOaA,prCe,bo,aArO->pbCe',Hbar['aAaA'],c['aIv'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIv'] += -1.00000000 * np.einsum('oOaA,prCe,ar,bAoO->pbCe',Hbar['aAaA'],c['aIv'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIv'] += +1.00000000 * np.einsum('oOaA,prCe,abAorO->pbCe',Hbar['aAaA'],c['aIv'],lambda3['aaAaaA'],optimize=True)
        sigma['aIv'] += -1.00000000 * np.einsum('CD,paDe,oa->poCe',Hbar['II'],c['aIv'],gamma1['aa'],optimize=True)
        sigma['aIv'] += -1.00000000 * np.einsum('CODA,paDe,oAaO->poCe',Hbar['IAIA'],c['aIv'],lambda2['aAaA'],optimize=True)
        sigma['aIv'] += +1.00000000 * np.einsum('OA,paCe,oAaO->poCe',Hbar['AA'],c['aIv'],lambda2['aAaA'],optimize=True)
        sigma['aIv'] += +0.25000000 * np.einsum('OABR,paCe,oBRaOA->poCe',Hbar['AAAA'],c['aIv'],lambda3['aAAaAA'],optimize=True)
        sigma = antisymmetrize(sigma, ea=False)
        c.clear()
        vec = dict_to_vec(sigma, northo)
        sigma.clear()
        vmv = eom_dsrg.S12.aIv.T @ vec
        diagonal.append(vmv.diagonal())
        del vec, vmv

    # cIv block
    if eom_dsrg.verbose: print("Starts cIv block precond")
    shape_block = template_c['cIv'].shape[1:]
    northo = eom_dsrg.S12.cIv.shape[1]
    if northo != 0:
        c['cIv'] = np.zeros((northo, *shape_block))
        sigma['cIv'] = np.zeros((northo, *shape_block))
        c = vec_to_dict(c, eom_dsrg.S12.cIv)
        c = antisymmetrize(c, ea=False)
        sigma['cIv'] += -1.00000000 * np.einsum('kl,plCe->pkCe',Hbar['cc'],c['cIv'],optimize=True)
        sigma['cIv'] += -1.00000000 * np.einsum('kelf,plCe->pkCf',Hbar['cvcv'],c['cIv'],optimize=True)
        sigma['cIv'] += +1.00000000 * np.einsum('kClD,plDe->pkCe',Hbar['cIcI'],c['cIv'],optimize=True)
        sigma['cIv'] += +1.00000000 * np.einsum('ef,pkCe->pkCf',Hbar['vv'],c['cIv'],optimize=True)
        sigma['cIv'] += -1.00000000 * np.einsum('eCfD,pkDe->pkCf',Hbar['vIvI'],c['cIv'],optimize=True)
        sigma['cIv'] += -1.00000000 * np.einsum('CD,pkDe->pkCe',Hbar['II'],c['cIv'],optimize=True)
        sigma = antisymmetrize(sigma, ea=False)
        c.clear()
        vec = dict_to_vec(sigma, northo)
        sigma.clear()
        vmv = eom_dsrg.S12.cIv.T @ vec
        diagonal.append(vmv.diagonal())
        del vec, vmv

    # iIv block
    if eom_dsrg.verbose: print("Starts iIv block precond")
    shape_block = template_c['iIv'].shape[1:]
    northo = eom_dsrg.S12.iIv.shape[1]
    if northo != 0:
        c['iIv'] = np.zeros((northo, *shape_block))
        sigma['iIv'] = np.zeros((northo, *shape_block))
        c = vec_to_dict(c, eom_dsrg.S12.iIv)
        c = antisymmetrize(c, ea=False)
        sigma['iIv'] += -1.00000000 * np.einsum('cd,pdCe->pcCe',Hbar['ii'],c['iIv'],optimize=True)
        sigma['iIv'] += -1.00000000 * np.einsum('cedf,pdCe->pcCf',Hbar['iviv'],c['iIv'],optimize=True)
        sigma['iIv'] += +1.00000000 * np.einsum('cCdD,pdDe->pcCe',Hbar['iIiI'],c['iIv'],optimize=True)
        sigma['iIv'] += +1.00000000 * np.einsum('ef,pcCe->pcCf',Hbar['vv'],c['iIv'],optimize=True)
        sigma['iIv'] += -1.00000000 * np.einsum('eCfD,pcDe->pcCf',Hbar['vIvI'],c['iIv'],optimize=True)
        sigma['iIv'] += -1.00000000 * np.einsum('CD,pcDe->pcCe',Hbar['II'],c['iIv'],optimize=True)
        sigma = antisymmetrize(sigma, ea=False)
        c.clear()
        vec = dict_to_vec(sigma, northo)
        sigma.clear()
        vmv = eom_dsrg.S12.iIv.T @ vec
        diagonal.append(vmv.diagonal())
        del vec, vmv

    # ['IAA', 'aIa'] composite block
    if eom_dsrg.verbose: print("Starts ['IAA', 'aIa'] composite block precond")
    northo = eom_dsrg.S12.IAA.shape[1]
    if northo != 0:
        vmv = np.zeros((northo, northo))
        for key in ['IAA', 'aIa']:
            shape_block = template_c[key].shape[1:]
            c[key] = np.zeros((northo, *shape_block))
            sigma[key] = np.zeros((northo, *shape_block))
        c = vec_to_dict(c, eom_dsrg.S12.IAA)
        c = antisymmetrize(c, ea=False)
        sigma['aIa'] += -1.00000000 * np.einsum('oa,psCt,to,arbs->prCb',Hbar['aa'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oa,psCt,ab,to,rs->prCb',Hbar['aa'],c['aIa'],eta1['aa'],eta1['aa'],gamma1['aa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oa,psCt,ab,rtos->prCb',Hbar['aa'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oa,psCt,tb,as,ro->prCb',Hbar['aa'],c['aIa'],eta1['aa'],gamma1['aa'],gamma1['aa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oa,psCt,tb,aros->prCb',Hbar['aa'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oa,psCt,ro,atbs->prCb',Hbar['aa'],c['aIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oa,psCt,as,rtob->prCb',Hbar['aa'],c['aIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oa,psCt,rs,atob->prCb',Hbar['aa'],c['aIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oa,psCt,artobs->prCb',Hbar['aa'],c['aIa'],lambda3['aaaaaa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oa,pCOA,ab,rAoO->prCb',Hbar['aa'],c['IAA'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oa,pCOA,ro,aAbO->prCb',Hbar['aa'],c['IAA'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oa,pCOA,arAobO->prCb',Hbar['aa'],c['IAA'],lambda3['aaAaaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oa,pbCr,ro,aAbO->pCAO',Hbar['aa'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oa,pbCr,ab,rAoO->pCAO',Hbar['aa'],c['aIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oa,pbCr,arAobO->pCAO',Hbar['aa'],c['aIa'],lambda3['aaAaaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oa,pCBR,RO,aAoB->pCAO',Hbar['aa'],c['IAA'],eta1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oa,pCBR,AB,aRoO->pCAO',Hbar['aa'],c['IAA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oa,pCBR,aARoOB->pCAO',Hbar['aa'],c['IAA'],lambda3['aAAaAA'],optimize=True)
        sigma['aIa'] += -0.50000000 * np.einsum('oabr,puCv,va,to,brsu->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oabr,puCv,va,ru,btos->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -0.50000000 * np.einsum('oabr,puCv,va,tu,bros->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -0.50000000 * np.einsum('oabr,puCv,va,brtosu->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],lambda3['aaaaaa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oabr,puCv,bs,va,ru,to->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],eta1['aa'],gamma1['aa'],gamma1['aa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oabr,puCv,bs,to,rvau->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -0.50000000 * np.einsum('oabr,puCv,bs,ru,tvoa->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +0.50000000 * np.einsum('oabr,puCv,bs,tu,rvoa->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oabr,puCv,rs,va,btou->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],eta1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +0.50000000 * np.einsum('oabr,puCv,rs,btvoau->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],lambda3['aaaaaa'],optimize=True)
        sigma['aIa'] += +0.50000000 * np.einsum('oabr,puCv,vs,to,brau->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -0.50000000 * np.einsum('oabr,puCv,vs,ru,btoa->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +0.25000000 * np.einsum('oabr,puCv,vs,brtoau->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],lambda3['aaaaaa'],optimize=True)
        sigma['aIa'] += +0.50000000 * np.einsum('oabr,puCv,to,brvasu->ptCs',Hbar['aaaa'],c['aIa'],gamma1['aa'],lambda3['aaaaaa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oabr,puCv,ru,to,bvas->ptCs',Hbar['aaaa'],c['aIa'],gamma1['aa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +0.50000000 * np.einsum('oabr,puCv,ru,btvoas->ptCs',Hbar['aaaa'],c['aIa'],gamma1['aa'],lambda3['aaaaaa'],optimize=True)
        sigma['aIa'] += -0.25000000 * np.einsum('oabr,puCv,tu,brvoas->ptCs',Hbar['aaaa'],c['aIa'],gamma1['aa'],lambda3['aaaaaa'],optimize=True)
        sigma['aIa'] += +0.50000000 * np.einsum('oabr,puCv,brou,tvas->ptCs',Hbar['aaaa'],c['aIa'],lambda2['aaaa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oabr,puCv,btou,rvas->ptCs',Hbar['aaaa'],c['aIa'],lambda2['aaaa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oabr,puCv,rvau,btos->ptCs',Hbar['aaaa'],c['aIa'],lambda2['aaaa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -0.50000000 * np.einsum('oabr,puCv,tvau,bros->ptCs',Hbar['aaaa'],c['aIa'],lambda2['aaaa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +0.25000000 * np.einsum('oabr,puCv,brsu,tvoa->ptCs',Hbar['aaaa'],c['aIa'],lambda2['aaaa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +0.50000000 * np.einsum('oabr,puCv,rtsu,bvoa->ptCs',Hbar['aaaa'],c['aIa'],lambda2['aaaa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -0.50000000 * np.einsum('oabr,puCv,rvsu,btoa->ptCs',Hbar['aaaa'],c['aIa'],lambda2['aaaa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +0.25000000 * np.einsum('oabr,puCv,brtvoasu->ptCs',Hbar['aaaa'],c['aIa'],lambda4['aaaaaaaa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oabr,pCOA,bs,to,rAaO->ptCs',Hbar['aaaa'],c['IAA'],eta1['aa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -0.50000000 * np.einsum('oabr,pCOA,rs,btAoaO->ptCs',Hbar['aaaa'],c['IAA'],eta1['aa'],lambda3['aaAaaA'],optimize=True)
        sigma['aIa'] += -0.50000000 * np.einsum('oabr,pCOA,to,brAasO->ptCs',Hbar['aaaa'],c['IAA'],gamma1['aa'],lambda3['aaAaaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oabr,pCOA,rAaO,btos->ptCs',Hbar['aaaa'],c['IAA'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +0.50000000 * np.einsum('oabr,pCOA,tAaO,bros->ptCs',Hbar['aaaa'],c['IAA'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +0.50000000 * np.einsum('oabr,pCOA,rAsO,btoa->ptCs',Hbar['aaaa'],c['IAA'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -0.25000000 * np.einsum('oabr,pCOA,brtAoasO->ptCs',Hbar['aaaa'],c['IAA'],lambda4['aaaAaaaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oabr,psCt,ta,rs,bAoO->pCAO',Hbar['aaaa'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -0.50000000 * np.einsum('oabr,psCt,ta,brAosO->pCAO',Hbar['aaaa'],c['aIa'],eta1['aa'],lambda3['aaAaaA'],optimize=True)
        sigma['IAA'] += +0.50000000 * np.einsum('oabr,psCt,rs,btAoaO->pCAO',Hbar['aaaa'],c['aIa'],gamma1['aa'],lambda3['aaAaaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oabr,psCt,bAoO,rtas->pCAO',Hbar['aaaa'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
        sigma['IAA'] += +0.50000000 * np.einsum('oabr,psCt,tAaO,bros->pCAO',Hbar['aaaa'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
        sigma['IAA'] += +0.50000000 * np.einsum('oabr,psCt,rAsO,btoa->pCAO',Hbar['aaaa'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
        sigma['IAA'] += -0.25000000 * np.einsum('oabr,psCt,brtAoasO->pCAO',Hbar['aaaa'],c['aIa'],lambda4['aaaAaaaA'],optimize=True)
        sigma['IAA'] += +0.25000000 * np.einsum('oabr,pCBR,RO,brAoaB->pCAO',Hbar['aaaa'],c['IAA'],eta1['AA'],lambda3['aaAaaA'],optimize=True)
        sigma['IAA'] += -0.25000000 * np.einsum('oabr,pCBR,AB,brRoaO->pCAO',Hbar['aaaa'],c['IAA'],gamma1['AA'],lambda3['aaAaaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oabr,pCBR,bAoB,rRaO->pCAO',Hbar['aaaa'],c['IAA'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oabr,pCBR,rRaB,bAoO->pCAO',Hbar['aaaa'],c['IAA'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +0.25000000 * np.einsum('oabr,pCBR,brARoaOB->pCAO',Hbar['aaaa'],c['IAA'],lambda4['aaAAaaAA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oCaD,psDt,to,arbs->prCb',Hbar['aIaI'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oCaD,psDt,ab,to,rs->prCb',Hbar['aIaI'],c['aIa'],eta1['aa'],eta1['aa'],gamma1['aa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oCaD,psDt,ab,rtos->prCb',Hbar['aIaI'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oCaD,psDt,tb,as,ro->prCb',Hbar['aIaI'],c['aIa'],eta1['aa'],gamma1['aa'],gamma1['aa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oCaD,psDt,tb,aros->prCb',Hbar['aIaI'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oCaD,psDt,ro,atbs->prCb',Hbar['aIaI'],c['aIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oCaD,psDt,as,rtob->prCb',Hbar['aIaI'],c['aIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oCaD,psDt,rs,atob->prCb',Hbar['aIaI'],c['aIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oCaD,psDt,artobs->prCb',Hbar['aIaI'],c['aIa'],lambda3['aaaaaa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oCaD,pDOA,ab,rAoO->prCb',Hbar['aIaI'],c['IAA'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oCaD,pDOA,ro,aAbO->prCb',Hbar['aIaI'],c['IAA'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oCaD,pDOA,arAobO->prCb',Hbar['aIaI'],c['IAA'],lambda3['aaAaaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oCaD,pbDr,ro,aAbO->pCAO',Hbar['aIaI'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oCaD,pbDr,ab,rAoO->pCAO',Hbar['aIaI'],c['aIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oCaD,pbDr,arAobO->pCAO',Hbar['aIaI'],c['aIa'],lambda3['aaAaaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oCaD,pDBR,RO,aAoB->pCAO',Hbar['aIaI'],c['IAA'],eta1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oCaD,pDBR,AB,aRoO->pCAO',Hbar['aIaI'],c['IAA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oCaD,pDBR,aARoOB->pCAO',Hbar['aIaI'],c['IAA'],lambda3['aAAaAA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,to,as,rAbO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,to,rs,aAbO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,to,arAbsO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],lambda3['aaAaaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,ab,to,rAsO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,ab,ro,tAsO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,ab,rs,tAoO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,ab,rtAosO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],lambda3['aaAaaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,tb,ro,aAsO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,tb,as,rAoO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,tb,arAosO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],lambda3['aaAaaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,ro,atAbsO->prCb',Hbar['aAaA'],c['aIa'],gamma1['aa'],lambda3['aaAaaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,as,ro,tAbO->prCb',Hbar['aAaA'],c['aIa'],gamma1['aa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,as,rtAobO->prCb',Hbar['aAaA'],c['aIa'],gamma1['aa'],lambda3['aaAaaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,rs,atAobO->prCb',Hbar['aAaA'],c['aIa'],gamma1['aa'],lambda3['aaAaaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,rAoO,atbs->prCb',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,tAoO,arbs->prCb',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,aAbO,rtos->prCb',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,rAbO,atos->prCb',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,tAbO,aros->prCb',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,aAsO,rtob->prCb',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,rAsO,atob->prCb',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,tAsO,arob->prCb',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,artAobsO->prCb',Hbar['aAaA'],c['aIa'],lambda4['aaaAaaaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,ab,ro,AROB->prCb',Hbar['aAaA'],c['IAA'],eta1['aa'],gamma1['aa'],lambda2['AAAA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,pCBR,ab,AB,rRoO->prCb',Hbar['aAaA'],c['IAA'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,ab,rARoOB->prCb',Hbar['aAaA'],c['IAA'],eta1['aa'],lambda3['aAAaAA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,RO,ab,AB,ro->prCb',Hbar['aAaA'],c['IAA'],eta1['AA'],eta1['aa'],gamma1['AA'],gamma1['aa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,RO,ab,rAoB->prCb',Hbar['aAaA'],c['IAA'],eta1['AA'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,pCBR,RO,ro,aAbB->prCb',Hbar['aAaA'],c['IAA'],eta1['AA'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,RO,AB,arob->prCb',Hbar['aAaA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,RO,arAobB->prCb',Hbar['aAaA'],c['IAA'],eta1['AA'],lambda3['aaAaaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,pCBR,ro,aARbOB->prCb',Hbar['aAaA'],c['IAA'],gamma1['aa'],lambda3['aAAaAA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,AB,ro,aRbO->prCb',Hbar['aAaA'],c['IAA'],gamma1['AA'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,pCBR,AB,arRobO->prCb',Hbar['aAaA'],c['IAA'],gamma1['AA'],lambda3['aaAaaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,pCBR,aAbO,rRoB->prCb',Hbar['aAaA'],c['IAA'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,aRbO,rAoB->prCb',Hbar['aAaA'],c['IAA'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,rAbO,aRoB->prCb',Hbar['aAaA'],c['IAA'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,pCBR,rRbO,aAoB->prCb',Hbar['aAaA'],c['IAA'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,aAbB,rRoO->prCb',Hbar['aAaA'],c['IAA'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,pCBR,aRbB,rAoO->prCb',Hbar['aAaA'],c['IAA'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('oOaA,pCBR,rAbB,aRoO->prCb',Hbar['aAaA'],c['IAA'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,AROB,arob->prCb',Hbar['aAaA'],c['IAA'],lambda2['AAAA'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,arARobOB->prCb',Hbar['aAaA'],c['IAA'],lambda4['aaAAaaAA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,ro,ab,AROB->pCRB',Hbar['aAaA'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pbCr,ro,RO,aAbB->pCRB',Hbar['aAaA'],c['aIa'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,ro,aARbOB->pCRB',Hbar['aAaA'],c['aIa'],eta1['aa'],lambda3['aAAaAA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,AB,ro,RO,ab->pCRB',Hbar['aAaA'],c['aIa'],eta1['AA'],eta1['aa'],gamma1['AA'],gamma1['aa'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,AB,ro,aRbO->pCRB',Hbar['aAaA'],c['aIa'],eta1['AA'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pbCr,AB,ab,rRoO->pCRB',Hbar['aAaA'],c['aIa'],eta1['AA'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,AB,RO,arob->pCRB',Hbar['aAaA'],c['aIa'],eta1['AA'],gamma1['AA'],lambda2['aaaa'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,AB,arRobO->pCRB',Hbar['aAaA'],c['aIa'],eta1['AA'],lambda3['aaAaaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pbCr,ab,rARoOB->pCRB',Hbar['aAaA'],c['aIa'],gamma1['aa'],lambda3['aAAaAA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,RO,ab,rAoB->pCRB',Hbar['aAaA'],c['aIa'],gamma1['AA'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pbCr,RO,arAobB->pCRB',Hbar['aAaA'],c['aIa'],gamma1['AA'],lambda3['aaAaaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pbCr,aAbO,rRoB->pCRB',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,aRbO,rAoB->pCRB',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,rAbO,aRoB->pCRB',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pbCr,rRbO,aAoB->pCRB',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,aAbB,rRoO->pCRB',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pbCr,aRbB,rAoO->pCRB',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pbCr,rAbB,aRoO->pCRB',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,AROB,arob->pCRB',Hbar['aAaA'],c['aIa'],lambda2['AAAA'],lambda2['aaaa'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,arARobOB->pCRB',Hbar['aAaA'],c['aIa'],lambda4['aaAAaaAA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,TO,AS,aRoB->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,TO,RS,aAoB->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,TO,aARoBS->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],lambda3['aAAaAA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,AB,TO,aRoS->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],eta1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,AB,RO,aToS->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,AB,RS,aToO->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,AB,aRToOS->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],lambda3['aAAaAA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,TB,RO,aAoS->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,TB,AS,aRoO->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,TB,aARoOS->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],lambda3['aAAaAA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,RO,aAToBS->pCRB',Hbar['aAaA'],c['IAA'],gamma1['AA'],lambda3['aAAaAA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,AS,RO,aToB->pCRB',Hbar['aAaA'],c['IAA'],gamma1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,AS,aRToOB->pCRB',Hbar['aAaA'],c['IAA'],gamma1['AA'],lambda3['aAAaAA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,RS,aAToOB->pCRB',Hbar['aAaA'],c['IAA'],gamma1['AA'],lambda3['aAAaAA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,AROB,aToS->pCRB',Hbar['aAaA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,ATOB,aRoS->pCRB',Hbar['aAaA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,RTOB,aAoS->pCRB',Hbar['aAaA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,AROS,aToB->pCRB',Hbar['aAaA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,ATOS,aRoB->pCRB',Hbar['aAaA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,RTOS,aAoB->pCRB',Hbar['aAaA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,ARBS,aToO->pCRB',Hbar['aAaA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,ATBS,aRoO->pCRB',Hbar['aAaA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,aARToOBS->pCRB',Hbar['aAaA'],c['IAA'],lambda4['aAAAaAAA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('CD,pbDr,ro,ab->paCo',Hbar['II'],c['aIa'],eta1['aa'],gamma1['aa'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('CD,pbDr,arob->paCo',Hbar['II'],c['aIa'],lambda2['aaaa'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('CD,pDOA,aAoO->paCo',Hbar['II'],c['IAA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('CD,poDa,aAoO->pCAO',Hbar['II'],c['aIa'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('CD,pDBR,RO,AB->pCAO',Hbar['II'],c['IAA'],eta1['AA'],gamma1['AA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('CD,pDBR,AROB->pCAO',Hbar['II'],c['IAA'],lambda2['AAAA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('CODA,pbDr,ro,aAbO->paCo',Hbar['IAIA'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('CODA,pbDr,ab,rAoO->paCo',Hbar['IAIA'],c['aIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('CODA,pbDr,arAobO->paCo',Hbar['IAIA'],c['aIa'],lambda3['aaAaaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('CODA,pDBR,RO,aAoB->paCo',Hbar['IAIA'],c['IAA'],eta1['AA'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('CODA,pDBR,AB,aRoO->paCo',Hbar['IAIA'],c['IAA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('CODA,pDBR,aARoOB->paCo',Hbar['IAIA'],c['IAA'],lambda3['aAAaAA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('CODA,poDa,AB,aRoO->pCRB',Hbar['IAIA'],c['aIa'],eta1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('CODA,poDa,RO,aAoB->pCRB',Hbar['IAIA'],c['aIa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('CODA,poDa,aARoOB->pCRB',Hbar['IAIA'],c['aIa'],lambda3['aAAaAA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('CODA,pDST,TO,ARBS->pCRB',Hbar['IAIA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('CODA,pDST,AB,TO,RS->pCRB',Hbar['IAIA'],c['IAA'],eta1['AA'],eta1['AA'],gamma1['AA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('CODA,pDST,AB,RTOS->pCRB',Hbar['IAIA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('CODA,pDST,TB,AS,RO->pCRB',Hbar['IAIA'],c['IAA'],eta1['AA'],gamma1['AA'],gamma1['AA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('CODA,pDST,TB,AROS->pCRB',Hbar['IAIA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('CODA,pDST,RO,ATBS->pCRB',Hbar['IAIA'],c['IAA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('CODA,pDST,AS,RTOB->pCRB',Hbar['IAIA'],c['IAA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('CODA,pDST,RS,ATOB->pCRB',Hbar['IAIA'],c['IAA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('CODA,pDST,ARTOBS->pCRB',Hbar['IAIA'],c['IAA'],lambda3['AAAAAA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('OA,pbCr,ro,aAbO->paCo',Hbar['AA'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('OA,pbCr,ab,rAoO->paCo',Hbar['AA'],c['aIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('OA,pbCr,arAobO->paCo',Hbar['AA'],c['aIa'],lambda3['aaAaaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('OA,pCBR,RO,aAoB->paCo',Hbar['AA'],c['IAA'],eta1['AA'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('OA,pCBR,AB,aRoO->paCo',Hbar['AA'],c['IAA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('OA,pCBR,aARoOB->paCo',Hbar['AA'],c['IAA'],lambda3['aAAaAA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('OA,poCa,AB,aRoO->pCRB',Hbar['AA'],c['aIa'],eta1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('OA,poCa,RO,aAoB->pCRB',Hbar['AA'],c['aIa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('OA,poCa,aARoOB->pCRB',Hbar['AA'],c['aIa'],lambda3['aAAaAA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('OA,pCST,TO,ARBS->pCRB',Hbar['AA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('OA,pCST,AB,TO,RS->pCRB',Hbar['AA'],c['IAA'],eta1['AA'],eta1['AA'],gamma1['AA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('OA,pCST,AB,RTOS->pCRB',Hbar['AA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('OA,pCST,TB,AS,RO->pCRB',Hbar['AA'],c['IAA'],eta1['AA'],gamma1['AA'],gamma1['AA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('OA,pCST,TB,AROS->pCRB',Hbar['AA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('OA,pCST,RO,ATBS->pCRB',Hbar['AA'],c['IAA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('OA,pCST,AS,RTOB->pCRB',Hbar['AA'],c['IAA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('OA,pCST,RS,ATOB->pCRB',Hbar['AA'],c['IAA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('OA,pCST,ARTOBS->pCRB',Hbar['AA'],c['IAA'],lambda3['AAAAAA'],optimize=True)
        sigma['aIa'] += +0.25000000 * np.einsum('OABR,pbCr,ro,aBRbOA->paCo',Hbar['AAAA'],c['aIa'],eta1['aa'],lambda3['aAAaAA'],optimize=True)
        sigma['aIa'] += -0.25000000 * np.einsum('OABR,pbCr,ab,rBRoOA->paCo',Hbar['AAAA'],c['aIa'],gamma1['aa'],lambda3['aAAaAA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('OABR,pbCr,aBbO,rRoA->paCo',Hbar['AAAA'],c['aIa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += +1.00000000 * np.einsum('OABR,pbCr,rRbA,aBoO->paCo',Hbar['AAAA'],c['aIa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += +0.25000000 * np.einsum('OABR,pbCr,arBRobOA->paCo',Hbar['AAAA'],c['aIa'],lambda4['aaAAaaAA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('OABR,pCST,TA,RS,aBoO->paCo',Hbar['AAAA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -0.50000000 * np.einsum('OABR,pCST,TA,aBRoOS->paCo',Hbar['AAAA'],c['IAA'],eta1['AA'],lambda3['aAAaAA'],optimize=True)
        sigma['aIa'] += +0.50000000 * np.einsum('OABR,pCST,RS,aBToOA->paCo',Hbar['AAAA'],c['IAA'],gamma1['AA'],lambda3['aAAaAA'],optimize=True)
        sigma['aIa'] += +0.50000000 * np.einsum('OABR,pCST,BTOA,aRoS->paCo',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += +0.50000000 * np.einsum('OABR,pCST,BROS,aToA->paCo',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -1.00000000 * np.einsum('OABR,pCST,RTAS,aBoO->paCo',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
        sigma['aIa'] += -0.25000000 * np.einsum('OABR,pCST,aBRToOAS->paCo',Hbar['AAAA'],c['IAA'],lambda4['aAAAaAAA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('OABR,poCa,BS,TO,aRoA->pCTS',Hbar['AAAA'],c['aIa'],eta1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -0.50000000 * np.einsum('OABR,poCa,RS,aBToOA->pCTS',Hbar['AAAA'],c['aIa'],eta1['AA'],lambda3['aAAaAA'],optimize=True)
        sigma['IAA'] += -0.50000000 * np.einsum('OABR,poCa,TO,aBRoAS->pCTS',Hbar['AAAA'],c['aIa'],gamma1['AA'],lambda3['aAAaAA'],optimize=True)
        sigma['IAA'] += +0.50000000 * np.einsum('OABR,poCa,BTOA,aRoS->pCTS',Hbar['AAAA'],c['aIa'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += +0.50000000 * np.einsum('OABR,poCa,BROS,aToA->pCTS',Hbar['AAAA'],c['aIa'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('OABR,poCa,BTOS,aRoA->pCTS',Hbar['AAAA'],c['aIa'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
        sigma['IAA'] += -0.25000000 * np.einsum('OABR,poCa,aBRToOAS->pCTS',Hbar['AAAA'],c['aIa'],lambda4['aAAAaAAA'],optimize=True)
        sigma['IAA'] += -0.50000000 * np.einsum('OABR,pCUV,VA,TO,BRSU->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('OABR,pCUV,VA,RU,BTOS->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += -0.50000000 * np.einsum('OABR,pCUV,VA,TU,BROS->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += -0.50000000 * np.einsum('OABR,pCUV,VA,BRTOSU->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],lambda3['AAAAAA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('OABR,pCUV,BS,VA,RU,TO->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],eta1['AA'],gamma1['AA'],gamma1['AA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('OABR,pCUV,BS,TO,RVAU->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += -0.50000000 * np.einsum('OABR,pCUV,BS,RU,TVOA->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += +0.50000000 * np.einsum('OABR,pCUV,BS,TU,RVOA->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('OABR,pCUV,RS,VA,BTOU->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],eta1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += +0.50000000 * np.einsum('OABR,pCUV,RS,BTVOAU->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],lambda3['AAAAAA'],optimize=True)
        sigma['IAA'] += +0.50000000 * np.einsum('OABR,pCUV,VS,TO,BRAU->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += -0.50000000 * np.einsum('OABR,pCUV,VS,RU,BTOA->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += +0.25000000 * np.einsum('OABR,pCUV,VS,BRTOAU->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],lambda3['AAAAAA'],optimize=True)
        sigma['IAA'] += +0.50000000 * np.einsum('OABR,pCUV,TO,BRVASU->pCTS',Hbar['AAAA'],c['IAA'],gamma1['AA'],lambda3['AAAAAA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('OABR,pCUV,RU,TO,BVAS->pCTS',Hbar['AAAA'],c['IAA'],gamma1['AA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += +0.50000000 * np.einsum('OABR,pCUV,RU,BTVOAS->pCTS',Hbar['AAAA'],c['IAA'],gamma1['AA'],lambda3['AAAAAA'],optimize=True)
        sigma['IAA'] += -0.25000000 * np.einsum('OABR,pCUV,TU,BRVOAS->pCTS',Hbar['AAAA'],c['IAA'],gamma1['AA'],lambda3['AAAAAA'],optimize=True)
        sigma['IAA'] += +0.50000000 * np.einsum('OABR,pCUV,BROU,TVAS->pCTS',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += -1.00000000 * np.einsum('OABR,pCUV,BTOU,RVAS->pCTS',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += +1.00000000 * np.einsum('OABR,pCUV,RVAU,BTOS->pCTS',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += -0.50000000 * np.einsum('OABR,pCUV,TVAU,BROS->pCTS',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += +0.25000000 * np.einsum('OABR,pCUV,BRSU,TVOA->pCTS',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += +0.50000000 * np.einsum('OABR,pCUV,RTSU,BVOA->pCTS',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += -0.50000000 * np.einsum('OABR,pCUV,RVSU,BTOA->pCTS',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['AAAA'],optimize=True)
        sigma['IAA'] += +0.25000000 * np.einsum('OABR,pCUV,BRTVOASU->pCTS',Hbar['AAAA'],c['IAA'],lambda4['AAAAAAAA'],optimize=True)
        sigma = antisymmetrize(sigma, ea=False)
        c.clear()
        vec = dict_to_vec(sigma, northo)
        sigma.clear()
        vmv = eom_dsrg.S12.IAA.T @ vec
        diagonal.append(vmv.diagonal())
        del vec, vmv

    full_diag = np.concatenate(diagonal)
    return full_diag

def build_sigma_vector_Hbar(einsum, c, Hbar, gamma1, eta1, lambda2, lambda3, lambda4, first_row):
    sigma = {key: np.zeros(c[key].shape) for key in c.keys()}
    sigma['iIv'] += -1.00000000 * np.einsum('cd,pdCe->pcCe',Hbar['ii'],c['iIv'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('cd,pdCa,ao->pcCo',Hbar['ii'],c['iIa'],eta1['aa'],optimize=True)
    sigma['iCv'] += -1.00000000 * np.einsum('cd,pdKe->pcKe',Hbar['ii'],c['iCv'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('cd,pdKa,ao->pcKo',Hbar['ii'],c['iCa'],eta1['aa'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('cd,pdAe,OA->pcOe',Hbar['ii'],c['iAv'],gamma1['AA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('cd,pdAa,ao,OA->pcOo',Hbar['ii'],c['iAa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('cd,pdAa,aOoA->pcOo',Hbar['ii'],c['iAa'],lambda2['aAaA'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('kc,pcCe->pkCe',Hbar['ci'],c['iIv'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('kc,pcCa,ao->pkCo',Hbar['ci'],c['iIa'],eta1['aa'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('ec,pcCe->pC',Hbar['vi'],c['iIv'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oc,pcCe,ao->paCe',Hbar['ai'],c['iIv'],gamma1['aa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oc,pcCr,ra,bo->pbCa',Hbar['ai'],c['iIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oc,pcCr,broa->pbCa',Hbar['ai'],c['iIa'],lambda2['aaaa'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('oc,pcCa,ao->pC',Hbar['ai'],c['iIa'],eta1['aa'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oc,pcCa,aAoO->pCAO',Hbar['ai'],c['iIa'],lambda2['aAaA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('cedf,pdCe->pcCf',Hbar['iviv'],c['iIv'],optimize=True)
    sigma['iCv'] += -1.00000000 * np.einsum('cedf,pdKe->pcKf',Hbar['iviv'],c['iCv'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('cedf,pdAe,OA->pcOf',Hbar['iviv'],c['iAv'],gamma1['AA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('code,pdCa,ao->pcCe',Hbar['iaiv'],c['iIa'],eta1['aa'],optimize=True)
    sigma['iCv'] += -1.00000000 * np.einsum('code,pdKa,ao->pcKe',Hbar['iaiv'],c['iCa'],eta1['aa'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('code,pdAa,ao,OA->pcOe',Hbar['iaiv'],c['iAa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('code,pdAa,aOoA->pcOe',Hbar['iaiv'],c['iAa'],lambda2['aAaA'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('kecf,pcCe->pkCf',Hbar['cviv'],c['iIv'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('koce,pcCa,ao->pkCe',Hbar['caiv'],c['iIa'],eta1['aa'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('eocf,pcCe,ao->paCf',Hbar['vaiv'],c['iIv'],gamma1['aa'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oace,pcCr,ra,bo->pbCe',Hbar['aaiv'],c['iIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIv'] += +0.50000000 * np.einsum('oace,pcCr,broa->pbCe',Hbar['aaiv'],c['iIa'],lambda2['aaaa'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('cedo,pdCe,oa->pcCa',Hbar['ivia'],c['iIv'],eta1['aa'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('cedo,pdKe,oa->pcKa',Hbar['ivia'],c['iCv'],eta1['aa'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('cedo,pdAe,oa,OA->pcOa',Hbar['ivia'],c['iAv'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('cedo,pdAe,oOaA->pcOa',Hbar['ivia'],c['iAv'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('coda,pdCr,ab,ro->pcCb',Hbar['iaia'],c['iIa'],eta1['aa'],eta1['aa'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('coda,pdCr,arob->pcCb',Hbar['iaia'],c['iIa'],lambda2['aaaa'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('coda,pdKr,ab,ro->pcKb',Hbar['iaia'],c['iCa'],eta1['aa'],eta1['aa'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('coda,pdKr,arob->pcKb',Hbar['iaia'],c['iCa'],lambda2['aaaa'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('coda,pdAe,aOoA->pcOe',Hbar['iaia'],c['iAv'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('coda,pdAr,ro,aObA->pcOb',Hbar['iaia'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('coda,pdAr,ab,ro,OA->pcOb',Hbar['iaia'],c['iAa'],eta1['aa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('coda,pdAr,ab,rOoA->pcOb',Hbar['iaia'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('coda,pdAr,rb,aOoA->pcOb',Hbar['iaia'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('coda,pdAr,OA,arob->pcOb',Hbar['iaia'],c['iAa'],gamma1['AA'],lambda2['aaaa'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('coda,pdAr,arOobA->pcOb',Hbar['iaia'],c['iAa'],lambda3['aaAaaA'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('keco,pcCe,oa->pkCa',Hbar['cvia'],c['iIv'],eta1['aa'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('koca,pcCr,ab,ro->pkCb',Hbar['caia'],c['iIa'],eta1['aa'],eta1['aa'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('koca,pcCr,arob->pkCb',Hbar['caia'],c['iIa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('eoca,pcCe,ab,ro->prCb',Hbar['vaia'],c['iIv'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('eoca,pcCe,arob->prCb',Hbar['vaia'],c['iIv'],lambda2['aaaa'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('eoca,pcCe,aAoO->pCAO',Hbar['vaia'],c['iIv'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += +0.50000000 * np.einsum('oacb,pcCe,broa->prCe',Hbar['aaia'],c['iIv'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oacb,pcCt,ta,bsor->psCr',Hbar['aaia'],c['iIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oacb,pcCt,br,ta,so->psCr',Hbar['aaia'],c['iIa'],eta1['aa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('oacb,pcCt,br,stoa->psCr',Hbar['aaia'],c['iIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('oacb,pcCt,tr,bsoa->psCr',Hbar['aaia'],c['iIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oacb,pcCt,so,btar->psCr',Hbar['aaia'],c['iIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -0.50000000 * np.einsum('oacb,pcCt,bstoar->psCr',Hbar['aaia'],c['iIa'],lambda3['aaaaaa'],optimize=True)
    sigma['I'] += -0.50000000 * np.einsum('oacb,pcCr,broa->pC',Hbar['aaia'],c['iIa'],lambda2['aaaa'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oacb,pcCr,ra,bAoO->pCAO',Hbar['aaia'],c['iIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -0.50000000 * np.einsum('oacb,pcCr,brAoaO->pCAO',Hbar['aaia'],c['iIa'],lambda3['aaAaaA'],optimize=True)
    sigma['iIv'] += +1.00000000 * np.einsum('cCdD,pdDe->pcCe',Hbar['iIiI'],c['iIv'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('cCdD,pdDa,ao->pcCo',Hbar['iIiI'],c['iIa'],eta1['aa'],optimize=True)
    sigma['iCv'] += +1.00000000 * np.einsum('cKdC,pdCe->pcKe',Hbar['iCiI'],c['iIv'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('cKdC,pdCa,ao->pcKo',Hbar['iCiI'],c['iIa'],eta1['aa'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('cOdC,pdCe,AO->pcAe',Hbar['iAiI'],c['iIv'],gamma1['AA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('cOdC,pdCa,ao,AO->pcAo',Hbar['iAiI'],c['iIa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('cOdC,pdCa,aAoO->pcAo',Hbar['iAiI'],c['iIa'],lambda2['aAaA'],optimize=True)
    sigma['cIv'] += +1.00000000 * np.einsum('kCcD,pcDe->pkCe',Hbar['cIiI'],c['iIv'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kCcD,pcDa,ao->pkCo',Hbar['cIiI'],c['iIa'],eta1['aa'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('eCcD,pcDe->pC',Hbar['vIiI'],c['iIv'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oCcD,pcDe,ao->paCe',Hbar['aIiI'],c['iIv'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oCcD,pcDr,ra,bo->pbCa',Hbar['aIiI'],c['iIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oCcD,pcDr,broa->pbCa',Hbar['aIiI'],c['iIa'],lambda2['aaaa'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('oCcD,pcDa,ao->pC',Hbar['aIiI'],c['iIa'],eta1['aa'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oCcD,pcDa,aAoO->pCAO',Hbar['aIiI'],c['iIa'],lambda2['aAaA'],optimize=True)
    sigma['iIv'] += +1.00000000 * np.einsum('cCdK,pdKe->pcCe',Hbar['iIiC'],c['iCv'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('cCdK,pdKa,ao->pcCo',Hbar['iIiC'],c['iCa'],eta1['aa'],optimize=True)
    sigma['iCv'] += +1.00000000 * np.einsum('cKdL,pdLe->pcKe',Hbar['iCiC'],c['iCv'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('cKdL,pdLa,ao->pcKo',Hbar['iCiC'],c['iCa'],eta1['aa'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('cOdK,pdKe,AO->pcAe',Hbar['iAiC'],c['iCv'],gamma1['AA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('cOdK,pdKa,ao,AO->pcAo',Hbar['iAiC'],c['iCa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('cOdK,pdKa,aAoO->pcAo',Hbar['iAiC'],c['iCa'],lambda2['aAaA'],optimize=True)
    sigma['cIv'] += +1.00000000 * np.einsum('kCcK,pcKe->pkCe',Hbar['cIiC'],c['iCv'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kCcK,pcKa,ao->pkCo',Hbar['cIiC'],c['iCa'],eta1['aa'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('eCcK,pcKe->pC',Hbar['vIiC'],c['iCv'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oCcK,pcKe,ao->paCe',Hbar['aIiC'],c['iCv'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oCcK,pcKr,ra,bo->pbCa',Hbar['aIiC'],c['iCa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oCcK,pcKr,broa->pbCa',Hbar['aIiC'],c['iCa'],lambda2['aaaa'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('oCcK,pcKa,ao->pC',Hbar['aIiC'],c['iCa'],eta1['aa'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oCcK,pcKa,aAoO->pCAO',Hbar['aIiC'],c['iCa'],lambda2['aAaA'],optimize=True)
    sigma['IIV'] += +1.00000000 * np.einsum('eCcE,pcDe->pCDE',Hbar['vIiV'],c['iIv'],optimize=True)
    sigma['ICV'] += +1.00000000 * np.einsum('eCcE,pcKe->pCKE',Hbar['vIiV'],c['iCv'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('eCcE,pcAe,OA->pCOE',Hbar['vIiV'],c['iAv'],gamma1['AA'],optimize=True)
    sigma['ICV'] += -1.00000000 * np.einsum('eKcE,pcCe->pCKE',Hbar['vCiV'],c['iIv'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('eOcE,pcCe,AO->pCAE',Hbar['vAiV'],c['iIv'],gamma1['AA'],optimize=True)
    sigma['IIV'] += +1.00000000 * np.einsum('oCcE,pcDa,ao->pCDE',Hbar['aIiV'],c['iIa'],eta1['aa'],optimize=True)
    sigma['ICV'] += +1.00000000 * np.einsum('oCcE,pcKa,ao->pCKE',Hbar['aIiV'],c['iCa'],eta1['aa'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('oCcE,pcAa,ao,OA->pCOE',Hbar['aIiV'],c['iAa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('oCcE,pcAa,aOoA->pCOE',Hbar['aIiV'],c['iAa'],lambda2['aAaA'],optimize=True)
    sigma['ICV'] += -1.00000000 * np.einsum('oKcE,pcCa,ao->pCKE',Hbar['aCiV'],c['iIa'],eta1['aa'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('oOcE,pcCa,ao,AO->pCAE',Hbar['aAiV'],c['iIa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('oOcE,pcCa,aAoO->pCAE',Hbar['aAiV'],c['iIa'],lambda2['aAaA'],optimize=True)
    sigma['iIv'] += +1.00000000 * np.einsum('cCdO,pdAe,OA->pcCe',Hbar['iIiA'],c['iAv'],gamma1['AA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('cCdO,pdAa,ao,OA->pcCo',Hbar['iIiA'],c['iAa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('cCdO,pdAa,aOoA->pcCo',Hbar['iIiA'],c['iAa'],lambda2['aAaA'],optimize=True)
    sigma['iCv'] += +1.00000000 * np.einsum('cKdO,pdAe,OA->pcKe',Hbar['iCiA'],c['iAv'],gamma1['AA'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('cKdO,pdAa,ao,OA->pcKo',Hbar['iCiA'],c['iAa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('cKdO,pdAa,aOoA->pcKo',Hbar['iCiA'],c['iAa'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('cOdA,pdCa,aAoO->pcCo',Hbar['iAiA'],c['iIa'],lambda2['aAaA'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('cOdA,pdKa,aAoO->pcKo',Hbar['iAiA'],c['iCa'],lambda2['aAaA'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('cOdA,pdRe,AR,BO->pcBe',Hbar['iAiA'],c['iAv'],gamma1['AA'],gamma1['AA'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('cOdA,pdRe,ABOR->pcBe',Hbar['iAiA'],c['iAv'],lambda2['AAAA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('cOdA,pdRa,ao,AR,BO->pcBo',Hbar['iAiA'],c['iAa'],eta1['aa'],gamma1['AA'],gamma1['AA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('cOdA,pdRa,ao,ABOR->pcBo',Hbar['iAiA'],c['iAa'],eta1['aa'],lambda2['AAAA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('cOdA,pdRa,BO,aAoR->pcBo',Hbar['iAiA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('cOdA,pdRa,AR,aBoO->pcBo',Hbar['iAiA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('cOdA,pdRa,BR,aAoO->pcBo',Hbar['iAiA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('cOdA,pdRa,aABoOR->pcBo',Hbar['iAiA'],c['iAa'],lambda3['aAAaAA'],optimize=True)
    sigma['cIv'] += +1.00000000 * np.einsum('kCcO,pcAe,OA->pkCe',Hbar['cIiA'],c['iAv'],gamma1['AA'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kCcO,pcAa,ao,OA->pkCo',Hbar['cIiA'],c['iAa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('kCcO,pcAa,aOoA->pkCo',Hbar['cIiA'],c['iAa'],lambda2['aAaA'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kOcA,pcCa,aAoO->pkCo',Hbar['cAiA'],c['iIa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('eCcO,pcAe,aOoA->paCo',Hbar['vIiA'],c['iAv'],lambda2['aAaA'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('eCcO,pcAe,OA->pC',Hbar['vIiA'],c['iAv'],gamma1['AA'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('eCcO,pcDe,OA->pCDA',Hbar['vIiA'],c['iIv'],eta1['AA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('eCcO,pcKe,OA->pCKA',Hbar['vIiA'],c['iCv'],eta1['AA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('eCcO,pcRe,OA,BR->pCBA',Hbar['vIiA'],c['iAv'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('eCcO,pcRe,OBAR->pCBA',Hbar['vIiA'],c['iAv'],lambda2['AAAA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('eKcO,pcCe,OA->pCKA',Hbar['vCiA'],c['iIv'],eta1['AA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('eOcA,pcCe,aAoO->paCo',Hbar['vAiA'],c['iIv'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('eOcA,pcCe,AB,RO->pCRB',Hbar['vAiA'],c['iIv'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('eOcA,pcCe,AROB->pCRB',Hbar['vAiA'],c['iIv'],lambda2['AAAA'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oCcO,pcAe,OA,ao->paCe',Hbar['aIiA'],c['iAv'],gamma1['AA'],gamma1['aa'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oCcO,pcAe,aOoA->paCe',Hbar['aIiA'],c['iAv'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oCcO,pcAr,ro,bOaA->pbCa',Hbar['aIiA'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oCcO,pcAr,ra,OA,bo->pbCa',Hbar['aIiA'],c['iAa'],eta1['aa'],gamma1['AA'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oCcO,pcAr,ra,bOoA->pbCa',Hbar['aIiA'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oCcO,pcAr,bo,rOaA->pbCa',Hbar['aIiA'],c['iAa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oCcO,pcAr,OA,broa->pbCa',Hbar['aIiA'],c['iAa'],gamma1['AA'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oCcO,pcAr,brOoaA->pbCa',Hbar['aIiA'],c['iAa'],lambda3['aaAaaA'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('oCcO,pcAa,ao,OA->pC',Hbar['aIiA'],c['iAa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('oCcO,pcAa,aOoA->pC',Hbar['aIiA'],c['iAa'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('oCcO,pcDa,OA,ao->pCDA',Hbar['aIiA'],c['iIa'],eta1['AA'],eta1['aa'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('oCcO,pcDa,aOoA->pCDA',Hbar['aIiA'],c['iIa'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('oCcO,pcKa,OA,ao->pCKA',Hbar['aIiA'],c['iCa'],eta1['AA'],eta1['aa'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('oCcO,pcKa,aOoA->pCKA',Hbar['aIiA'],c['iCa'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oCcO,pcRa,ao,OBAR->pCBA',Hbar['aIiA'],c['iAa'],eta1['aa'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oCcO,pcRa,OA,ao,BR->pCBA',Hbar['aIiA'],c['iAa'],eta1['AA'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oCcO,pcRa,OA,aBoR->pCBA',Hbar['aIiA'],c['iAa'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oCcO,pcRa,OR,aBoA->pCBA',Hbar['aIiA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oCcO,pcRa,BR,aOoA->pCBA',Hbar['aIiA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oCcO,pcRa,aOBoAR->pCBA',Hbar['aIiA'],c['iAa'],lambda3['aAAaAA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('oKcO,pcCa,OA,ao->pCKA',Hbar['aCiA'],c['iIa'],eta1['AA'],eta1['aa'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('oKcO,pcCa,aOoA->pCKA',Hbar['aCiA'],c['iIa'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oOcA,pcCe,aAoO->paCe',Hbar['aAiA'],c['iIv'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOcA,pcCr,ro,bAaO->pbCa',Hbar['aAiA'],c['iIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOcA,pcCr,ra,bAoO->pbCa',Hbar['aAiA'],c['iIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOcA,pcCr,bo,rAaO->pbCa',Hbar['aAiA'],c['iIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOcA,pcCr,brAoaO->pbCa',Hbar['aAiA'],c['iIa'],lambda3['aaAaaA'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('oOcA,pcCa,aAoO->pC',Hbar['aAiA'],c['iIa'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOcA,pcCa,ao,AROB->pCRB',Hbar['aAiA'],c['iIa'],eta1['aa'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOcA,pcCa,AB,ao,RO->pCRB',Hbar['aAiA'],c['iIa'],eta1['AA'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOcA,pcCa,AB,aRoO->pCRB',Hbar['aAiA'],c['iIa'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOcA,pcCa,RO,aAoB->pCRB',Hbar['aAiA'],c['iIa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOcA,pcCa,aARoOB->pCRB',Hbar['aAiA'],c['iIa'],lambda3['aAAaAA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('ck,pkCe->pcCe',Hbar['ic'],c['cIv'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('ck,pkCa,ao->pcCo',Hbar['ic'],c['cIa'],eta1['aa'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('kl,plCe->pkCe',Hbar['cc'],c['cIv'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('kl,plCa,ao->pkCo',Hbar['cc'],c['cIa'],eta1['aa'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('ek,pkCe->pC',Hbar['vc'],c['cIv'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('ok,pkCe,ao->paCe',Hbar['ac'],c['cIv'],gamma1['aa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('ok,pkCr,ra,bo->pbCa',Hbar['ac'],c['cIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('ok,pkCr,broa->pbCa',Hbar['ac'],c['cIa'],lambda2['aaaa'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('ok,pkCa,ao->pC',Hbar['ac'],c['cIa'],eta1['aa'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('ok,pkCa,aAoO->pCAO',Hbar['ac'],c['cIa'],lambda2['aAaA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('cekf,pkCe->pcCf',Hbar['ivcv'],c['cIv'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('coke,pkCa,ao->pcCe',Hbar['iacv'],c['cIa'],eta1['aa'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('kelf,plCe->pkCf',Hbar['cvcv'],c['cIv'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('kole,plCa,ao->pkCe',Hbar['cacv'],c['cIa'],eta1['aa'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('eokf,pkCe,ao->paCf',Hbar['vacv'],c['cIv'],gamma1['aa'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oake,pkCr,ra,bo->pbCe',Hbar['aacv'],c['cIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIv'] += +0.50000000 * np.einsum('oake,pkCr,broa->pbCe',Hbar['aacv'],c['cIa'],lambda2['aaaa'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('ceko,pkCe,oa->pcCa',Hbar['ivca'],c['cIv'],eta1['aa'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('coka,pkCr,ab,ro->pcCb',Hbar['iaca'],c['cIa'],eta1['aa'],eta1['aa'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('coka,pkCr,arob->pcCb',Hbar['iaca'],c['cIa'],lambda2['aaaa'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('kelo,plCe,oa->pkCa',Hbar['cvca'],c['cIv'],eta1['aa'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('kola,plCr,ab,ro->pkCb',Hbar['caca'],c['cIa'],eta1['aa'],eta1['aa'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kola,plCr,arob->pkCb',Hbar['caca'],c['cIa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('eoka,pkCe,ab,ro->prCb',Hbar['vaca'],c['cIv'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('eoka,pkCe,arob->prCb',Hbar['vaca'],c['cIv'],lambda2['aaaa'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('eoka,pkCe,aAoO->pCAO',Hbar['vaca'],c['cIv'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += +0.50000000 * np.einsum('oakb,pkCe,broa->prCe',Hbar['aaca'],c['cIv'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oakb,pkCt,ta,bsor->psCr',Hbar['aaca'],c['cIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oakb,pkCt,br,ta,so->psCr',Hbar['aaca'],c['cIa'],eta1['aa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('oakb,pkCt,br,stoa->psCr',Hbar['aaca'],c['cIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('oakb,pkCt,tr,bsoa->psCr',Hbar['aaca'],c['cIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oakb,pkCt,so,btar->psCr',Hbar['aaca'],c['cIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -0.50000000 * np.einsum('oakb,pkCt,bstoar->psCr',Hbar['aaca'],c['cIa'],lambda3['aaaaaa'],optimize=True)
    sigma['I'] += -0.50000000 * np.einsum('oakb,pkCr,broa->pC',Hbar['aaca'],c['cIa'],lambda2['aaaa'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oakb,pkCr,ra,bAoO->pCAO',Hbar['aaca'],c['cIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -0.50000000 * np.einsum('oakb,pkCr,brAoaO->pCAO',Hbar['aaca'],c['cIa'],lambda3['aaAaaA'],optimize=True)
    sigma['iIv'] += +1.00000000 * np.einsum('cCkD,pkDe->pcCe',Hbar['iIcI'],c['cIv'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('cCkD,pkDa,ao->pcCo',Hbar['iIcI'],c['cIa'],eta1['aa'],optimize=True)
    sigma['iCv'] += +1.00000000 * np.einsum('cKkC,pkCe->pcKe',Hbar['iCcI'],c['cIv'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('cKkC,pkCa,ao->pcKo',Hbar['iCcI'],c['cIa'],eta1['aa'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('cOkC,pkCe,AO->pcAe',Hbar['iAcI'],c['cIv'],gamma1['AA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('cOkC,pkCa,ao,AO->pcAo',Hbar['iAcI'],c['cIa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('cOkC,pkCa,aAoO->pcAo',Hbar['iAcI'],c['cIa'],lambda2['aAaA'],optimize=True)
    sigma['cIv'] += +1.00000000 * np.einsum('kClD,plDe->pkCe',Hbar['cIcI'],c['cIv'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kClD,plDa,ao->pkCo',Hbar['cIcI'],c['cIa'],eta1['aa'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('eCkD,pkDe->pC',Hbar['vIcI'],c['cIv'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oCkD,pkDe,ao->paCe',Hbar['aIcI'],c['cIv'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oCkD,pkDr,ra,bo->pbCa',Hbar['aIcI'],c['cIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oCkD,pkDr,broa->pbCa',Hbar['aIcI'],c['cIa'],lambda2['aaaa'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('oCkD,pkDa,ao->pC',Hbar['aIcI'],c['cIa'],eta1['aa'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oCkD,pkDa,aAoO->pCAO',Hbar['aIcI'],c['cIa'],lambda2['aAaA'],optimize=True)
    sigma['IIV'] += +1.00000000 * np.einsum('eCkE,pkDe->pCDE',Hbar['vIcV'],c['cIv'],optimize=True)
    sigma['ICV'] += -1.00000000 * np.einsum('eKkE,pkCe->pCKE',Hbar['vCcV'],c['cIv'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('eOkE,pkCe,AO->pCAE',Hbar['vAcV'],c['cIv'],gamma1['AA'],optimize=True)
    sigma['IIV'] += +1.00000000 * np.einsum('oCkE,pkDa,ao->pCDE',Hbar['aIcV'],c['cIa'],eta1['aa'],optimize=True)
    sigma['ICV'] += -1.00000000 * np.einsum('oKkE,pkCa,ao->pCKE',Hbar['aCcV'],c['cIa'],eta1['aa'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('oOkE,pkCa,ao,AO->pCAE',Hbar['aAcV'],c['cIa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('oOkE,pkCa,aAoO->pCAE',Hbar['aAcV'],c['cIa'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('cOkA,pkCa,aAoO->pcCo',Hbar['iAcA'],c['cIa'],lambda2['aAaA'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kOlA,plCa,aAoO->pkCo',Hbar['cAcA'],c['cIa'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('eCkO,pkDe,OA->pCDA',Hbar['vIcA'],c['cIv'],eta1['AA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('eKkO,pkCe,OA->pCKA',Hbar['vCcA'],c['cIv'],eta1['AA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('eOkA,pkCe,aAoO->paCo',Hbar['vAcA'],c['cIv'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('eOkA,pkCe,AB,RO->pCRB',Hbar['vAcA'],c['cIv'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('eOkA,pkCe,AROB->pCRB',Hbar['vAcA'],c['cIv'],lambda2['AAAA'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('oCkO,pkDa,OA,ao->pCDA',Hbar['aIcA'],c['cIa'],eta1['AA'],eta1['aa'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('oCkO,pkDa,aOoA->pCDA',Hbar['aIcA'],c['cIa'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('oKkO,pkCa,OA,ao->pCKA',Hbar['aCcA'],c['cIa'],eta1['AA'],eta1['aa'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('oKkO,pkCa,aOoA->pCKA',Hbar['aCcA'],c['cIa'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oOkA,pkCe,aAoO->paCe',Hbar['aAcA'],c['cIv'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOkA,pkCr,ro,bAaO->pbCa',Hbar['aAcA'],c['cIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOkA,pkCr,ra,bAoO->pbCa',Hbar['aAcA'],c['cIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOkA,pkCr,bo,rAaO->pbCa',Hbar['aAcA'],c['cIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOkA,pkCr,brAoaO->pbCa',Hbar['aAcA'],c['cIa'],lambda3['aaAaaA'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('oOkA,pkCa,aAoO->pC',Hbar['aAcA'],c['cIa'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOkA,pkCa,ao,AROB->pCRB',Hbar['aAcA'],c['cIa'],eta1['aa'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOkA,pkCa,AB,ao,RO->pCRB',Hbar['aAcA'],c['cIa'],eta1['AA'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOkA,pkCa,AB,aRoO->pCRB',Hbar['aAcA'],c['cIa'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOkA,pkCa,RO,aAoB->pCRB',Hbar['aAcA'],c['cIa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOkA,pkCa,aARoOB->pCRB',Hbar['aAcA'],c['cIa'],lambda3['aAAaAA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('ce,pC->pcCe',Hbar['iv'],c['I'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('ke,pC->pkCe',Hbar['cv'],c['I'],optimize=True)
    sigma['iIv'] += +1.00000000 * np.einsum('ef,pcCe->pcCf',Hbar['vv'],c['iIv'],optimize=True)
    sigma['iCv'] += +1.00000000 * np.einsum('ef,pcKe->pcKf',Hbar['vv'],c['iCv'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('ef,pcAe,OA->pcOf',Hbar['vv'],c['iAv'],gamma1['AA'],optimize=True)
    sigma['cIv'] += +1.00000000 * np.einsum('ef,pkCe->pkCf',Hbar['vv'],c['cIv'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('ef,paCe,oa->poCf',Hbar['vv'],c['aIv'],gamma1['aa'],optimize=True)
    sigma['iIv'] += +1.00000000 * np.einsum('oe,pcCa,ao->pcCe',Hbar['av'],c['iIa'],eta1['aa'],optimize=True)
    sigma['iCv'] += +1.00000000 * np.einsum('oe,pcKa,ao->pcKe',Hbar['av'],c['iCa'],eta1['aa'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('oe,pcAa,ao,OA->pcOe',Hbar['av'],c['iAa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('oe,pcAa,aOoA->pcOe',Hbar['av'],c['iAa'],lambda2['aAaA'],optimize=True)
    sigma['cIv'] += +1.00000000 * np.einsum('oe,pkCa,ao->pkCe',Hbar['av'],c['cIa'],eta1['aa'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oe,pC,ao->paCe',Hbar['av'],c['I'],gamma1['aa'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oe,pbCr,ro,ab->paCe',Hbar['av'],c['aIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oe,pbCr,arob->paCe',Hbar['av'],c['aIa'],lambda2['aaaa'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oe,pCOA,aAoO->paCe',Hbar['av'],c['IAA'],lambda2['aAaA'],optimize=True)
    sigma['iIv'] += +1.00000000 * np.einsum('cefo,paCe,oa->pcCf',Hbar['ivva'],c['aIv'],gamma1['aa'],optimize=True)
    sigma['iIv'] += +1.00000000 * np.einsum('coea,pbCr,ro,ab->pcCe',Hbar['iava'],c['aIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['iIv'] += +1.00000000 * np.einsum('coea,pbCr,arob->pcCe',Hbar['iava'],c['aIa'],lambda2['aaaa'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('coea,pCOA,aAoO->pcCe',Hbar['iava'],c['IAA'],lambda2['aAaA'],optimize=True)
    sigma['cIv'] += +1.00000000 * np.einsum('kefo,paCe,oa->pkCf',Hbar['cvva'],c['aIv'],gamma1['aa'],optimize=True)
    sigma['cIv'] += +1.00000000 * np.einsum('koea,pbCr,ro,ab->pkCe',Hbar['cava'],c['aIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['cIv'] += +1.00000000 * np.einsum('koea,pbCr,arob->pkCe',Hbar['cava'],c['aIa'],lambda2['aaaa'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('koea,pCOA,aAoO->pkCe',Hbar['cava'],c['IAA'],lambda2['aAaA'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('eofa,pcAe,aOoA->pcOf',Hbar['vava'],c['iAv'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('eofa,prCe,ar,bo->pbCf',Hbar['vava'],c['aIv'],gamma1['aa'],gamma1['aa'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('eofa,prCe,abor->pbCf',Hbar['vava'],c['aIv'],lambda2['aaaa'],optimize=True)
    sigma['iIv'] += +0.50000000 * np.einsum('oaeb,pcCr,broa->pcCe',Hbar['aava'],c['iIa'],lambda2['aaaa'],optimize=True)
    sigma['iCv'] += +0.50000000 * np.einsum('oaeb,pcKr,broa->pcKe',Hbar['aava'],c['iCa'],lambda2['aaaa'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('oaeb,pcAr,ra,bOoA->pcOe',Hbar['aava'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iAv'] += +0.50000000 * np.einsum('oaeb,pcAr,OA,broa->pcOe',Hbar['aava'],c['iAa'],gamma1['AA'],lambda2['aaaa'],optimize=True)
    sigma['iAv'] += +0.50000000 * np.einsum('oaeb,pcAr,brOoaA->pcOe',Hbar['aava'],c['iAa'],lambda3['aaAaaA'],optimize=True)
    sigma['cIv'] += +0.50000000 * np.einsum('oaeb,pkCr,broa->pkCe',Hbar['aava'],c['cIa'],lambda2['aaaa'],optimize=True)
    sigma['aIv'] += +0.50000000 * np.einsum('oaeb,pC,broa->prCe',Hbar['aava'],c['I'],lambda2['aaaa'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oaeb,psCt,ta,bs,ro->prCe',Hbar['aava'],c['aIa'],eta1['aa'],gamma1['aa'],gamma1['aa'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oaeb,psCt,ta,bros->prCe',Hbar['aava'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oaeb,psCt,ro,btas->prCe',Hbar['aava'],c['aIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIv'] += -0.50000000 * np.einsum('oaeb,psCt,bs,rtoa->prCe',Hbar['aava'],c['aIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIv'] += +0.50000000 * np.einsum('oaeb,psCt,rs,btoa->prCe',Hbar['aava'],c['aIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIv'] += -0.50000000 * np.einsum('oaeb,psCt,brtoas->prCe',Hbar['aava'],c['aIa'],lambda3['aaaaaa'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oaeb,pCOA,ro,bAaO->prCe',Hbar['aava'],c['IAA'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += +0.50000000 * np.einsum('oaeb,pCOA,brAoaO->prCe',Hbar['aava'],c['IAA'],lambda3['aaAaaA'],optimize=True)
    sigma['iIv'] += +1.00000000 * np.einsum('cCeD,pD->pcCe',Hbar['iIvI'],c['I'],optimize=True)
    sigma['iCv'] += +1.00000000 * np.einsum('cKeC,pC->pcKe',Hbar['iCvI'],c['I'],optimize=True)
    sigma['iIv'] += +1.00000000 * np.einsum('cEeC,pCDE->pcDe',Hbar['iVvI'],c['IIV'],optimize=True)
    sigma['iCv'] += +1.00000000 * np.einsum('cEeC,pCKE->pcKe',Hbar['iVvI'],c['ICV'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('cEeC,pCAE,OA->pcOe',Hbar['iVvI'],c['IAV'],gamma1['AA'],optimize=True)
    sigma['iIv'] += +1.00000000 * np.einsum('cOeC,pCDA,AO->pcDe',Hbar['iAvI'],c['IIA'],eta1['AA'],optimize=True)
    sigma['iCv'] += +1.00000000 * np.einsum('cOeC,pCKA,AO->pcKe',Hbar['iAvI'],c['ICA'],eta1['AA'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('cOeC,pC,AO->pcAe',Hbar['iAvI'],c['I'],gamma1['AA'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('cOeC,poCa,aAoO->pcAe',Hbar['iAvI'],c['aIa'],lambda2['aAaA'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('cOeC,pCBR,RO,AB->pcAe',Hbar['iAvI'],c['IAA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('cOeC,pCBR,AROB->pcAe',Hbar['iAvI'],c['IAA'],lambda2['AAAA'],optimize=True)
    sigma['cIv'] += +1.00000000 * np.einsum('kCeD,pD->pkCe',Hbar['cIvI'],c['I'],optimize=True)
    sigma['cIv'] += +1.00000000 * np.einsum('kEeC,pCDE->pkDe',Hbar['cVvI'],c['IIV'],optimize=True)
    sigma['cIv'] += +1.00000000 * np.einsum('kOeC,pCDA,AO->pkDe',Hbar['cAvI'],c['IIA'],eta1['AA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('eCfD,pcDe->pcCf',Hbar['vIvI'],c['iIv'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('eCfD,pkDe->pkCf',Hbar['vIvI'],c['cIv'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('eCfD,paDe,oa->poCf',Hbar['vIvI'],c['aIv'],gamma1['aa'],optimize=True)
    sigma['iCv'] += -1.00000000 * np.einsum('eKfC,pcCe->pcKf',Hbar['vCvI'],c['iIv'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('eOfC,pcCe,AO->pcAf',Hbar['vAvI'],c['iIv'],gamma1['AA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('oCeD,pcDa,ao->pcCe',Hbar['aIvI'],c['iIa'],eta1['aa'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('oCeD,pkDa,ao->pkCe',Hbar['aIvI'],c['cIa'],eta1['aa'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oCeD,pD,ao->paCe',Hbar['aIvI'],c['I'],gamma1['aa'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oCeD,pbDr,ro,ab->paCe',Hbar['aIvI'],c['aIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oCeD,pbDr,arob->paCe',Hbar['aIvI'],c['aIa'],lambda2['aaaa'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oCeD,pDOA,aAoO->paCe',Hbar['aIvI'],c['IAA'],lambda2['aAaA'],optimize=True)
    sigma['iCv'] += -1.00000000 * np.einsum('oKeC,pcCa,ao->pcKe',Hbar['aCvI'],c['iIa'],eta1['aa'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oEeC,pCDE,ao->paDe',Hbar['aVvI'],c['IIV'],gamma1['aa'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('oOeC,pcCa,ao,AO->pcAe',Hbar['aAvI'],c['iIa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('oOeC,pcCa,aAoO->pcAe',Hbar['aAvI'],c['iIa'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oOeC,pCDA,AO,ao->paDe',Hbar['aAvI'],c['IIA'],eta1['AA'],gamma1['aa'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oOeC,pCDA,aAoO->paDe',Hbar['aAvI'],c['IIA'],lambda2['aAaA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('cEeK,pCKE->pcCe',Hbar['iVvC'],c['ICV'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('cOeK,pCKA,AO->pcCe',Hbar['iAvC'],c['ICA'],eta1['AA'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('kEeK,pCKE->pkCe',Hbar['cVvC'],c['ICV'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('kOeK,pCKA,AO->pkCe',Hbar['cAvC'],c['ICA'],eta1['AA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('eCfK,pcKe->pcCf',Hbar['vIvC'],c['iCv'],optimize=True)
    sigma['iCv'] += -1.00000000 * np.einsum('eKfL,pcLe->pcKf',Hbar['vCvC'],c['iCv'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('eOfK,pcKe,AO->pcAf',Hbar['vAvC'],c['iCv'],gamma1['AA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('oCeK,pcKa,ao->pcCe',Hbar['aIvC'],c['iCa'],eta1['aa'],optimize=True)
    sigma['iCv'] += -1.00000000 * np.einsum('oKeL,pcLa,ao->pcKe',Hbar['aCvC'],c['iCa'],eta1['aa'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oEeK,pCKE,ao->paCe',Hbar['aVvC'],c['ICV'],gamma1['aa'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('oOeK,pcKa,ao,AO->pcAe',Hbar['aAvC'],c['iCa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('oOeK,pcKa,aAoO->pcAe',Hbar['aAvC'],c['iCa'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oOeK,pCKA,AO,ao->paCe',Hbar['aAvC'],c['ICA'],eta1['AA'],gamma1['aa'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oOeK,pCKA,aAoO->paCe',Hbar['aAvC'],c['ICA'],lambda2['aAaA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('cEeO,pCAE,OA->pcCe',Hbar['iVvA'],c['IAV'],gamma1['AA'],optimize=True)
    sigma['iIv'] += +1.00000000 * np.einsum('cOeA,poCa,aAoO->pcCe',Hbar['iAvA'],c['aIa'],lambda2['aAaA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('cOeA,pCBR,RO,AB->pcCe',Hbar['iAvA'],c['IAA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('cOeA,pCBR,AROB->pcCe',Hbar['iAvA'],c['IAA'],lambda2['AAAA'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('kEeO,pCAE,OA->pkCe',Hbar['cVvA'],c['IAV'],gamma1['AA'],optimize=True)
    sigma['cIv'] += +1.00000000 * np.einsum('kOeA,poCa,aAoO->pkCe',Hbar['cAvA'],c['aIa'],lambda2['aAaA'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('kOeA,pCBR,RO,AB->pkCe',Hbar['cAvA'],c['IAA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('kOeA,pCBR,AROB->pkCe',Hbar['cAvA'],c['IAA'],lambda2['AAAA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('eCfO,pcAe,OA->pcCf',Hbar['vIvA'],c['iAv'],gamma1['AA'],optimize=True)
    sigma['iCv'] += -1.00000000 * np.einsum('eKfO,pcAe,OA->pcKf',Hbar['vCvA'],c['iAv'],gamma1['AA'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('eOfA,pcRe,AR,BO->pcBf',Hbar['vAvA'],c['iAv'],gamma1['AA'],gamma1['AA'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('eOfA,pcRe,ABOR->pcBf',Hbar['vAvA'],c['iAv'],lambda2['AAAA'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('eOfA,paCe,oAaO->poCf',Hbar['vAvA'],c['aIv'],lambda2['aAaA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('oCeO,pcAa,ao,OA->pcCe',Hbar['aIvA'],c['iAa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iIv'] += +1.00000000 * np.einsum('oCeO,pcAa,aOoA->pcCe',Hbar['aIvA'],c['iAa'],lambda2['aAaA'],optimize=True)
    sigma['iCv'] += -1.00000000 * np.einsum('oKeO,pcAa,ao,OA->pcKe',Hbar['aCvA'],c['iAa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iCv'] += +1.00000000 * np.einsum('oKeO,pcAa,aOoA->pcKe',Hbar['aCvA'],c['iAa'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oEeO,pCAE,OA,ao->paCe',Hbar['aVvA'],c['IAV'],gamma1['AA'],gamma1['aa'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oEeO,pCAE,aOoA->paCe',Hbar['aVvA'],c['IAV'],lambda2['aAaA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('oOeA,pcCa,aAoO->pcCe',Hbar['aAvA'],c['iIa'],lambda2['aAaA'],optimize=True)
    sigma['iCv'] += -1.00000000 * np.einsum('oOeA,pcKa,aAoO->pcKe',Hbar['aAvA'],c['iCa'],lambda2['aAaA'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('oOeA,pcRa,ao,AR,BO->pcBe',Hbar['aAvA'],c['iAa'],eta1['aa'],gamma1['AA'],gamma1['AA'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('oOeA,pcRa,ao,ABOR->pcBe',Hbar['aAvA'],c['iAa'],eta1['aa'],lambda2['AAAA'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('oOeA,pcRa,BO,aAoR->pcBe',Hbar['aAvA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('oOeA,pcRa,AR,aBoO->pcBe',Hbar['aAvA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('oOeA,pcRa,BR,aAoO->pcBe',Hbar['aAvA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('oOeA,pcRa,aABoOR->pcBe',Hbar['aAvA'],c['iAa'],lambda3['aAAaAA'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('oOeA,pkCa,aAoO->pkCe',Hbar['aAvA'],c['cIa'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oOeA,pC,aAoO->paCe',Hbar['aAvA'],c['I'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oOeA,pbCr,ro,aAbO->paCe',Hbar['aAvA'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oOeA,pbCr,ao,rAbO->paCe',Hbar['aAvA'],c['aIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oOeA,pbCr,ab,rAoO->paCe',Hbar['aAvA'],c['aIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oOeA,pbCr,arAobO->paCe',Hbar['aAvA'],c['aIa'],lambda3['aaAaaA'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oOeA,pCBR,RO,AB,ao->paCe',Hbar['aAvA'],c['IAA'],eta1['AA'],gamma1['AA'],gamma1['aa'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oOeA,pCBR,RO,aAoB->paCe',Hbar['aAvA'],c['IAA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oOeA,pCBR,ao,AROB->paCe',Hbar['aAvA'],c['IAA'],gamma1['aa'],lambda2['AAAA'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oOeA,pCBR,AB,aRoO->paCe',Hbar['aAvA'],c['IAA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oOeA,pCBR,aARoOB->paCe',Hbar['aAvA'],c['IAA'],lambda3['aAAaAA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('co,paCe,oa->pcCe',Hbar['ia'],c['aIv'],gamma1['aa'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('co,pC,oa->pcCa',Hbar['ia'],c['I'],eta1['aa'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('co,pbCr,ra,ob->pcCa',Hbar['ia'],c['aIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('co,pbCr,orab->pcCa',Hbar['ia'],c['aIa'],lambda2['aaaa'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('co,pCOA,oAaO->pcCa',Hbar['ia'],c['IAA'],lambda2['aAaA'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('ko,paCe,oa->pkCe',Hbar['ca'],c['aIv'],gamma1['aa'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('ko,pC,oa->pkCa',Hbar['ca'],c['I'],eta1['aa'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('ko,pbCr,ra,ob->pkCa',Hbar['ca'],c['aIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('ko,pbCr,orab->pkCa',Hbar['ca'],c['aIa'],lambda2['aaaa'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('ko,pCOA,oAaO->pkCa',Hbar['ca'],c['IAA'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('eo,pcCe,oa->pcCa',Hbar['va'],c['iIv'],eta1['aa'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('eo,pcKe,oa->pcKa',Hbar['va'],c['iCv'],eta1['aa'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('eo,pcAe,oa,OA->pcOa',Hbar['va'],c['iAv'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('eo,pcAe,oOaA->pcOa',Hbar['va'],c['iAv'],lambda2['aAaA'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('eo,pkCe,oa->pkCa',Hbar['va'],c['cIv'],eta1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('eo,prCe,oa,br->pbCa',Hbar['va'],c['aIv'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('eo,prCe,obar->pbCa',Hbar['va'],c['aIv'],lambda2['aaaa'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('eo,paCe,oa->pC',Hbar['va'],c['aIv'],gamma1['aa'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('eo,paCe,oAaO->pCAO',Hbar['va'],c['aIv'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('oa,pcCr,ab,ro->pcCb',Hbar['aa'],c['iIa'],eta1['aa'],eta1['aa'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('oa,pcCr,arob->pcCb',Hbar['aa'],c['iIa'],lambda2['aaaa'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('oa,pcKr,ab,ro->pcKb',Hbar['aa'],c['iCa'],eta1['aa'],eta1['aa'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('oa,pcKr,arob->pcKb',Hbar['aa'],c['iCa'],lambda2['aaaa'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('oa,pcAe,aOoA->pcOe',Hbar['aa'],c['iAv'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oa,pcAr,ro,aObA->pcOb',Hbar['aa'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oa,pcAr,ab,ro,OA->pcOb',Hbar['aa'],c['iAa'],eta1['aa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oa,pcAr,ab,rOoA->pcOb',Hbar['aa'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oa,pcAr,rb,aOoA->pcOb',Hbar['aa'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oa,pcAr,OA,arob->pcOb',Hbar['aa'],c['iAa'],gamma1['AA'],lambda2['aaaa'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oa,pcAr,arOobA->pcOb',Hbar['aa'],c['iAa'],lambda3['aaAaaA'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('oa,pkCr,ab,ro->pkCb',Hbar['aa'],c['cIa'],eta1['aa'],eta1['aa'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('oa,pkCr,arob->pkCb',Hbar['aa'],c['cIa'],lambda2['aaaa'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oa,prCe,ar,bo->pbCe',Hbar['aa'],c['aIv'],gamma1['aa'],gamma1['aa'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oa,prCe,abor->pbCe',Hbar['aa'],c['aIv'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oa,pC,ab,ro->prCb',Hbar['aa'],c['I'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oa,pC,arob->prCb',Hbar['aa'],c['I'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oa,psCt,to,arbs->prCb',Hbar['aa'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oa,psCt,ab,to,rs->prCb',Hbar['aa'],c['aIa'],eta1['aa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oa,psCt,ab,rtos->prCb',Hbar['aa'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oa,psCt,tb,as,ro->prCb',Hbar['aa'],c['aIa'],eta1['aa'],gamma1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oa,psCt,tb,aros->prCb',Hbar['aa'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oa,psCt,ro,atbs->prCb',Hbar['aa'],c['aIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oa,psCt,as,rtob->prCb',Hbar['aa'],c['aIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oa,psCt,rs,atob->prCb',Hbar['aa'],c['aIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oa,psCt,artobs->prCb',Hbar['aa'],c['aIa'],lambda3['aaaaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oa,pCOA,ab,rAoO->prCb',Hbar['aa'],c['IAA'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oa,pCOA,ro,aAbO->prCb',Hbar['aa'],c['IAA'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oa,pCOA,arAobO->prCb',Hbar['aa'],c['IAA'],lambda3['aaAaaA'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('oa,pbCr,ro,ab->pC',Hbar['aa'],c['aIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('oa,pbCr,arob->pC',Hbar['aa'],c['aIa'],lambda2['aaaa'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('oa,pCOA,aAoO->pC',Hbar['aa'],c['IAA'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += -0.50000000 * np.einsum('oa,pCDA,aAoO->pCDO',Hbar['aa'],c['IIA'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('oa,pCKA,aAoO->pCKO',Hbar['aa'],c['ICA'],lambda2['aAaA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('oa,pCAE,aOoA->pCOE',Hbar['aa'],c['IAV'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oa,pC,aAoO->pCAO',Hbar['aa'],c['I'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oa,pbCr,ro,aAbO->pCAO',Hbar['aa'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oa,pbCr,ab,rAoO->pCAO',Hbar['aa'],c['aIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oa,pbCr,arAobO->pCAO',Hbar['aa'],c['aIa'],lambda3['aaAaaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oa,pCBR,RO,aAoB->pCAO',Hbar['aa'],c['IAA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oa,pCBR,AB,aRoO->pCAO',Hbar['aa'],c['IAA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oa,pCBR,aARoOB->pCAO',Hbar['aa'],c['IAA'],lambda3['aAAaAA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('ceoa,prCe,ob,ar->pcCb',Hbar['ivaa'],c['aIv'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['iIa'] += -0.50000000 * np.einsum('ceoa,prCe,oabr->pcCb',Hbar['ivaa'],c['aIv'],lambda2['aaaa'],optimize=True)
    sigma['iIv'] += +0.50000000 * np.einsum('coab,prCe,abor->pcCe',Hbar['iaaa'],c['aIv'],lambda2['aaaa'],optimize=True)
    sigma['iIa'] += -0.50000000 * np.einsum('coab,pC,abor->pcCr',Hbar['iaaa'],c['I'],lambda2['aaaa'],optimize=True)
    sigma['iIa'] += -0.50000000 * np.einsum('coab,psCt,to,abrs->pcCr',Hbar['iaaa'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('coab,psCt,ar,to,bs->pcCr',Hbar['iaaa'],c['aIa'],eta1['aa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('coab,psCt,ar,btos->pcCr',Hbar['iaaa'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['iIa'] += +0.50000000 * np.einsum('coab,psCt,tr,abos->pcCr',Hbar['iaaa'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('coab,psCt,bs,ator->pcCr',Hbar['iaaa'],c['aIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['iIa'] += +0.50000000 * np.einsum('coab,psCt,abtors->pcCr',Hbar['iaaa'],c['aIa'],lambda3['aaaaaa'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('coab,pCOA,ar,bAoO->pcCr',Hbar['iaaa'],c['IAA'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += -0.50000000 * np.einsum('coab,pCOA,abAorO->pcCr',Hbar['iaaa'],c['IAA'],lambda3['aaAaaA'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('keoa,prCe,ob,ar->pkCb',Hbar['cvaa'],c['aIv'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['cIa'] += -0.50000000 * np.einsum('keoa,prCe,oabr->pkCb',Hbar['cvaa'],c['aIv'],lambda2['aaaa'],optimize=True)
    sigma['cIv'] += +0.50000000 * np.einsum('koab,prCe,abor->pkCe',Hbar['caaa'],c['aIv'],lambda2['aaaa'],optimize=True)
    sigma['cIa'] += -0.50000000 * np.einsum('koab,pC,abor->pkCr',Hbar['caaa'],c['I'],lambda2['aaaa'],optimize=True)
    sigma['cIa'] += -0.50000000 * np.einsum('koab,psCt,to,abrs->pkCr',Hbar['caaa'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('koab,psCt,ar,to,bs->pkCr',Hbar['caaa'],c['aIa'],eta1['aa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('koab,psCt,ar,btos->pkCr',Hbar['caaa'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['cIa'] += +0.50000000 * np.einsum('koab,psCt,tr,abos->pkCr',Hbar['caaa'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('koab,psCt,bs,ator->pkCr',Hbar['caaa'],c['aIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['cIa'] += +0.50000000 * np.einsum('koab,psCt,abtors->pkCr',Hbar['caaa'],c['aIa'],lambda3['aaaaaa'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('koab,pCOA,ar,bAoO->pkCr',Hbar['caaa'],c['IAA'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['cIa'] += -0.50000000 * np.einsum('koab,pCOA,abAorO->pkCr',Hbar['caaa'],c['IAA'],lambda3['aaAaaA'],optimize=True)
    sigma['iIa'] += +0.50000000 * np.einsum('eoab,pcCe,abor->pcCr',Hbar['vaaa'],c['iIv'],lambda2['aaaa'],optimize=True)
    sigma['iCa'] += +0.50000000 * np.einsum('eoab,pcKe,abor->pcKr',Hbar['vaaa'],c['iCv'],lambda2['aaaa'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('eoab,pcAe,ar,bOoA->pcOr',Hbar['vaaa'],c['iAv'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +0.50000000 * np.einsum('eoab,pcAe,OA,abor->pcOr',Hbar['vaaa'],c['iAv'],gamma1['AA'],lambda2['aaaa'],optimize=True)
    sigma['iAa'] += +0.50000000 * np.einsum('eoab,pcAe,abOorA->pcOr',Hbar['vaaa'],c['iAv'],lambda3['aaAaaA'],optimize=True)
    sigma['cIa'] += +0.50000000 * np.einsum('eoab,pkCe,abor->pkCr',Hbar['vaaa'],c['cIv'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('eoab,ptCe,ar,bt,so->psCr',Hbar['vaaa'],c['aIv'],eta1['aa'],gamma1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('eoab,ptCe,br,asot->psCr',Hbar['vaaa'],c['aIv'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('eoab,ptCe,so,abrt->psCr',Hbar['vaaa'],c['aIv'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('eoab,ptCe,bt,asor->psCr',Hbar['vaaa'],c['aIv'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('eoab,ptCe,st,abor->psCr',Hbar['vaaa'],c['aIv'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('eoab,ptCe,absort->psCr',Hbar['vaaa'],c['aIv'],lambda3['aaaaaa'],optimize=True)
    sigma['I'] += +0.50000000 * np.einsum('eoab,prCe,abor->pC',Hbar['vaaa'],c['aIv'],lambda2['aaaa'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('eoab,prCe,br,aAoO->pCAO',Hbar['vaaa'],c['aIv'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('eoab,prCe,abAorO->pCAO',Hbar['vaaa'],c['aIv'],lambda3['aaAaaA'],optimize=True)
    sigma['iIa'] += -0.50000000 * np.einsum('oabr,pcCt,ta,bros->pcCs',Hbar['aaaa'],c['iIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['iIa'] += +0.50000000 * np.einsum('oabr,pcCt,bs,rtoa->pcCs',Hbar['aaaa'],c['iIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['iIa'] += -0.25000000 * np.einsum('oabr,pcCt,brtoas->pcCs',Hbar['aaaa'],c['iIa'],lambda3['aaaaaa'],optimize=True)
    sigma['iCa'] += -0.50000000 * np.einsum('oabr,pcKt,ta,bros->pcKs',Hbar['aaaa'],c['iCa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['iCa'] += +0.50000000 * np.einsum('oabr,pcKt,bs,rtoa->pcKs',Hbar['aaaa'],c['iCa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['iCa'] += -0.25000000 * np.einsum('oabr,pcKt,brtoas->pcKs',Hbar['aaaa'],c['iCa'],lambda3['aaaaaa'],optimize=True)
    sigma['iAv'] += +0.25000000 * np.einsum('oabr,pcAe,brOoaA->pcOe',Hbar['aaaa'],c['iAv'],lambda3['aaAaaA'],optimize=True)
    sigma['iAa'] += -0.50000000 * np.einsum('oabr,pcAt,ta,OA,bros->pcOs',Hbar['aaaa'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aaaa'],optimize=True)
    sigma['iAa'] += -0.50000000 * np.einsum('oabr,pcAt,ta,brOosA->pcOs',Hbar['aaaa'],c['iAa'],eta1['aa'],lambda3['aaAaaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oabr,pcAt,bs,ta,rOoA->pcOs',Hbar['aaaa'],c['iAa'],eta1['aa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +0.50000000 * np.einsum('oabr,pcAt,bs,OA,rtoa->pcOs',Hbar['aaaa'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aaaa'],optimize=True)
    sigma['iAa'] += +0.50000000 * np.einsum('oabr,pcAt,bs,rtOoaA->pcOs',Hbar['aaaa'],c['iAa'],eta1['aa'],lambda3['aaAaaA'],optimize=True)
    sigma['iAa'] += +0.25000000 * np.einsum('oabr,pcAt,ts,brOoaA->pcOs',Hbar['aaaa'],c['iAa'],eta1['aa'],lambda3['aaAaaA'],optimize=True)
    sigma['iAa'] += -0.25000000 * np.einsum('oabr,pcAt,OA,brtoas->pcOs',Hbar['aaaa'],c['iAa'],gamma1['AA'],lambda3['aaaaaa'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oabr,pcAt,rOaA,btos->pcOs',Hbar['aaaa'],c['iAa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
    sigma['iAa'] += +0.50000000 * np.einsum('oabr,pcAt,tOaA,bros->pcOs',Hbar['aaaa'],c['iAa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
    sigma['iAa'] += +0.50000000 * np.einsum('oabr,pcAt,rOsA,btoa->pcOs',Hbar['aaaa'],c['iAa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
    sigma['iAa'] += -0.25000000 * np.einsum('oabr,pcAt,brtOoasA->pcOs',Hbar['aaaa'],c['iAa'],lambda4['aaaAaaaA'],optimize=True)
    sigma['cIa'] += -0.50000000 * np.einsum('oabr,pkCt,ta,bros->pkCs',Hbar['aaaa'],c['cIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['cIa'] += +0.50000000 * np.einsum('oabr,pkCt,bs,rtoa->pkCs',Hbar['aaaa'],c['cIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['cIa'] += -0.25000000 * np.einsum('oabr,pkCt,brtoas->pkCs',Hbar['aaaa'],c['cIa'],lambda3['aaaaaa'],optimize=True)
    sigma['aIv'] += +0.50000000 * np.einsum('oabr,ptCe,so,brat->psCe',Hbar['aaaa'],c['aIv'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIv'] += -0.50000000 * np.einsum('oabr,ptCe,rt,bsoa->psCe',Hbar['aaaa'],c['aIv'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIv'] += +0.25000000 * np.einsum('oabr,ptCe,brsoat->psCe',Hbar['aaaa'],c['aIv'],lambda3['aaaaaa'],optimize=True)
    sigma['aIa'] += -0.50000000 * np.einsum('oabr,pC,rs,btoa->ptCs',Hbar['aaaa'],c['I'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -0.50000000 * np.einsum('oabr,pC,to,bras->ptCs',Hbar['aaaa'],c['I'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -0.25000000 * np.einsum('oabr,pC,brtoas->ptCs',Hbar['aaaa'],c['I'],lambda3['aaaaaa'],optimize=True)
    sigma['aIa'] += -0.50000000 * np.einsum('oabr,puCv,va,to,brsu->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oabr,puCv,va,ru,btos->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -0.50000000 * np.einsum('oabr,puCv,va,tu,bros->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -0.50000000 * np.einsum('oabr,puCv,va,brtosu->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],lambda3['aaaaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oabr,puCv,bs,va,ru,to->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],eta1['aa'],gamma1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oabr,puCv,bs,to,rvau->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -0.50000000 * np.einsum('oabr,puCv,bs,ru,tvoa->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('oabr,puCv,bs,tu,rvoa->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oabr,puCv,rs,va,btou->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('oabr,puCv,rs,btvoau->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],lambda3['aaaaaa'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('oabr,puCv,vs,to,brau->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -0.50000000 * np.einsum('oabr,puCv,vs,ru,btoa->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +0.25000000 * np.einsum('oabr,puCv,vs,brtoau->ptCs',Hbar['aaaa'],c['aIa'],eta1['aa'],lambda3['aaaaaa'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('oabr,puCv,to,brvasu->ptCs',Hbar['aaaa'],c['aIa'],gamma1['aa'],lambda3['aaaaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oabr,puCv,ru,to,bvas->ptCs',Hbar['aaaa'],c['aIa'],gamma1['aa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('oabr,puCv,ru,btvoas->ptCs',Hbar['aaaa'],c['aIa'],gamma1['aa'],lambda3['aaaaaa'],optimize=True)
    sigma['aIa'] += -0.25000000 * np.einsum('oabr,puCv,tu,brvoas->ptCs',Hbar['aaaa'],c['aIa'],gamma1['aa'],lambda3['aaaaaa'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('oabr,puCv,brou,tvas->ptCs',Hbar['aaaa'],c['aIa'],lambda2['aaaa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oabr,puCv,btou,rvas->ptCs',Hbar['aaaa'],c['aIa'],lambda2['aaaa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oabr,puCv,rvau,btos->ptCs',Hbar['aaaa'],c['aIa'],lambda2['aaaa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -0.50000000 * np.einsum('oabr,puCv,tvau,bros->ptCs',Hbar['aaaa'],c['aIa'],lambda2['aaaa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +0.25000000 * np.einsum('oabr,puCv,brsu,tvoa->ptCs',Hbar['aaaa'],c['aIa'],lambda2['aaaa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('oabr,puCv,rtsu,bvoa->ptCs',Hbar['aaaa'],c['aIa'],lambda2['aaaa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -0.50000000 * np.einsum('oabr,puCv,rvsu,btoa->ptCs',Hbar['aaaa'],c['aIa'],lambda2['aaaa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +0.25000000 * np.einsum('oabr,puCv,brtvoasu->ptCs',Hbar['aaaa'],c['aIa'],lambda4['aaaaaaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oabr,pCOA,bs,to,rAaO->ptCs',Hbar['aaaa'],c['IAA'],eta1['aa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -0.50000000 * np.einsum('oabr,pCOA,rs,btAoaO->ptCs',Hbar['aaaa'],c['IAA'],eta1['aa'],lambda3['aaAaaA'],optimize=True)
    sigma['aIa'] += -0.50000000 * np.einsum('oabr,pCOA,to,brAasO->ptCs',Hbar['aaaa'],c['IAA'],gamma1['aa'],lambda3['aaAaaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oabr,pCOA,rAaO,btos->ptCs',Hbar['aaaa'],c['IAA'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('oabr,pCOA,tAaO,bros->ptCs',Hbar['aaaa'],c['IAA'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('oabr,pCOA,rAsO,btoa->ptCs',Hbar['aaaa'],c['IAA'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -0.25000000 * np.einsum('oabr,pCOA,brtAoasO->ptCs',Hbar['aaaa'],c['IAA'],lambda4['aaaAaaaA'],optimize=True)
    sigma['I'] += -0.50000000 * np.einsum('oabr,psCt,ta,bros->pC',Hbar['aaaa'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['I'] += +0.50000000 * np.einsum('oabr,psCt,rs,btoa->pC',Hbar['aaaa'],c['aIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['I'] += -0.25000000 * np.einsum('oabr,psCt,brtoas->pC',Hbar['aaaa'],c['aIa'],lambda3['aaaaaa'],optimize=True)
    sigma['I'] += +0.25000000 * np.einsum('oabr,pCOA,brAoaO->pC',Hbar['aaaa'],c['IAA'],lambda3['aaAaaA'],optimize=True)
    sigma['IIA'] += -0.12500000 * np.einsum('oabr,pCDA,brAoaO->pCDO',Hbar['aaaa'],c['IIA'],lambda3['aaAaaA'],optimize=True)
    sigma['ICA'] += -0.25000000 * np.einsum('oabr,pCKA,brAoaO->pCKO',Hbar['aaaa'],c['ICA'],lambda3['aaAaaA'],optimize=True)
    sigma['IAV'] += +0.25000000 * np.einsum('oabr,pCAE,brOoaA->pCOE',Hbar['aaaa'],c['IAV'],lambda3['aaAaaA'],optimize=True)
    sigma['IAA'] += +0.25000000 * np.einsum('oabr,pC,brAoaO->pCAO',Hbar['aaaa'],c['I'],lambda3['aaAaaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oabr,psCt,ta,rs,bAoO->pCAO',Hbar['aaaa'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -0.50000000 * np.einsum('oabr,psCt,ta,brAosO->pCAO',Hbar['aaaa'],c['aIa'],eta1['aa'],lambda3['aaAaaA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('oabr,psCt,rs,btAoaO->pCAO',Hbar['aaaa'],c['aIa'],gamma1['aa'],lambda3['aaAaaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oabr,psCt,bAoO,rtas->pCAO',Hbar['aaaa'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('oabr,psCt,tAaO,bros->pCAO',Hbar['aaaa'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('oabr,psCt,rAsO,btoa->pCAO',Hbar['aaaa'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
    sigma['IAA'] += -0.25000000 * np.einsum('oabr,psCt,brtAoasO->pCAO',Hbar['aaaa'],c['aIa'],lambda4['aaaAaaaA'],optimize=True)
    sigma['IAA'] += +0.25000000 * np.einsum('oabr,pCBR,RO,brAoaB->pCAO',Hbar['aaaa'],c['IAA'],eta1['AA'],lambda3['aaAaaA'],optimize=True)
    sigma['IAA'] += -0.25000000 * np.einsum('oabr,pCBR,AB,brRoaO->pCAO',Hbar['aaaa'],c['IAA'],gamma1['AA'],lambda3['aaAaaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oabr,pCBR,bAoB,rRaO->pCAO',Hbar['aaaa'],c['IAA'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oabr,pCBR,rRaB,bAoO->pCAO',Hbar['aaaa'],c['IAA'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +0.25000000 * np.einsum('oabr,pCBR,brARoaOB->pCAO',Hbar['aaaa'],c['IAA'],lambda4['aaAAaaAA'],optimize=True)
    sigma['iIv'] += +1.00000000 * np.einsum('cCoD,paDe,oa->pcCe',Hbar['iIaI'],c['aIv'],gamma1['aa'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('cCoD,pD,oa->pcCa',Hbar['iIaI'],c['I'],eta1['aa'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('cCoD,pbDr,ra,ob->pcCa',Hbar['iIaI'],c['aIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('cCoD,pbDr,orab->pcCa',Hbar['iIaI'],c['aIa'],lambda2['aaaa'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('cCoD,pDOA,oAaO->pcCa',Hbar['iIaI'],c['IAA'],lambda2['aAaA'],optimize=True)
    sigma['iCv'] += +1.00000000 * np.einsum('cKoC,paCe,oa->pcKe',Hbar['iCaI'],c['aIv'],gamma1['aa'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('cKoC,pC,oa->pcKa',Hbar['iCaI'],c['I'],eta1['aa'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('cKoC,pbCr,ra,ob->pcKa',Hbar['iCaI'],c['aIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('cKoC,pbCr,orab->pcKa',Hbar['iCaI'],c['aIa'],lambda2['aaaa'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('cKoC,pCOA,oAaO->pcKa',Hbar['iCaI'],c['IAA'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('cEoC,pCDE,oa->pcDa',Hbar['iVaI'],c['IIV'],eta1['aa'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('cEoC,pCKE,oa->pcKa',Hbar['iVaI'],c['ICV'],eta1['aa'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('cEoC,pCAE,oa,OA->pcOa',Hbar['iVaI'],c['IAV'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('cEoC,pCAE,oOaA->pcOa',Hbar['iVaI'],c['IAV'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('cOoC,pCDA,AO,oa->pcDa',Hbar['iAaI'],c['IIA'],eta1['AA'],eta1['aa'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('cOoC,pCDA,oAaO->pcDa',Hbar['iAaI'],c['IIA'],lambda2['aAaA'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('cOoC,pCKA,AO,oa->pcKa',Hbar['iAaI'],c['ICA'],eta1['AA'],eta1['aa'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('cOoC,pCKA,oAaO->pcKa',Hbar['iAaI'],c['ICA'],lambda2['aAaA'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('cOoC,paCe,AO,oa->pcAe',Hbar['iAaI'],c['aIv'],gamma1['AA'],gamma1['aa'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('cOoC,paCe,oAaO->pcAe',Hbar['iAaI'],c['aIv'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('cOoC,pC,oa,AO->pcAa',Hbar['iAaI'],c['I'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('cOoC,pC,oAaO->pcAa',Hbar['iAaI'],c['I'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('cOoC,pbCr,oa,rAbO->pcAa',Hbar['iAaI'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('cOoC,pbCr,ra,AO,ob->pcAa',Hbar['iAaI'],c['aIa'],eta1['aa'],gamma1['AA'],gamma1['aa'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('cOoC,pbCr,ra,oAbO->pcAa',Hbar['iAaI'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('cOoC,pbCr,ob,rAaO->pcAa',Hbar['iAaI'],c['aIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('cOoC,pbCr,AO,orab->pcAa',Hbar['iAaI'],c['aIa'],gamma1['AA'],lambda2['aaaa'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('cOoC,pbCr,orAabO->pcAa',Hbar['iAaI'],c['aIa'],lambda3['aaAaaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('cOoC,pCBR,oa,AROB->pcAa',Hbar['iAaI'],c['IAA'],eta1['aa'],lambda2['AAAA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('cOoC,pCBR,RO,oa,AB->pcAa',Hbar['iAaI'],c['IAA'],eta1['AA'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('cOoC,pCBR,RO,oAaB->pcAa',Hbar['iAaI'],c['IAA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('cOoC,pCBR,AO,oRaB->pcAa',Hbar['iAaI'],c['IAA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('cOoC,pCBR,AB,oRaO->pcAa',Hbar['iAaI'],c['IAA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('cOoC,pCBR,oARaOB->pcAa',Hbar['iAaI'],c['IAA'],lambda3['aAAaAA'],optimize=True)
    sigma['cIv'] += +1.00000000 * np.einsum('kCoD,paDe,oa->pkCe',Hbar['cIaI'],c['aIv'],gamma1['aa'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kCoD,pD,oa->pkCa',Hbar['cIaI'],c['I'],eta1['aa'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kCoD,pbDr,ra,ob->pkCa',Hbar['cIaI'],c['aIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kCoD,pbDr,orab->pkCa',Hbar['cIaI'],c['aIa'],lambda2['aaaa'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('kCoD,pDOA,oAaO->pkCa',Hbar['cIaI'],c['IAA'],lambda2['aAaA'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kEoC,pCDE,oa->pkDa',Hbar['cVaI'],c['IIV'],eta1['aa'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kOoC,pCDA,AO,oa->pkDa',Hbar['cAaI'],c['IIA'],eta1['AA'],eta1['aa'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kOoC,pCDA,oAaO->pkDa',Hbar['cAaI'],c['IIA'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('eCoD,pcDe,oa->pcCa',Hbar['vIaI'],c['iIv'],eta1['aa'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('eCoD,pkDe,oa->pkCa',Hbar['vIaI'],c['cIv'],eta1['aa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('eCoD,prDe,oa,br->pbCa',Hbar['vIaI'],c['aIv'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('eCoD,prDe,obar->pbCa',Hbar['vIaI'],c['aIv'],lambda2['aaaa'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('eCoD,paDe,oa->pC',Hbar['vIaI'],c['aIv'],gamma1['aa'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('eCoD,paDe,oAaO->pCAO',Hbar['vIaI'],c['aIv'],lambda2['aAaA'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('eKoC,pcCe,oa->pcKa',Hbar['vCaI'],c['iIv'],eta1['aa'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('eOoC,pcCe,oa,AO->pcAa',Hbar['vAaI'],c['iIv'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('eOoC,pcCe,oAaO->pcAa',Hbar['vAaI'],c['iIv'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('oCaD,pcDr,ab,ro->pcCb',Hbar['aIaI'],c['iIa'],eta1['aa'],eta1['aa'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('oCaD,pcDr,arob->pcCb',Hbar['aIaI'],c['iIa'],lambda2['aaaa'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('oCaD,pkDr,ab,ro->pkCb',Hbar['aIaI'],c['cIa'],eta1['aa'],eta1['aa'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('oCaD,pkDr,arob->pkCb',Hbar['aIaI'],c['cIa'],lambda2['aaaa'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oCaD,prDe,ar,bo->pbCe',Hbar['aIaI'],c['aIv'],gamma1['aa'],gamma1['aa'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oCaD,prDe,abor->pbCe',Hbar['aIaI'],c['aIv'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oCaD,pD,ab,ro->prCb',Hbar['aIaI'],c['I'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oCaD,pD,arob->prCb',Hbar['aIaI'],c['I'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oCaD,psDt,to,arbs->prCb',Hbar['aIaI'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oCaD,psDt,ab,to,rs->prCb',Hbar['aIaI'],c['aIa'],eta1['aa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oCaD,psDt,ab,rtos->prCb',Hbar['aIaI'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oCaD,psDt,tb,as,ro->prCb',Hbar['aIaI'],c['aIa'],eta1['aa'],gamma1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oCaD,psDt,tb,aros->prCb',Hbar['aIaI'],c['aIa'],eta1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oCaD,psDt,ro,atbs->prCb',Hbar['aIaI'],c['aIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oCaD,psDt,as,rtob->prCb',Hbar['aIaI'],c['aIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oCaD,psDt,rs,atob->prCb',Hbar['aIaI'],c['aIa'],gamma1['aa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oCaD,psDt,artobs->prCb',Hbar['aIaI'],c['aIa'],lambda3['aaaaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oCaD,pDOA,ab,rAoO->prCb',Hbar['aIaI'],c['IAA'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oCaD,pDOA,ro,aAbO->prCb',Hbar['aIaI'],c['IAA'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oCaD,pDOA,arAobO->prCb',Hbar['aIaI'],c['IAA'],lambda3['aaAaaA'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('oCaD,pbDr,ro,ab->pC',Hbar['aIaI'],c['aIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('oCaD,pbDr,arob->pC',Hbar['aIaI'],c['aIa'],lambda2['aaaa'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('oCaD,pDOA,aAoO->pC',Hbar['aIaI'],c['IAA'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('oCaD,pDIA,aAoO->pCIO',Hbar['aIaI'],c['IIA'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('oCaD,pDKA,aAoO->pCKO',Hbar['aIaI'],c['ICA'],lambda2['aAaA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('oCaD,pDAE,aOoA->pCOE',Hbar['aIaI'],c['IAV'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oCaD,pD,aAoO->pCAO',Hbar['aIaI'],c['I'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oCaD,pbDr,ro,aAbO->pCAO',Hbar['aIaI'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oCaD,pbDr,ab,rAoO->pCAO',Hbar['aIaI'],c['aIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oCaD,pbDr,arAobO->pCAO',Hbar['aIaI'],c['aIa'],lambda3['aaAaaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oCaD,pDBR,RO,aAoB->pCAO',Hbar['aIaI'],c['IAA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oCaD,pDBR,AB,aRoO->pCAO',Hbar['aIaI'],c['IAA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oCaD,pDBR,aARoOB->pCAO',Hbar['aIaI'],c['IAA'],lambda3['aAAaAA'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('oKaC,pcCr,ab,ro->pcKb',Hbar['aCaI'],c['iIa'],eta1['aa'],eta1['aa'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('oKaC,pcCr,arob->pcKb',Hbar['aCaI'],c['iIa'],lambda2['aaaa'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('oKaC,pCDA,aAoO->pDKO',Hbar['aCaI'],c['IIA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oEaC,pCDE,ab,ro->prDb',Hbar['aVaI'],c['IIV'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oEaC,pCDE,arob->prDb',Hbar['aVaI'],c['IIV'],lambda2['aaaa'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oEaC,pCDE,aAoO->pDAO',Hbar['aVaI'],c['IIV'],lambda2['aAaA'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('oOaC,pcCe,aAoO->pcAe',Hbar['aAaI'],c['iIv'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaC,pcCr,ro,aAbO->pcAb',Hbar['aAaI'],c['iIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oOaC,pcCr,ab,ro,AO->pcAb',Hbar['aAaI'],c['iIa'],eta1['aa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaC,pcCr,ab,rAoO->pcAb',Hbar['aAaI'],c['iIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oOaC,pcCr,rb,aAoO->pcAb',Hbar['aAaI'],c['iIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaC,pcCr,AO,arob->pcAb',Hbar['aAaI'],c['iIa'],gamma1['AA'],lambda2['aaaa'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaC,pcCr,arAobO->pcAb',Hbar['aAaI'],c['iIa'],lambda3['aaAaaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaC,pCDA,ab,rAoO->prDb',Hbar['aAaI'],c['IIA'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaC,pCDA,AO,ab,ro->prDb',Hbar['aAaI'],c['IIA'],eta1['AA'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaC,pCDA,AO,arob->prDb',Hbar['aAaI'],c['IIA'],eta1['AA'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaC,pCDA,ro,aAbO->prDb',Hbar['aAaI'],c['IIA'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaC,pCDA,arAobO->prDb',Hbar['aAaI'],c['IIA'],lambda3['aaAaaA'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('oOaC,pCDA,aAoO->pD',Hbar['aAaI'],c['IIA'],lambda2['aAaA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('oOaC,pCDE,aAoO->pDAE',Hbar['aAaI'],c['IIV'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaC,pCDR,RO,aBoA->pDBA',Hbar['aAaI'],c['IIA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaC,pCDR,RA,aBoO->pDBA',Hbar['aAaI'],c['IIA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaC,pCDR,BO,aRoA->pDBA',Hbar['aAaI'],c['IIA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaC,pCDR,aBRoOA->pDBA',Hbar['aAaI'],c['IIA'],lambda3['aAAaAA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('cEoK,pCKE,oa->pcCa',Hbar['iVaC'],c['ICV'],eta1['aa'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('cOoK,pCKA,AO,oa->pcCa',Hbar['iAaC'],c['ICA'],eta1['AA'],eta1['aa'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('cOoK,pCKA,oAaO->pcCa',Hbar['iAaC'],c['ICA'],lambda2['aAaA'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('kEoK,pCKE,oa->pkCa',Hbar['cVaC'],c['ICV'],eta1['aa'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('kOoK,pCKA,AO,oa->pkCa',Hbar['cAaC'],c['ICA'],eta1['AA'],eta1['aa'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('kOoK,pCKA,oAaO->pkCa',Hbar['cAaC'],c['ICA'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('eCoK,pcKe,oa->pcCa',Hbar['vIaC'],c['iCv'],eta1['aa'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('eKoL,pcLe,oa->pcKa',Hbar['vCaC'],c['iCv'],eta1['aa'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('eOoK,pcKe,oa,AO->pcAa',Hbar['vAaC'],c['iCv'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('eOoK,pcKe,oAaO->pcAa',Hbar['vAaC'],c['iCv'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('oCaK,pcKr,ab,ro->pcCb',Hbar['aIaC'],c['iCa'],eta1['aa'],eta1['aa'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('oCaK,pcKr,arob->pcCb',Hbar['aIaC'],c['iCa'],lambda2['aaaa'],optimize=True)
    sigma['IIA'] += -1.00000000 * np.einsum('oCaK,pDKA,aAoO->pCDO',Hbar['aIaC'],c['ICA'],lambda2['aAaA'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('oKaL,pcLr,ab,ro->pcKb',Hbar['aCaC'],c['iCa'],eta1['aa'],eta1['aa'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('oKaL,pcLr,arob->pcKb',Hbar['aCaC'],c['iCa'],lambda2['aaaa'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('oKaL,pCLA,aAoO->pCKO',Hbar['aCaC'],c['ICA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oEaK,pCKE,ab,ro->prCb',Hbar['aVaC'],c['ICV'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oEaK,pCKE,arob->prCb',Hbar['aVaC'],c['ICV'],lambda2['aaaa'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oEaK,pCKE,aAoO->pCAO',Hbar['aVaC'],c['ICV'],lambda2['aAaA'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('oOaK,pcKe,aAoO->pcAe',Hbar['aAaC'],c['iCv'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaK,pcKr,ro,aAbO->pcAb',Hbar['aAaC'],c['iCa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oOaK,pcKr,ab,ro,AO->pcAb',Hbar['aAaC'],c['iCa'],eta1['aa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaK,pcKr,ab,rAoO->pcAb',Hbar['aAaC'],c['iCa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oOaK,pcKr,rb,aAoO->pcAb',Hbar['aAaC'],c['iCa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaK,pcKr,AO,arob->pcAb',Hbar['aAaC'],c['iCa'],gamma1['AA'],lambda2['aaaa'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaK,pcKr,arAobO->pcAb',Hbar['aAaC'],c['iCa'],lambda3['aaAaaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaK,pCKA,ab,rAoO->prCb',Hbar['aAaC'],c['ICA'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaK,pCKA,AO,ab,ro->prCb',Hbar['aAaC'],c['ICA'],eta1['AA'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaK,pCKA,AO,arob->prCb',Hbar['aAaC'],c['ICA'],eta1['AA'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaK,pCKA,ro,aAbO->prCb',Hbar['aAaC'],c['ICA'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaK,pCKA,arAobO->prCb',Hbar['aAaC'],c['ICA'],lambda3['aaAaaA'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('oOaK,pCKA,aAoO->pC',Hbar['aAaC'],c['ICA'],lambda2['aAaA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('oOaK,pCKE,aAoO->pCAE',Hbar['aAaC'],c['ICV'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaK,pCKR,RO,aBoA->pCBA',Hbar['aAaC'],c['ICA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaK,pCKR,RA,aBoO->pCBA',Hbar['aAaC'],c['ICA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaK,pCKR,BO,aRoA->pCBA',Hbar['aAaC'],c['ICA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaK,pCKR,aBRoOA->pCBA',Hbar['aAaC'],c['ICA'],lambda3['aAAaAA'],optimize=True)
    sigma['IIV'] += +1.00000000 * np.einsum('eCoE,paDe,oa->pCDE',Hbar['vIaV'],c['aIv'],gamma1['aa'],optimize=True)
    sigma['ICV'] += -1.00000000 * np.einsum('eKoE,paCe,oa->pCKE',Hbar['vCaV'],c['aIv'],gamma1['aa'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('eOoE,paCe,AO,oa->pCAE',Hbar['vAaV'],c['aIv'],gamma1['AA'],gamma1['aa'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('eOoE,paCe,oAaO->pCAE',Hbar['vAaV'],c['aIv'],lambda2['aAaA'],optimize=True)
    sigma['IIV'] += +1.00000000 * np.einsum('oCaE,pbDr,ro,ab->pCDE',Hbar['aIaV'],c['aIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['IIV'] += +1.00000000 * np.einsum('oCaE,pbDr,arob->pCDE',Hbar['aIaV'],c['aIa'],lambda2['aaaa'],optimize=True)
    sigma['IIV'] += -1.00000000 * np.einsum('oCaE,pDOA,aAoO->pCDE',Hbar['aIaV'],c['IAA'],lambda2['aAaA'],optimize=True)
    sigma['ICV'] += -1.00000000 * np.einsum('oKaE,pbCr,ro,ab->pCKE',Hbar['aCaV'],c['aIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['ICV'] += -1.00000000 * np.einsum('oKaE,pbCr,arob->pCKE',Hbar['aCaV'],c['aIa'],lambda2['aaaa'],optimize=True)
    sigma['ICV'] += +1.00000000 * np.einsum('oKaE,pCOA,aAoO->pCKE',Hbar['aCaV'],c['IAA'],lambda2['aAaA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('oEaF,pCAE,aOoA->pCOF',Hbar['aVaV'],c['IAV'],lambda2['aAaA'],optimize=True)
    sigma['IIV'] += -0.50000000 * np.einsum('oOaE,pCDA,aAoO->pCDE',Hbar['aAaV'],c['IIA'],lambda2['aAaA'],optimize=True)
    sigma['ICV'] += -1.00000000 * np.einsum('oOaE,pCKA,aAoO->pCKE',Hbar['aAaV'],c['ICA'],lambda2['aAaA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('oOaE,pC,aAoO->pCAE',Hbar['aAaV'],c['I'],lambda2['aAaA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('oOaE,pbCr,ro,AO,ab->pCAE',Hbar['aAaV'],c['aIa'],eta1['aa'],gamma1['AA'],gamma1['aa'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('oOaE,pbCr,ro,aAbO->pCAE',Hbar['aAaV'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('oOaE,pbCr,ab,rAoO->pCAE',Hbar['aAaV'],c['aIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('oOaE,pbCr,AO,arob->pCAE',Hbar['aAaV'],c['aIa'],gamma1['AA'],lambda2['aaaa'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('oOaE,pbCr,arAobO->pCAE',Hbar['aAaV'],c['aIa'],lambda3['aaAaaA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('oOaE,pCBR,RO,aAoB->pCAE',Hbar['aAaV'],c['IAA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('oOaE,pCBR,AO,aRoB->pCAE',Hbar['aAaV'],c['IAA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('oOaE,pCBR,AB,aRoO->pCAE',Hbar['aAaV'],c['IAA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('oOaE,pCBR,aARoOB->pCAE',Hbar['aAaV'],c['IAA'],lambda3['aAAaAA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('cEoO,pCAE,oa,OA->pcCa',Hbar['iVaA'],c['IAV'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('cEoO,pCAE,oOaA->pcCa',Hbar['iVaA'],c['IAV'],lambda2['aAaA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('cOoA,paCe,oAaO->pcCe',Hbar['iAaA'],c['aIv'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('cOoA,pC,oAaO->pcCa',Hbar['iAaA'],c['I'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('cOoA,pbCr,oa,rAbO->pcCa',Hbar['iAaA'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('cOoA,pbCr,ra,oAbO->pcCa',Hbar['iAaA'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('cOoA,pbCr,ob,rAaO->pcCa',Hbar['iAaA'],c['aIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('cOoA,pbCr,orAabO->pcCa',Hbar['iAaA'],c['aIa'],lambda3['aaAaaA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('cOoA,pCBR,oa,AROB->pcCa',Hbar['iAaA'],c['IAA'],eta1['aa'],lambda2['AAAA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('cOoA,pCBR,RO,oa,AB->pcCa',Hbar['iAaA'],c['IAA'],eta1['AA'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('cOoA,pCBR,RO,oAaB->pcCa',Hbar['iAaA'],c['IAA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('cOoA,pCBR,AB,oRaO->pcCa',Hbar['iAaA'],c['IAA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('cOoA,pCBR,oARaOB->pcCa',Hbar['iAaA'],c['IAA'],lambda3['aAAaAA'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('kEoO,pCAE,oa,OA->pkCa',Hbar['cVaA'],c['IAV'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kEoO,pCAE,oOaA->pkCa',Hbar['cVaA'],c['IAV'],lambda2['aAaA'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('kOoA,paCe,oAaO->pkCe',Hbar['cAaA'],c['aIv'],lambda2['aAaA'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kOoA,pC,oAaO->pkCa',Hbar['cAaA'],c['I'],lambda2['aAaA'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kOoA,pbCr,oa,rAbO->pkCa',Hbar['cAaA'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('kOoA,pbCr,ra,oAbO->pkCa',Hbar['cAaA'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kOoA,pbCr,ob,rAaO->pkCa',Hbar['cAaA'],c['aIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('kOoA,pbCr,orAabO->pkCa',Hbar['cAaA'],c['aIa'],lambda3['aaAaaA'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('kOoA,pCBR,oa,AROB->pkCa',Hbar['cAaA'],c['IAA'],eta1['aa'],lambda2['AAAA'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('kOoA,pCBR,RO,oa,AB->pkCa',Hbar['cAaA'],c['IAA'],eta1['AA'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kOoA,pCBR,RO,oAaB->pkCa',Hbar['cAaA'],c['IAA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('kOoA,pCBR,AB,oRaO->pkCa',Hbar['cAaA'],c['IAA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('kOoA,pCBR,oARaOB->pkCa',Hbar['cAaA'],c['IAA'],lambda3['aAAaAA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('eCoO,pcAe,oa,OA->pcCa',Hbar['vIaA'],c['iAv'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('eCoO,pcAe,oOaA->pcCa',Hbar['vIaA'],c['iAv'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('eCoO,paDe,OA,oa->pCDA',Hbar['vIaA'],c['aIv'],eta1['AA'],gamma1['aa'],optimize=True)
    sigma['IIA'] += -1.00000000 * np.einsum('eCoO,paDe,oOaA->pCDA',Hbar['vIaA'],c['aIv'],lambda2['aAaA'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('eKoO,pcAe,oa,OA->pcKa',Hbar['vCaA'],c['iAv'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('eKoO,pcAe,oOaA->pcKa',Hbar['vCaA'],c['iAv'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('eKoO,paCe,OA,oa->pCKA',Hbar['vCaA'],c['aIv'],eta1['AA'],gamma1['aa'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('eKoO,paCe,oOaA->pCKA',Hbar['vCaA'],c['aIv'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('eOoA,pcCe,oAaO->pcCa',Hbar['vAaA'],c['iIv'],lambda2['aAaA'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('eOoA,pcKe,oAaO->pcKa',Hbar['vAaA'],c['iCv'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('eOoA,pcRe,oa,AR,BO->pcBa',Hbar['vAaA'],c['iAv'],eta1['aa'],gamma1['AA'],gamma1['AA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('eOoA,pcRe,oa,ABOR->pcBa',Hbar['vAaA'],c['iAv'],eta1['aa'],lambda2['AAAA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('eOoA,pcRe,BO,oAaR->pcBa',Hbar['vAaA'],c['iAv'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('eOoA,pcRe,AR,oBaO->pcBa',Hbar['vAaA'],c['iAv'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('eOoA,pcRe,BR,oAaO->pcBa',Hbar['vAaA'],c['iAv'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('eOoA,pcRe,oABaOR->pcBa',Hbar['vAaA'],c['iAv'],lambda3['aAAaAA'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('eOoA,pkCe,oAaO->pkCa',Hbar['vAaA'],c['cIv'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('eOoA,prCe,oa,bArO->pbCa',Hbar['vAaA'],c['aIv'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('eOoA,prCe,or,bAaO->pbCa',Hbar['vAaA'],c['aIv'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('eOoA,prCe,br,oAaO->pbCa',Hbar['vAaA'],c['aIv'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('eOoA,prCe,obAarO->pbCa',Hbar['vAaA'],c['aIv'],lambda3['aaAaaA'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('eOoA,paCe,oAaO->pC',Hbar['vAaA'],c['aIv'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('eOoA,paCe,AB,RO,oa->pCRB',Hbar['vAaA'],c['aIv'],eta1['AA'],gamma1['AA'],gamma1['aa'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('eOoA,paCe,AB,oRaO->pCRB',Hbar['vAaA'],c['aIv'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('eOoA,paCe,oa,AROB->pCRB',Hbar['vAaA'],c['aIv'],gamma1['aa'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('eOoA,paCe,RO,oAaB->pCRB',Hbar['vAaA'],c['aIv'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('eOoA,paCe,oARaOB->pCRB',Hbar['vAaA'],c['aIv'],lambda3['aAAaAA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('oCaO,pcAe,aOoA->pcCe',Hbar['aIaA'],c['iAv'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('oCaO,pcAr,ro,aObA->pcCb',Hbar['aIaA'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('oCaO,pcAr,ab,ro,OA->pcCb',Hbar['aIaA'],c['iAa'],eta1['aa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('oCaO,pcAr,ab,rOoA->pcCb',Hbar['aIaA'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('oCaO,pcAr,rb,aOoA->pcCb',Hbar['aIaA'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('oCaO,pcAr,OA,arob->pcCb',Hbar['aIaA'],c['iAa'],gamma1['AA'],lambda2['aaaa'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('oCaO,pcAr,arOobA->pcCb',Hbar['aIaA'],c['iAa'],lambda3['aaAaaA'],optimize=True)
    sigma['IIV'] += +1.00000000 * np.einsum('oCaO,pDAE,aOoA->pCDE',Hbar['aIaA'],c['IAV'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('oCaO,pD,aOoA->pCDA',Hbar['aIaA'],c['I'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += -1.00000000 * np.einsum('oCaO,pbDr,ro,aObA->pCDA',Hbar['aIaA'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('oCaO,pbDr,OA,ro,ab->pCDA',Hbar['aIaA'],c['aIa'],eta1['AA'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('oCaO,pbDr,OA,arob->pCDA',Hbar['aIaA'],c['aIa'],eta1['AA'],lambda2['aaaa'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('oCaO,pbDr,ab,rOoA->pCDA',Hbar['aIaA'],c['aIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += -1.00000000 * np.einsum('oCaO,pbDr,arOobA->pCDA',Hbar['aIaA'],c['aIa'],lambda3['aaAaaA'],optimize=True)
    sigma['IIA'] += -1.00000000 * np.einsum('oCaO,pDBR,OA,aRoB->pCDA',Hbar['aIaA'],c['IAA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('oCaO,pDBR,RA,aOoB->pCDA',Hbar['aIaA'],c['IAA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += -1.00000000 * np.einsum('oCaO,pDBR,OB,aRoA->pCDA',Hbar['aIaA'],c['IAA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('oCaO,pDBR,aORoAB->pCDA',Hbar['aIaA'],c['IAA'],lambda3['aAAaAA'],optimize=True)
    sigma['iCv'] += -1.00000000 * np.einsum('oKaO,pcAe,aOoA->pcKe',Hbar['aCaA'],c['iAv'],lambda2['aAaA'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('oKaO,pcAr,ro,aObA->pcKb',Hbar['aCaA'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('oKaO,pcAr,ab,ro,OA->pcKb',Hbar['aCaA'],c['iAa'],eta1['aa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('oKaO,pcAr,ab,rOoA->pcKb',Hbar['aCaA'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('oKaO,pcAr,rb,aOoA->pcKb',Hbar['aCaA'],c['iAa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('oKaO,pcAr,OA,arob->pcKb',Hbar['aCaA'],c['iAa'],gamma1['AA'],lambda2['aaaa'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('oKaO,pcAr,arOobA->pcKb',Hbar['aCaA'],c['iAa'],lambda3['aaAaaA'],optimize=True)
    sigma['ICV'] += -1.00000000 * np.einsum('oKaO,pCAE,aOoA->pCKE',Hbar['aCaA'],c['IAV'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('oKaO,pC,aOoA->pCKA',Hbar['aCaA'],c['I'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('oKaO,pbCr,ro,aObA->pCKA',Hbar['aCaA'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('oKaO,pbCr,OA,ro,ab->pCKA',Hbar['aCaA'],c['aIa'],eta1['AA'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('oKaO,pbCr,OA,arob->pCKA',Hbar['aCaA'],c['aIa'],eta1['AA'],lambda2['aaaa'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('oKaO,pbCr,ab,rOoA->pCKA',Hbar['aCaA'],c['aIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('oKaO,pbCr,arOobA->pCKA',Hbar['aCaA'],c['aIa'],lambda3['aaAaaA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('oKaO,pCBR,OA,aRoB->pCKA',Hbar['aCaA'],c['IAA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('oKaO,pCBR,RA,aOoB->pCKA',Hbar['aCaA'],c['IAA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('oKaO,pCBR,OB,aRoA->pCKA',Hbar['aCaA'],c['IAA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('oKaO,pCBR,aORoAB->pCKA',Hbar['aCaA'],c['IAA'],lambda3['aAAaAA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oEaO,pCAE,ab,OA,ro->prCb',Hbar['aVaA'],c['IAV'],eta1['aa'],gamma1['AA'],gamma1['aa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oEaO,pCAE,ab,rOoA->prCb',Hbar['aVaA'],c['IAV'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oEaO,pCAE,ro,aObA->prCb',Hbar['aVaA'],c['IAV'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oEaO,pCAE,OA,arob->prCb',Hbar['aVaA'],c['IAV'],gamma1['AA'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oEaO,pCAE,arOobA->prCb',Hbar['aVaA'],c['IAV'],lambda3['aaAaaA'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('oEaO,pCAE,aOoA->pC',Hbar['aVaA'],c['IAV'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += -0.50000000 * np.einsum('oEaO,pCDE,aOoA->pCDA',Hbar['aVaA'],c['IIV'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('oEaO,pCKE,aOoA->pCKA',Hbar['aVaA'],c['ICV'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oEaO,pCRE,OA,aBoR->pCBA',Hbar['aVaA'],c['IAV'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oEaO,pCRE,OR,aBoA->pCBA',Hbar['aVaA'],c['IAV'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oEaO,pCRE,BR,aOoA->pCBA',Hbar['aVaA'],c['IAV'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oEaO,pCRE,aOBoAR->pCBA',Hbar['aVaA'],c['IAV'],lambda3['aAAaAA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('oOaA,pcCr,ro,aAbO->pcCb',Hbar['aAaA'],c['iIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('oOaA,pcCr,ab,rAoO->pcCb',Hbar['aAaA'],c['iIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('oOaA,pcCr,arAobO->pcCb',Hbar['aAaA'],c['iIa'],lambda3['aaAaaA'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('oOaA,pcKr,ro,aAbO->pcKb',Hbar['aAaA'],c['iCa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('oOaA,pcKr,ab,rAoO->pcKb',Hbar['aAaA'],c['iCa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('oOaA,pcKr,arAobO->pcKb',Hbar['aAaA'],c['iCa'],lambda3['aaAaaA'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('oOaA,pcRe,BO,aAoR->pcBe',Hbar['aAaA'],c['iAv'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('oOaA,pcRe,AR,aBoO->pcBe',Hbar['aAaA'],c['iAv'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('oOaA,pcRe,aABoOR->pcBe',Hbar['aAaA'],c['iAv'],lambda3['aAAaAA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,ro,BO,aAbR->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,ro,AR,aBbO->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,ro,BR,aAbO->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,ro,aABbOR->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],lambda3['aAAaAA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,ab,ro,AR,BO->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],eta1['aa'],gamma1['AA'],gamma1['AA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,ab,ro,ABOR->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],eta1['aa'],lambda2['AAAA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,ab,BO,rAoR->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,ab,AR,rBoO->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,ab,BR,rAoO->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,ab,rABoOR->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],lambda3['aAAaAA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,rb,BO,aAoR->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,rb,AR,aBoO->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,rb,aABoOR->pcBb',Hbar['aAaA'],c['iAa'],eta1['aa'],lambda3['aAAaAA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,BO,arAobR->pcBb',Hbar['aAaA'],c['iAa'],gamma1['AA'],lambda3['aaAaaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,AR,BO,arob->pcBb',Hbar['aAaA'],c['iAa'],gamma1['AA'],gamma1['AA'],lambda2['aaaa'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,AR,arBobO->pcBb',Hbar['aAaA'],c['iAa'],gamma1['AA'],lambda3['aaAaaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,BR,arAobO->pcBb',Hbar['aAaA'],c['iAa'],gamma1['AA'],lambda3['aaAaaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,aAbO,rBoR->pcBb',Hbar['aAaA'],c['iAa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,aBbO,rAoR->pcBb',Hbar['aAaA'],c['iAa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,rAbO,aBoR->pcBb',Hbar['aAaA'],c['iAa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,rBbO,aAoR->pcBb',Hbar['aAaA'],c['iAa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,aAbR,rBoO->pcBb',Hbar['aAaA'],c['iAa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,aBbR,rAoO->pcBb',Hbar['aAaA'],c['iAa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('oOaA,pcRr,rAbR,aBoO->pcBb',Hbar['aAaA'],c['iAa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,ABOR,arob->pcBb',Hbar['aAaA'],c['iAa'],lambda2['AAAA'],lambda2['aaaa'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('oOaA,pcRr,arABobOR->pcBb',Hbar['aAaA'],c['iAa'],lambda4['aaAAaaAA'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('oOaA,pkCr,ro,aAbO->pkCb',Hbar['aAaA'],c['cIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('oOaA,pkCr,ab,rAoO->pkCb',Hbar['aAaA'],c['cIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('oOaA,pkCr,arAobO->pkCb',Hbar['aAaA'],c['cIa'],lambda3['aaAaaA'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oOaA,prCe,bo,aArO->pbCe',Hbar['aAaA'],c['aIv'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('oOaA,prCe,ar,bAoO->pbCe',Hbar['aAaA'],c['aIv'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('oOaA,prCe,abAorO->pbCe',Hbar['aAaA'],c['aIv'],lambda3['aaAaaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pC,ab,rAoO->prCb',Hbar['aAaA'],c['I'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,pC,ro,aAbO->prCb',Hbar['aAaA'],c['I'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pC,arAobO->prCb',Hbar['aAaA'],c['I'],lambda3['aaAaaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,to,as,rAbO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,to,rs,aAbO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,to,arAbsO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],lambda3['aaAaaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,ab,to,rAsO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,ab,ro,tAsO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,ab,rs,tAoO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,ab,rtAosO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],lambda3['aaAaaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,tb,ro,aAsO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,tb,as,rAoO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,tb,arAosO->prCb',Hbar['aAaA'],c['aIa'],eta1['aa'],lambda3['aaAaaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,ro,atAbsO->prCb',Hbar['aAaA'],c['aIa'],gamma1['aa'],lambda3['aaAaaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,as,ro,tAbO->prCb',Hbar['aAaA'],c['aIa'],gamma1['aa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,as,rtAobO->prCb',Hbar['aAaA'],c['aIa'],gamma1['aa'],lambda3['aaAaaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,rs,atAobO->prCb',Hbar['aAaA'],c['aIa'],gamma1['aa'],lambda3['aaAaaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,rAoO,atbs->prCb',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,tAoO,arbs->prCb',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,aAbO,rtos->prCb',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,rAbO,atos->prCb',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,tAbO,aros->prCb',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,aAsO,rtob->prCb',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,psCt,rAsO,atob->prCb',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,tAsO,arob->prCb',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,psCt,artAobsO->prCb',Hbar['aAaA'],c['aIa'],lambda4['aaaAaaaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,ab,ro,AROB->prCb',Hbar['aAaA'],c['IAA'],eta1['aa'],gamma1['aa'],lambda2['AAAA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,pCBR,ab,AB,rRoO->prCb',Hbar['aAaA'],c['IAA'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,ab,rARoOB->prCb',Hbar['aAaA'],c['IAA'],eta1['aa'],lambda3['aAAaAA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,RO,ab,AB,ro->prCb',Hbar['aAaA'],c['IAA'],eta1['AA'],eta1['aa'],gamma1['AA'],gamma1['aa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,RO,ab,rAoB->prCb',Hbar['aAaA'],c['IAA'],eta1['AA'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,pCBR,RO,ro,aAbB->prCb',Hbar['aAaA'],c['IAA'],eta1['AA'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,RO,AB,arob->prCb',Hbar['aAaA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,RO,arAobB->prCb',Hbar['aAaA'],c['IAA'],eta1['AA'],lambda3['aaAaaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,pCBR,ro,aARbOB->prCb',Hbar['aAaA'],c['IAA'],gamma1['aa'],lambda3['aAAaAA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,AB,ro,aRbO->prCb',Hbar['aAaA'],c['IAA'],gamma1['AA'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,pCBR,AB,arRobO->prCb',Hbar['aAaA'],c['IAA'],gamma1['AA'],lambda3['aaAaaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,pCBR,aAbO,rRoB->prCb',Hbar['aAaA'],c['IAA'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,aRbO,rAoB->prCb',Hbar['aAaA'],c['IAA'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,rAbO,aRoB->prCb',Hbar['aAaA'],c['IAA'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,pCBR,rRbO,aAoB->prCb',Hbar['aAaA'],c['IAA'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,aAbB,rRoO->prCb',Hbar['aAaA'],c['IAA'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,pCBR,aRbB,rAoO->prCb',Hbar['aAaA'],c['IAA'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('oOaA,pCBR,rAbB,aRoO->prCb',Hbar['aAaA'],c['IAA'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,AROB,arob->prCb',Hbar['aAaA'],c['IAA'],lambda2['AAAA'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('oOaA,pCBR,arARobOB->prCb',Hbar['aAaA'],c['IAA'],lambda4['aaAAaaAA'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('oOaA,pbCr,ro,aAbO->pC',Hbar['aAaA'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('oOaA,pbCr,ab,rAoO->pC',Hbar['aAaA'],c['aIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('oOaA,pbCr,arAobO->pC',Hbar['aAaA'],c['aIa'],lambda3['aaAaaA'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('oOaA,pCBR,RO,aAoB->pC',Hbar['aAaA'],c['IAA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('oOaA,pCBR,AB,aRoO->pC',Hbar['aAaA'],c['IAA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('oOaA,pCBR,aARoOB->pC',Hbar['aAaA'],c['IAA'],lambda3['aAAaAA'],optimize=True)
    sigma['IIA'] += -0.50000000 * np.einsum('oOaA,pCDR,RO,aAoB->pCDB',Hbar['aAaA'],c['IIA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += -0.50000000 * np.einsum('oOaA,pCDR,AB,aRoO->pCDB',Hbar['aAaA'],c['IIA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += -0.50000000 * np.einsum('oOaA,pCDR,aARoOB->pCDB',Hbar['aAaA'],c['IIA'],lambda3['aAAaAA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('oOaA,pCKR,RO,aAoB->pCKB',Hbar['aAaA'],c['ICA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('oOaA,pCKR,AB,aRoO->pCKB',Hbar['aAaA'],c['ICA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('oOaA,pCKR,aARoOB->pCKB',Hbar['aAaA'],c['ICA'],lambda3['aAAaAA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('oOaA,pCRE,BO,aAoR->pCBE',Hbar['aAaA'],c['IAV'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('oOaA,pCRE,AR,aBoO->pCBE',Hbar['aAaA'],c['IAV'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('oOaA,pCRE,aABoOR->pCBE',Hbar['aAaA'],c['IAV'],lambda3['aAAaAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pC,AB,aRoO->pCRB',Hbar['aAaA'],c['I'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pC,RO,aAoB->pCRB',Hbar['aAaA'],c['I'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pC,aARoOB->pCRB',Hbar['aAaA'],c['I'],lambda3['aAAaAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,ro,ab,AROB->pCRB',Hbar['aAaA'],c['aIa'],eta1['aa'],gamma1['aa'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pbCr,ro,RO,aAbB->pCRB',Hbar['aAaA'],c['aIa'],eta1['aa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,ro,aARbOB->pCRB',Hbar['aAaA'],c['aIa'],eta1['aa'],lambda3['aAAaAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,AB,ro,RO,ab->pCRB',Hbar['aAaA'],c['aIa'],eta1['AA'],eta1['aa'],gamma1['AA'],gamma1['aa'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,AB,ro,aRbO->pCRB',Hbar['aAaA'],c['aIa'],eta1['AA'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pbCr,AB,ab,rRoO->pCRB',Hbar['aAaA'],c['aIa'],eta1['AA'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,AB,RO,arob->pCRB',Hbar['aAaA'],c['aIa'],eta1['AA'],gamma1['AA'],lambda2['aaaa'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,AB,arRobO->pCRB',Hbar['aAaA'],c['aIa'],eta1['AA'],lambda3['aaAaaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pbCr,ab,rARoOB->pCRB',Hbar['aAaA'],c['aIa'],gamma1['aa'],lambda3['aAAaAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,RO,ab,rAoB->pCRB',Hbar['aAaA'],c['aIa'],gamma1['AA'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pbCr,RO,arAobB->pCRB',Hbar['aAaA'],c['aIa'],gamma1['AA'],lambda3['aaAaaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pbCr,aAbO,rRoB->pCRB',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,aRbO,rAoB->pCRB',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,rAbO,aRoB->pCRB',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pbCr,rRbO,aAoB->pCRB',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,aAbB,rRoO->pCRB',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pbCr,aRbB,rAoO->pCRB',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pbCr,rAbB,aRoO->pCRB',Hbar['aAaA'],c['aIa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,AROB,arob->pCRB',Hbar['aAaA'],c['aIa'],lambda2['AAAA'],lambda2['aaaa'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pbCr,arARobOB->pCRB',Hbar['aAaA'],c['aIa'],lambda4['aaAAaaAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,TO,AS,aRoB->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,TO,RS,aAoB->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,TO,aARoBS->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],lambda3['aAAaAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,AB,TO,aRoS->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,AB,RO,aToS->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,AB,RS,aToO->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,AB,aRToOS->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],lambda3['aAAaAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,TB,RO,aAoS->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,TB,AS,aRoO->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,TB,aARoOS->pCRB',Hbar['aAaA'],c['IAA'],eta1['AA'],lambda3['aAAaAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,RO,aAToBS->pCRB',Hbar['aAaA'],c['IAA'],gamma1['AA'],lambda3['aAAaAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,AS,RO,aToB->pCRB',Hbar['aAaA'],c['IAA'],gamma1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,AS,aRToOB->pCRB',Hbar['aAaA'],c['IAA'],gamma1['AA'],lambda3['aAAaAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,RS,aAToOB->pCRB',Hbar['aAaA'],c['IAA'],gamma1['AA'],lambda3['aAAaAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,AROB,aToS->pCRB',Hbar['aAaA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,ATOB,aRoS->pCRB',Hbar['aAaA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,RTOB,aAoS->pCRB',Hbar['aAaA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,AROS,aToB->pCRB',Hbar['aAaA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,ATOS,aRoB->pCRB',Hbar['aAaA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,RTOS,aAoB->pCRB',Hbar['aAaA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,ARBS,aToO->pCRB',Hbar['aAaA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('oOaA,pCST,ATBS,aRoO->pCRB',Hbar['aAaA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('oOaA,pCST,aARToOBS->pCRB',Hbar['aAaA'],c['IAA'],lambda4['aAAAaAAA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('CD,pcDe->pcCe',Hbar['II'],c['iIv'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('CD,pcDa,ao->pcCo',Hbar['II'],c['iIa'],eta1['aa'],optimize=True)
    sigma['cIv'] += -1.00000000 * np.einsum('CD,pkDe->pkCe',Hbar['II'],c['cIv'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('CD,pkDa,ao->pkCo',Hbar['II'],c['cIa'],eta1['aa'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('CD,paDe,oa->poCe',Hbar['II'],c['aIv'],gamma1['aa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('CD,pbDr,ro,ab->paCo',Hbar['II'],c['aIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('CD,pbDr,arob->paCo',Hbar['II'],c['aIa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('CD,pDOA,aAoO->paCo',Hbar['II'],c['IAA'],lambda2['aAaA'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('CD,pD->pC',Hbar['II'],c['I'],optimize=True)
    sigma['IIV'] += -1.00000000 * np.einsum('CD,pDIE->pCIE',Hbar['II'],c['IIV'],optimize=True)
    sigma['IIA'] += -1.00000000 * np.einsum('CD,pDIA,AO->pCIO',Hbar['II'],c['IIA'],eta1['AA'],optimize=True)
    sigma['ICV'] += -1.00000000 * np.einsum('CD,pDKE->pCKE',Hbar['II'],c['ICV'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('CD,pDKA,AO->pCKO',Hbar['II'],c['ICA'],eta1['AA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('CD,pDAE,OA->pCOE',Hbar['II'],c['IAV'],gamma1['AA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('CD,poDa,aAoO->pCAO',Hbar['II'],c['aIa'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('CD,pDBR,RO,AB->pCAO',Hbar['II'],c['IAA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('CD,pDBR,AROB->pCAO',Hbar['II'],c['IAA'],lambda2['AAAA'],optimize=True)
    sigma['iCv'] += -1.00000000 * np.einsum('KC,pcCe->pcKe',Hbar['CI'],c['iIv'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('KC,pcCa,ao->pcKo',Hbar['CI'],c['iIa'],eta1['aa'],optimize=True)
    sigma['ICV'] += +1.00000000 * np.einsum('KC,pCDE->pDKE',Hbar['CI'],c['IIV'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('KC,pCDA,AO->pDKO',Hbar['CI'],c['IIA'],eta1['AA'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('EC,pCDE->pD',Hbar['VI'],c['IIV'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('OC,pcCe,AO->pcAe',Hbar['AI'],c['iIv'],gamma1['AA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('OC,pcCa,ao,AO->pcAo',Hbar['AI'],c['iIa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('OC,pcCa,aAoO->pcAo',Hbar['AI'],c['iIa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('OC,pCDA,aAoO->paDo',Hbar['AI'],c['IIA'],lambda2['aAaA'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('OC,pCDA,AO->pD',Hbar['AI'],c['IIA'],eta1['AA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('OC,pCDE,AO->pDAE',Hbar['AI'],c['IIV'],gamma1['AA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('OC,pCDR,RA,BO->pDBA',Hbar['AI'],c['IIA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('OC,pCDR,BROA->pDBA',Hbar['AI'],c['IIA'],lambda2['AAAA'],optimize=True)
    sigma['IIV'] += +0.25000000 * np.einsum('CDIJ,pIJE->pCDE',Hbar['IIII'],c['IIV'],optimize=True)
    sigma['IIA'] += +0.25000000 * np.einsum('CDIJ,pIJA,AO->pCDO',Hbar['IIII'],c['IIA'],eta1['AA'],optimize=True)
    sigma['ICV'] += +0.50000000 * np.einsum('CKDI,pDIE->pCKE',Hbar['ICII'],c['IIV'],optimize=True)
    sigma['ICA'] += +0.50000000 * np.einsum('CKDI,pDIA,AO->pCKO',Hbar['ICII'],c['IIA'],eta1['AA'],optimize=True)
    sigma['I'] += -0.50000000 * np.einsum('CEDI,pDIE->pC',Hbar['IVII'],c['IIV'],optimize=True)
    sigma['aIa'] += -0.50000000 * np.einsum('CODI,pDIA,aAoO->paCo',Hbar['IAII'],c['IIA'],lambda2['aAaA'],optimize=True)
    sigma['I'] += -0.50000000 * np.einsum('CODI,pDIA,AO->pC',Hbar['IAII'],c['IIA'],eta1['AA'],optimize=True)
    sigma['IAV'] += +0.50000000 * np.einsum('CODI,pDIE,AO->pCAE',Hbar['IAII'],c['IIV'],gamma1['AA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('CODI,pDIR,RA,BO->pCBA',Hbar['IAII'],c['IIA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += -0.50000000 * np.einsum('CODI,pDIR,BROA->pCBA',Hbar['IAII'],c['IIA'],lambda2['AAAA'],optimize=True)
    sigma['IIV'] += +0.50000000 * np.einsum('CDIK,pIKE->pCDE',Hbar['IIIC'],c['ICV'],optimize=True)
    sigma['IIA'] += +0.50000000 * np.einsum('CDIK,pIKA,AO->pCDO',Hbar['IIIC'],c['ICA'],eta1['AA'],optimize=True)
    sigma['ICV'] += +1.00000000 * np.einsum('CKDL,pDLE->pCKE',Hbar['ICIC'],c['ICV'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('CKDL,pDLA,AO->pCKO',Hbar['ICIC'],c['ICA'],eta1['AA'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('CEDK,pDKE->pC',Hbar['IVIC'],c['ICV'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('CODK,pDKA,aAoO->paCo',Hbar['IAIC'],c['ICA'],lambda2['aAaA'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('CODK,pDKA,AO->pC',Hbar['IAIC'],c['ICA'],eta1['AA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('CODK,pDKE,AO->pCAE',Hbar['IAIC'],c['ICV'],gamma1['AA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('CODK,pDKR,RA,BO->pCBA',Hbar['IAIC'],c['ICA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('CODK,pDKR,BROA->pCBA',Hbar['IAIC'],c['ICA'],lambda2['AAAA'],optimize=True)
    sigma['IIV'] += -0.50000000 * np.einsum('CDIE,pI->pCDE',Hbar['IIIV'],c['I'],optimize=True)
    sigma['ICV'] += -1.00000000 * np.einsum('CKDE,pD->pCKE',Hbar['ICIV'],c['I'],optimize=True)
    sigma['IIV'] += -1.00000000 * np.einsum('CEDF,pDIE->pCIF',Hbar['IVIV'],c['IIV'],optimize=True)
    sigma['ICV'] += -1.00000000 * np.einsum('CEDF,pDKE->pCKF',Hbar['IVIV'],c['ICV'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('CEDF,pDAE,OA->pCOF',Hbar['IVIV'],c['IAV'],gamma1['AA'],optimize=True)
    sigma['IIV'] += -1.00000000 * np.einsum('CODE,pDIA,AO->pCIE',Hbar['IAIV'],c['IIA'],eta1['AA'],optimize=True)
    sigma['ICV'] += -1.00000000 * np.einsum('CODE,pDKA,AO->pCKE',Hbar['IAIV'],c['ICA'],eta1['AA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('CODE,pD,AO->pCAE',Hbar['IAIV'],c['I'],gamma1['AA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('CODE,poDa,aAoO->pCAE',Hbar['IAIV'],c['aIa'],lambda2['aAaA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('CODE,pDBR,RO,AB->pCAE',Hbar['IAIV'],c['IAA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('CODE,pDBR,AROB->pCAE',Hbar['IAIV'],c['IAA'],lambda2['AAAA'],optimize=True)
    sigma['ICV'] += +1.00000000 * np.einsum('KECF,pCDE->pDKF',Hbar['CVIV'],c['IIV'],optimize=True)
    sigma['ICV'] += +1.00000000 * np.einsum('KOCE,pCDA,AO->pDKE',Hbar['CAIV'],c['IIA'],eta1['AA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('EOCF,pCDE,AO->pDAF',Hbar['VAIV'],c['IIV'],gamma1['AA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('OACE,pCDR,RA,BO->pDBE',Hbar['AAIV'],c['IIA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAV'] += -0.50000000 * np.einsum('OACE,pCDR,BROA->pDBE',Hbar['AAIV'],c['IIA'],lambda2['AAAA'],optimize=True)
    sigma['IIV'] += +0.50000000 * np.einsum('CDIO,pIAE,OA->pCDE',Hbar['IIIA'],c['IAV'],gamma1['AA'],optimize=True)
    sigma['IIA'] += -0.50000000 * np.einsum('CDIO,pI,OA->pCDA',Hbar['IIIA'],c['I'],eta1['AA'],optimize=True)
    sigma['IIA'] += -0.50000000 * np.einsum('CDIO,poIa,aOoA->pCDA',Hbar['IIIA'],c['aIa'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += +0.50000000 * np.einsum('CDIO,pIBR,RA,OB->pCDA',Hbar['IIIA'],c['IAA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IIA'] += +0.50000000 * np.einsum('CDIO,pIBR,ORAB->pCDA',Hbar['IIIA'],c['IAA'],lambda2['AAAA'],optimize=True)
    sigma['ICV'] += +1.00000000 * np.einsum('CKDO,pDAE,OA->pCKE',Hbar['ICIA'],c['IAV'],gamma1['AA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('CKDO,pD,OA->pCKA',Hbar['ICIA'],c['I'],eta1['AA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('CKDO,poDa,aOoA->pCKA',Hbar['ICIA'],c['aIa'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('CKDO,pDBR,RA,OB->pCKA',Hbar['ICIA'],c['IAA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('CKDO,pDBR,ORAB->pCKA',Hbar['ICIA'],c['IAA'],lambda2['AAAA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('CEDO,pDAE,aOoA->paCo',Hbar['IVIA'],c['IAV'],lambda2['aAaA'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('CEDO,pDAE,OA->pC',Hbar['IVIA'],c['IAV'],gamma1['AA'],optimize=True)
    sigma['IIA'] += -1.00000000 * np.einsum('CEDO,pDIE,OA->pCIA',Hbar['IVIA'],c['IIV'],eta1['AA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('CEDO,pDKE,OA->pCKA',Hbar['IVIA'],c['ICV'],eta1['AA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('CEDO,pDRE,OA,BR->pCBA',Hbar['IVIA'],c['IAV'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('CEDO,pDRE,OBAR->pCBA',Hbar['IVIA'],c['IAV'],lambda2['AAAA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('CODA,pcDa,aAoO->pcCo',Hbar['IAIA'],c['iIa'],lambda2['aAaA'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('CODA,pkDa,aAoO->pkCo',Hbar['IAIA'],c['cIa'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += -1.00000000 * np.einsum('CODA,paDe,oAaO->poCe',Hbar['IAIA'],c['aIv'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('CODA,pD,aAoO->paCo',Hbar['IAIA'],c['I'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('CODA,pbDr,ro,aAbO->paCo',Hbar['IAIA'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('CODA,pbDr,ab,rAoO->paCo',Hbar['IAIA'],c['aIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('CODA,pbDr,arAobO->paCo',Hbar['IAIA'],c['aIa'],lambda3['aaAaaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('CODA,pDBR,RO,aAoB->paCo',Hbar['IAIA'],c['IAA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('CODA,pDBR,AB,aRoO->paCo',Hbar['IAIA'],c['IAA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('CODA,pDBR,aARoOB->paCo',Hbar['IAIA'],c['IAA'],lambda3['aAAaAA'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('CODA,poDa,aAoO->pC',Hbar['IAIA'],c['aIa'],lambda2['aAaA'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('CODA,pDBR,RO,AB->pC',Hbar['IAIA'],c['IAA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('CODA,pDBR,AROB->pC',Hbar['IAIA'],c['IAA'],lambda2['AAAA'],optimize=True)
    sigma['IIA'] += -1.00000000 * np.einsum('CODA,pDIR,AB,RO->pCIB',Hbar['IAIA'],c['IIA'],eta1['AA'],eta1['AA'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('CODA,pDIR,AROB->pCIB',Hbar['IAIA'],c['IIA'],lambda2['AAAA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('CODA,pDKR,AB,RO->pCKB',Hbar['IAIA'],c['ICA'],eta1['AA'],eta1['AA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('CODA,pDKR,AROB->pCKB',Hbar['IAIA'],c['ICA'],lambda2['AAAA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('CODA,pDRE,AR,BO->pCBE',Hbar['IAIA'],c['IAV'],gamma1['AA'],gamma1['AA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('CODA,pDRE,ABOR->pCBE',Hbar['IAIA'],c['IAV'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('CODA,pD,AB,RO->pCRB',Hbar['IAIA'],c['I'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('CODA,pD,AROB->pCRB',Hbar['IAIA'],c['I'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('CODA,poDa,AB,aRoO->pCRB',Hbar['IAIA'],c['aIa'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('CODA,poDa,RO,aAoB->pCRB',Hbar['IAIA'],c['aIa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('CODA,poDa,aARoOB->pCRB',Hbar['IAIA'],c['aIa'],lambda3['aAAaAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('CODA,pDST,TO,ARBS->pCRB',Hbar['IAIA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('CODA,pDST,AB,TO,RS->pCRB',Hbar['IAIA'],c['IAA'],eta1['AA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('CODA,pDST,AB,RTOS->pCRB',Hbar['IAIA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('CODA,pDST,TB,AS,RO->pCRB',Hbar['IAIA'],c['IAA'],eta1['AA'],gamma1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('CODA,pDST,TB,AROS->pCRB',Hbar['IAIA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('CODA,pDST,RO,ATBS->pCRB',Hbar['IAIA'],c['IAA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('CODA,pDST,AS,RTOB->pCRB',Hbar['IAIA'],c['IAA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('CODA,pDST,RS,ATOB->pCRB',Hbar['IAIA'],c['IAA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('CODA,pDST,ARTOBS->pCRB',Hbar['IAIA'],c['IAA'],lambda3['AAAAAA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('KECO,pCDE,OA->pDKA',Hbar['CVIA'],c['IIV'],eta1['AA'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('KOCA,pcCa,aAoO->pcKo',Hbar['CAIA'],c['iIa'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('KOCA,pCDR,AB,RO->pDKB',Hbar['CAIA'],c['IIA'],eta1['AA'],eta1['AA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('KOCA,pCDR,AROB->pDKB',Hbar['CAIA'],c['IIA'],lambda2['AAAA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('EOCA,pCDE,aAoO->paDo',Hbar['VAIA'],c['IIV'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('EOCA,pCDE,AB,RO->pDRB',Hbar['VAIA'],c['IIV'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('EOCA,pCDE,AROB->pDRB',Hbar['VAIA'],c['IIV'],lambda2['AAAA'],optimize=True)
    sigma['iAv'] += +0.50000000 * np.einsum('OACB,pcCe,BROA->pcRe',Hbar['AAIA'],c['iIv'],lambda2['AAAA'],optimize=True)
    sigma['iAa'] += +0.50000000 * np.einsum('OACB,pcCa,ao,BROA->pcRo',Hbar['AAIA'],c['iIa'],eta1['aa'],lambda2['AAAA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('OACB,pcCa,RA,aBoO->pcRo',Hbar['AAIA'],c['iIa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -0.50000000 * np.einsum('OACB,pcCa,aBRoOA->pcRo',Hbar['AAIA'],c['iIa'],lambda3['aAAaAA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('OACB,pCDR,RA,aBoO->paDo',Hbar['AAIA'],c['IIA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('OACB,pCDR,aBRoOA->paDo',Hbar['AAIA'],c['IIA'],lambda3['aAAaAA'],optimize=True)
    sigma['I'] += -0.50000000 * np.einsum('OACB,pCDR,BROA->pD',Hbar['AAIA'],c['IIA'],lambda2['AAAA'],optimize=True)
    sigma['IAV'] += -0.50000000 * np.einsum('OACB,pCDE,BROA->pDRE',Hbar['AAIA'],c['IIV'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('OACB,pCDT,TA,BSOR->pDSR',Hbar['AAIA'],c['IIA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('OACB,pCDT,BR,TA,SO->pDSR',Hbar['AAIA'],c['IIA'],eta1['AA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += -0.50000000 * np.einsum('OACB,pCDT,BR,STOA->pDSR',Hbar['AAIA'],c['IIA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -0.50000000 * np.einsum('OACB,pCDT,TR,BSOA->pDSR',Hbar['AAIA'],c['IIA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('OACB,pCDT,SO,BTAR->pDSR',Hbar['AAIA'],c['IIA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('OACB,pCDT,BSTOAR->pDSR',Hbar['AAIA'],c['IIA'],lambda3['AAAAAA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('CK,pcKe->pcCe',Hbar['IC'],c['iCv'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('CK,pcKa,ao->pcCo',Hbar['IC'],c['iCa'],eta1['aa'],optimize=True)
    sigma['IIV'] += +1.00000000 * np.einsum('CK,pDKE->pCDE',Hbar['IC'],c['ICV'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('CK,pDKA,AO->pCDO',Hbar['IC'],c['ICA'],eta1['AA'],optimize=True)
    sigma['iCv'] += -1.00000000 * np.einsum('KL,pcLe->pcKe',Hbar['CC'],c['iCv'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('KL,pcLa,ao->pcKo',Hbar['CC'],c['iCa'],eta1['aa'],optimize=True)
    sigma['ICV'] += -1.00000000 * np.einsum('KL,pCLE->pCKE',Hbar['CC'],c['ICV'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('KL,pCLA,AO->pCKO',Hbar['CC'],c['ICA'],eta1['AA'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('EK,pCKE->pC',Hbar['VC'],c['ICV'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('OK,pcKe,AO->pcAe',Hbar['AC'],c['iCv'],gamma1['AA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('OK,pcKa,ao,AO->pcAo',Hbar['AC'],c['iCa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('OK,pcKa,aAoO->pcAo',Hbar['AC'],c['iCa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('OK,pCKA,aAoO->paCo',Hbar['AC'],c['ICA'],lambda2['aAaA'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('OK,pCKA,AO->pC',Hbar['AC'],c['ICA'],eta1['AA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('OK,pCKE,AO->pCAE',Hbar['AC'],c['ICV'],gamma1['AA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('OK,pCKR,RA,BO->pCBA',Hbar['AC'],c['ICA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('OK,pCKR,BROA->pCBA',Hbar['AC'],c['ICA'],lambda2['AAAA'],optimize=True)
    sigma['IIV'] += +1.00000000 * np.einsum('CEKF,pDKE->pCDF',Hbar['IVCV'],c['ICV'],optimize=True)
    sigma['IIV'] += +1.00000000 * np.einsum('COKE,pDKA,AO->pCDE',Hbar['IACV'],c['ICA'],eta1['AA'],optimize=True)
    sigma['ICV'] += -1.00000000 * np.einsum('KELF,pCLE->pCKF',Hbar['CVCV'],c['ICV'],optimize=True)
    sigma['ICV'] += -1.00000000 * np.einsum('KOLE,pCLA,AO->pCKE',Hbar['CACV'],c['ICA'],eta1['AA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('EOKF,pCKE,AO->pCAF',Hbar['VACV'],c['ICV'],gamma1['AA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('OAKE,pCKR,RA,BO->pCBE',Hbar['AACV'],c['ICA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAV'] += +0.50000000 * np.einsum('OAKE,pCKR,BROA->pCBE',Hbar['AACV'],c['ICA'],lambda2['AAAA'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('CEKO,pDKE,OA->pCDA',Hbar['IVCA'],c['ICV'],eta1['AA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('COKA,pcKa,aAoO->pcCo',Hbar['IACA'],c['iCa'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('COKA,pDKR,AB,RO->pCDB',Hbar['IACA'],c['ICA'],eta1['AA'],eta1['AA'],optimize=True)
    sigma['IIA'] += -1.00000000 * np.einsum('COKA,pDKR,AROB->pCDB',Hbar['IACA'],c['ICA'],lambda2['AAAA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('KELO,pCLE,OA->pCKA',Hbar['CVCA'],c['ICV'],eta1['AA'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('KOLA,pcLa,aAoO->pcKo',Hbar['CACA'],c['iCa'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('KOLA,pCLR,AB,RO->pCKB',Hbar['CACA'],c['ICA'],eta1['AA'],eta1['AA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('KOLA,pCLR,AROB->pCKB',Hbar['CACA'],c['ICA'],lambda2['AAAA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('EOKA,pCKE,aAoO->paCo',Hbar['VACA'],c['ICV'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('EOKA,pCKE,AB,RO->pCRB',Hbar['VACA'],c['ICV'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('EOKA,pCKE,AROB->pCRB',Hbar['VACA'],c['ICV'],lambda2['AAAA'],optimize=True)
    sigma['iAv'] += +0.50000000 * np.einsum('OAKB,pcKe,BROA->pcRe',Hbar['AACA'],c['iCv'],lambda2['AAAA'],optimize=True)
    sigma['iAa'] += +0.50000000 * np.einsum('OAKB,pcKa,ao,BROA->pcRo',Hbar['AACA'],c['iCa'],eta1['aa'],lambda2['AAAA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('OAKB,pcKa,RA,aBoO->pcRo',Hbar['AACA'],c['iCa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -0.50000000 * np.einsum('OAKB,pcKa,aBRoOA->pcRo',Hbar['AACA'],c['iCa'],lambda3['aAAaAA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('OAKB,pCKR,RA,aBoO->paCo',Hbar['AACA'],c['ICA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -0.50000000 * np.einsum('OAKB,pCKR,aBRoOA->paCo',Hbar['AACA'],c['ICA'],lambda3['aAAaAA'],optimize=True)
    sigma['I'] += +0.50000000 * np.einsum('OAKB,pCKR,BROA->pC',Hbar['AACA'],c['ICA'],lambda2['AAAA'],optimize=True)
    sigma['IAV'] += +0.50000000 * np.einsum('OAKB,pCKE,BROA->pCRE',Hbar['AACA'],c['ICV'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('OAKB,pCKT,TA,BSOR->pCSR',Hbar['AACA'],c['ICA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('OAKB,pCKT,BR,TA,SO->pCSR',Hbar['AACA'],c['ICA'],eta1['AA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('OAKB,pCKT,BR,STOA->pCSR',Hbar['AACA'],c['ICA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('OAKB,pCKT,TR,BSOA->pCSR',Hbar['AACA'],c['ICA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('OAKB,pCKT,SO,BTAR->pCSR',Hbar['AACA'],c['ICA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -0.50000000 * np.einsum('OAKB,pCKT,BSTOAR->pCSR',Hbar['AACA'],c['ICA'],lambda3['AAAAAA'],optimize=True)
    sigma['IIV'] += -1.00000000 * np.einsum('CE,pD->pCDE',Hbar['IV'],c['I'],optimize=True)
    sigma['ICV'] += +1.00000000 * np.einsum('KE,pC->pCKE',Hbar['CV'],c['I'],optimize=True)
    sigma['IIV'] += +0.50000000 * np.einsum('EF,pCDE->pCDF',Hbar['VV'],c['IIV'],optimize=True)
    sigma['ICV'] += +1.00000000 * np.einsum('EF,pCKE->pCKF',Hbar['VV'],c['ICV'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('EF,pCAE,OA->pCOF',Hbar['VV'],c['IAV'],gamma1['AA'],optimize=True)
    sigma['IIV'] += +0.50000000 * np.einsum('OE,pCDA,AO->pCDE',Hbar['AV'],c['IIA'],eta1['AA'],optimize=True)
    sigma['ICV'] += +1.00000000 * np.einsum('OE,pCKA,AO->pCKE',Hbar['AV'],c['ICA'],eta1['AA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('OE,pC,AO->pCAE',Hbar['AV'],c['I'],gamma1['AA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('OE,poCa,aAoO->pCAE',Hbar['AV'],c['aIa'],lambda2['aAaA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('OE,pCBR,RO,AB->pCAE',Hbar['AV'],c['IAA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('OE,pCBR,AROB->pCAE',Hbar['AV'],c['IAA'],lambda2['AAAA'],optimize=True)
    sigma['IIV'] += -1.00000000 * np.einsum('CEFO,pDAE,OA->pCDF',Hbar['IVVA'],c['IAV'],gamma1['AA'],optimize=True)
    sigma['IIV'] += +1.00000000 * np.einsum('COEA,poDa,aAoO->pCDE',Hbar['IAVA'],c['aIa'],lambda2['aAaA'],optimize=True)
    sigma['IIV'] += -1.00000000 * np.einsum('COEA,pDBR,RO,AB->pCDE',Hbar['IAVA'],c['IAA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IIV'] += -1.00000000 * np.einsum('COEA,pDBR,AROB->pCDE',Hbar['IAVA'],c['IAA'],lambda2['AAAA'],optimize=True)
    sigma['ICV'] += +1.00000000 * np.einsum('KEFO,pCAE,OA->pCKF',Hbar['CVVA'],c['IAV'],gamma1['AA'],optimize=True)
    sigma['ICV'] += -1.00000000 * np.einsum('KOEA,poCa,aAoO->pCKE',Hbar['CAVA'],c['aIa'],lambda2['aAaA'],optimize=True)
    sigma['ICV'] += +1.00000000 * np.einsum('KOEA,pCBR,RO,AB->pCKE',Hbar['CAVA'],c['IAA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['ICV'] += +1.00000000 * np.einsum('KOEA,pCBR,AROB->pCKE',Hbar['CAVA'],c['IAA'],lambda2['AAAA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('EOFA,pCRE,AR,BO->pCBF',Hbar['VAVA'],c['IAV'],gamma1['AA'],gamma1['AA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('EOFA,pCRE,ABOR->pCBF',Hbar['VAVA'],c['IAV'],lambda2['AAAA'],optimize=True)
    sigma['IIV'] += +0.25000000 * np.einsum('OAEB,pCDR,BROA->pCDE',Hbar['AAVA'],c['IIA'],lambda2['AAAA'],optimize=True)
    sigma['ICV'] += +0.50000000 * np.einsum('OAEB,pCKR,BROA->pCKE',Hbar['AAVA'],c['ICA'],lambda2['AAAA'],optimize=True)
    sigma['IAV'] += -0.50000000 * np.einsum('OAEB,pC,BROA->pCRE',Hbar['AAVA'],c['I'],lambda2['AAAA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('OAEB,poCa,RO,aBoA->pCRE',Hbar['AAVA'],c['aIa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAV'] += +0.50000000 * np.einsum('OAEB,poCa,aBRoOA->pCRE',Hbar['AAVA'],c['aIa'],lambda3['aAAaAA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('OAEB,pCST,TA,BS,RO->pCRE',Hbar['AAVA'],c['IAA'],eta1['AA'],gamma1['AA'],gamma1['AA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('OAEB,pCST,TA,BROS->pCRE',Hbar['AAVA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('OAEB,pCST,RO,BTAS->pCRE',Hbar['AAVA'],c['IAA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAV'] += -0.50000000 * np.einsum('OAEB,pCST,BS,RTOA->pCRE',Hbar['AAVA'],c['IAA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAV'] += +0.50000000 * np.einsum('OAEB,pCST,RS,BTOA->pCRE',Hbar['AAVA'],c['IAA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAV'] += -0.50000000 * np.einsum('OAEB,pCST,BRTOAS->pCRE',Hbar['AAVA'],c['IAA'],lambda3['AAAAAA'],optimize=True)
    sigma['iIv'] += -1.00000000 * np.einsum('CO,pcAe,OA->pcCe',Hbar['IA'],c['iAv'],gamma1['AA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('CO,pcAa,ao,OA->pcCo',Hbar['IA'],c['iAa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('CO,pcAa,aOoA->pcCo',Hbar['IA'],c['iAa'],lambda2['aAaA'],optimize=True)
    sigma['IIV'] += +1.00000000 * np.einsum('CO,pDAE,OA->pCDE',Hbar['IA'],c['IAV'],gamma1['AA'],optimize=True)
    sigma['IIA'] += -1.00000000 * np.einsum('CO,pD,OA->pCDA',Hbar['IA'],c['I'],eta1['AA'],optimize=True)
    sigma['IIA'] += -1.00000000 * np.einsum('CO,poDa,aOoA->pCDA',Hbar['IA'],c['aIa'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('CO,pDBR,RA,OB->pCDA',Hbar['IA'],c['IAA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('CO,pDBR,ORAB->pCDA',Hbar['IA'],c['IAA'],lambda2['AAAA'],optimize=True)
    sigma['iCv'] += -1.00000000 * np.einsum('KO,pcAe,OA->pcKe',Hbar['CA'],c['iAv'],gamma1['AA'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('KO,pcAa,ao,OA->pcKo',Hbar['CA'],c['iAa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('KO,pcAa,aOoA->pcKo',Hbar['CA'],c['iAa'],lambda2['aAaA'],optimize=True)
    sigma['ICV'] += -1.00000000 * np.einsum('KO,pCAE,OA->pCKE',Hbar['CA'],c['IAV'],gamma1['AA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('KO,pC,OA->pCKA',Hbar['CA'],c['I'],eta1['AA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('KO,poCa,aOoA->pCKA',Hbar['CA'],c['aIa'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('KO,pCBR,RA,OB->pCKA',Hbar['CA'],c['IAA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('KO,pCBR,ORAB->pCKA',Hbar['CA'],c['IAA'],lambda2['AAAA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('EO,pCAE,aOoA->paCo',Hbar['VA'],c['IAV'],lambda2['aAaA'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('EO,pCAE,OA->pC',Hbar['VA'],c['IAV'],gamma1['AA'],optimize=True)
    sigma['IIA'] += +0.50000000 * np.einsum('EO,pCDE,OA->pCDA',Hbar['VA'],c['IIV'],eta1['AA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('EO,pCKE,OA->pCKA',Hbar['VA'],c['ICV'],eta1['AA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('EO,pCRE,OA,BR->pCBA',Hbar['VA'],c['IAV'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('EO,pCRE,OBAR->pCBA',Hbar['VA'],c['IAV'],lambda2['AAAA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('OA,pcCa,aAoO->pcCo',Hbar['AA'],c['iIa'],lambda2['aAaA'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('OA,pcKa,aAoO->pcKo',Hbar['AA'],c['iCa'],lambda2['aAaA'],optimize=True)
    sigma['iAv'] += -1.00000000 * np.einsum('OA,pcRe,AR,BO->pcBe',Hbar['AA'],c['iAv'],gamma1['AA'],gamma1['AA'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('OA,pcRe,ABOR->pcBe',Hbar['AA'],c['iAv'],lambda2['AAAA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('OA,pcRa,ao,AR,BO->pcBo',Hbar['AA'],c['iAa'],eta1['aa'],gamma1['AA'],gamma1['AA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('OA,pcRa,ao,ABOR->pcBo',Hbar['AA'],c['iAa'],eta1['aa'],lambda2['AAAA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('OA,pcRa,BO,aAoR->pcBo',Hbar['AA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('OA,pcRa,AR,aBoO->pcBo',Hbar['AA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('OA,pcRa,BR,aAoO->pcBo',Hbar['AA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('OA,pcRa,aABoOR->pcBo',Hbar['AA'],c['iAa'],lambda3['aAAaAA'],optimize=True)
    sigma['cIa'] += -1.00000000 * np.einsum('OA,pkCa,aAoO->pkCo',Hbar['AA'],c['cIa'],lambda2['aAaA'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('OA,paCe,oAaO->poCe',Hbar['AA'],c['aIv'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('OA,pC,aAoO->paCo',Hbar['AA'],c['I'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('OA,pbCr,ro,aAbO->paCo',Hbar['AA'],c['aIa'],eta1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('OA,pbCr,ab,rAoO->paCo',Hbar['AA'],c['aIa'],gamma1['aa'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('OA,pbCr,arAobO->paCo',Hbar['AA'],c['aIa'],lambda3['aaAaaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('OA,pCBR,RO,aAoB->paCo',Hbar['AA'],c['IAA'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('OA,pCBR,AB,aRoO->paCo',Hbar['AA'],c['IAA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('OA,pCBR,aARoOB->paCo',Hbar['AA'],c['IAA'],lambda3['aAAaAA'],optimize=True)
    sigma['I'] += -1.00000000 * np.einsum('OA,poCa,aAoO->pC',Hbar['AA'],c['aIa'],lambda2['aAaA'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('OA,pCBR,RO,AB->pC',Hbar['AA'],c['IAA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('OA,pCBR,AROB->pC',Hbar['AA'],c['IAA'],lambda2['AAAA'],optimize=True)
    sigma['IIA'] += +0.50000000 * np.einsum('OA,pCDR,AB,RO->pCDB',Hbar['AA'],c['IIA'],eta1['AA'],eta1['AA'],optimize=True)
    sigma['IIA'] += -0.50000000 * np.einsum('OA,pCDR,AROB->pCDB',Hbar['AA'],c['IIA'],lambda2['AAAA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('OA,pCKR,AB,RO->pCKB',Hbar['AA'],c['ICA'],eta1['AA'],eta1['AA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('OA,pCKR,AROB->pCKB',Hbar['AA'],c['ICA'],lambda2['AAAA'],optimize=True)
    sigma['IAV'] += -1.00000000 * np.einsum('OA,pCRE,AR,BO->pCBE',Hbar['AA'],c['IAV'],gamma1['AA'],gamma1['AA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('OA,pCRE,ABOR->pCBE',Hbar['AA'],c['IAV'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('OA,pC,AB,RO->pCRB',Hbar['AA'],c['I'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('OA,pC,AROB->pCRB',Hbar['AA'],c['I'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('OA,poCa,AB,aRoO->pCRB',Hbar['AA'],c['aIa'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('OA,poCa,RO,aAoB->pCRB',Hbar['AA'],c['aIa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('OA,poCa,aARoOB->pCRB',Hbar['AA'],c['aIa'],lambda3['aAAaAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('OA,pCST,TO,ARBS->pCRB',Hbar['AA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('OA,pCST,AB,TO,RS->pCRB',Hbar['AA'],c['IAA'],eta1['AA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('OA,pCST,AB,RTOS->pCRB',Hbar['AA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('OA,pCST,TB,AS,RO->pCRB',Hbar['AA'],c['IAA'],eta1['AA'],gamma1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('OA,pCST,TB,AROS->pCRB',Hbar['AA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('OA,pCST,RO,ATBS->pCRB',Hbar['AA'],c['IAA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('OA,pCST,AS,RTOB->pCRB',Hbar['AA'],c['IAA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('OA,pCST,RS,ATOB->pCRB',Hbar['AA'],c['IAA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('OA,pCST,ARTOBS->pCRB',Hbar['AA'],c['IAA'],lambda3['AAAAAA'],optimize=True)
    sigma['IIA'] += -1.00000000 * np.einsum('CEOA,pDRE,OB,AR->pCDB',Hbar['IVAA'],c['IAV'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IIA'] += +0.50000000 * np.einsum('CEOA,pDRE,OABR->pCDB',Hbar['IVAA'],c['IAV'],lambda2['AAAA'],optimize=True)
    sigma['iIv'] += +0.50000000 * np.einsum('COAB,pcRe,ABOR->pcCe',Hbar['IAAA'],c['iAv'],lambda2['AAAA'],optimize=True)
    sigma['iIa'] += +0.50000000 * np.einsum('COAB,pcRa,ao,ABOR->pcCo',Hbar['IAAA'],c['iAa'],eta1['aa'],lambda2['AAAA'],optimize=True)
    sigma['iIa'] += -1.00000000 * np.einsum('COAB,pcRa,BR,aAoO->pcCo',Hbar['IAAA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iIa'] += -0.50000000 * np.einsum('COAB,pcRa,aABoOR->pcCo',Hbar['IAAA'],c['iAa'],lambda3['aAAaAA'],optimize=True)
    sigma['IIV'] += -0.50000000 * np.einsum('COAB,pDRE,ABOR->pCDE',Hbar['IAAA'],c['IAV'],lambda2['AAAA'],optimize=True)
    sigma['IIA'] += -0.50000000 * np.einsum('COAB,pD,ABOR->pCDR',Hbar['IAAA'],c['I'],lambda2['AAAA'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('COAB,poDa,AR,aBoO->pCDR',Hbar['IAAA'],c['aIa'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IIA'] += +0.50000000 * np.einsum('COAB,poDa,aABoOR->pCDR',Hbar['IAAA'],c['aIa'],lambda3['aAAaAA'],optimize=True)
    sigma['IIA'] += +0.50000000 * np.einsum('COAB,pDST,TO,ABRS->pCDR',Hbar['IAAA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IIA'] += -1.00000000 * np.einsum('COAB,pDST,AR,TO,BS->pCDR',Hbar['IAAA'],c['IAA'],eta1['AA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IIA'] += -1.00000000 * np.einsum('COAB,pDST,AR,BTOS->pCDR',Hbar['IAAA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IIA'] += -0.50000000 * np.einsum('COAB,pDST,TR,ABOS->pCDR',Hbar['IAAA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IIA'] += +1.00000000 * np.einsum('COAB,pDST,BS,ATOR->pCDR',Hbar['IAAA'],c['IAA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IIA'] += -0.50000000 * np.einsum('COAB,pDST,ABTORS->pCDR',Hbar['IAAA'],c['IAA'],lambda3['AAAAAA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('KEOA,pCRE,OB,AR->pCKB',Hbar['CVAA'],c['IAV'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['ICA'] += -0.50000000 * np.einsum('KEOA,pCRE,OABR->pCKB',Hbar['CVAA'],c['IAV'],lambda2['AAAA'],optimize=True)
    sigma['iCv'] += +0.50000000 * np.einsum('KOAB,pcRe,ABOR->pcKe',Hbar['CAAA'],c['iAv'],lambda2['AAAA'],optimize=True)
    sigma['iCa'] += +0.50000000 * np.einsum('KOAB,pcRa,ao,ABOR->pcKo',Hbar['CAAA'],c['iAa'],eta1['aa'],lambda2['AAAA'],optimize=True)
    sigma['iCa'] += -1.00000000 * np.einsum('KOAB,pcRa,BR,aAoO->pcKo',Hbar['CAAA'],c['iAa'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iCa'] += -0.50000000 * np.einsum('KOAB,pcRa,aABoOR->pcKo',Hbar['CAAA'],c['iAa'],lambda3['aAAaAA'],optimize=True)
    sigma['ICV'] += +0.50000000 * np.einsum('KOAB,pCRE,ABOR->pCKE',Hbar['CAAA'],c['IAV'],lambda2['AAAA'],optimize=True)
    sigma['ICA'] += +0.50000000 * np.einsum('KOAB,pC,ABOR->pCKR',Hbar['CAAA'],c['I'],lambda2['AAAA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('KOAB,poCa,AR,aBoO->pCKR',Hbar['CAAA'],c['aIa'],eta1['AA'],lambda2['aAaA'],optimize=True)
    sigma['ICA'] += -0.50000000 * np.einsum('KOAB,poCa,aABoOR->pCKR',Hbar['CAAA'],c['aIa'],lambda3['aAAaAA'],optimize=True)
    sigma['ICA'] += -0.50000000 * np.einsum('KOAB,pCST,TO,ABRS->pCKR',Hbar['CAAA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('KOAB,pCST,AR,TO,BS->pCKR',Hbar['CAAA'],c['IAA'],eta1['AA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('KOAB,pCST,AR,BTOS->pCKR',Hbar['CAAA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['ICA'] += +0.50000000 * np.einsum('KOAB,pCST,TR,ABOS->pCKR',Hbar['CAAA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['ICA'] += -1.00000000 * np.einsum('KOAB,pCST,BS,ATOR->pCKR',Hbar['CAAA'],c['IAA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['ICA'] += +0.50000000 * np.einsum('KOAB,pCST,ABTORS->pCKR',Hbar['CAAA'],c['IAA'],lambda3['AAAAAA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('EOAB,pCRE,BR,aAoO->paCo',Hbar['VAAA'],c['IAV'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('EOAB,pCRE,aABoOR->paCo',Hbar['VAAA'],c['IAV'],lambda3['aAAaAA'],optimize=True)
    sigma['I'] += -0.50000000 * np.einsum('EOAB,pCRE,ABOR->pC',Hbar['VAAA'],c['IAV'],lambda2['AAAA'],optimize=True)
    sigma['IIA'] += +0.25000000 * np.einsum('EOAB,pCDE,ABOR->pCDR',Hbar['VAAA'],c['IIV'],lambda2['AAAA'],optimize=True)
    sigma['ICA'] += +0.50000000 * np.einsum('EOAB,pCKE,ABOR->pCKR',Hbar['VAAA'],c['ICV'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('EOAB,pCTE,AR,BT,SO->pCSR',Hbar['VAAA'],c['IAV'],eta1['AA'],gamma1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('EOAB,pCTE,BR,ASOT->pCSR',Hbar['VAAA'],c['IAV'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('EOAB,pCTE,SO,ABRT->pCSR',Hbar['VAAA'],c['IAV'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('EOAB,pCTE,BT,ASOR->pCSR',Hbar['VAAA'],c['IAV'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('EOAB,pCTE,ST,ABOR->pCSR',Hbar['VAAA'],c['IAV'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('EOAB,pCTE,ABSORT->pCSR',Hbar['VAAA'],c['IAV'],lambda3['AAAAAA'],optimize=True)
    sigma['iIa'] += -0.25000000 * np.einsum('OABR,pcCa,aBRoOA->pcCo',Hbar['AAAA'],c['iIa'],lambda3['aAAaAA'],optimize=True)
    sigma['iCa'] += -0.25000000 * np.einsum('OABR,pcKa,aBRoOA->pcKo',Hbar['AAAA'],c['iCa'],lambda3['aAAaAA'],optimize=True)
    sigma['iAv'] += +0.50000000 * np.einsum('OABR,pcTe,SO,BRAT->pcSe',Hbar['AAAA'],c['iAv'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['iAv'] += -0.50000000 * np.einsum('OABR,pcTe,RT,BSOA->pcSe',Hbar['AAAA'],c['iAv'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['iAv'] += +0.25000000 * np.einsum('OABR,pcTe,BRSOAT->pcSe',Hbar['AAAA'],c['iAv'],lambda3['AAAAAA'],optimize=True)
    sigma['iAa'] += +0.50000000 * np.einsum('OABR,pcTa,ao,SO,BRAT->pcSo',Hbar['AAAA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['iAa'] += -0.50000000 * np.einsum('OABR,pcTa,ao,RT,BSOA->pcSo',Hbar['AAAA'],c['iAa'],eta1['aa'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['iAa'] += +0.25000000 * np.einsum('OABR,pcTa,ao,BRSOAT->pcSo',Hbar['AAAA'],c['iAa'],eta1['aa'],lambda3['AAAAAA'],optimize=True)
    sigma['iAa'] += +0.50000000 * np.einsum('OABR,pcTa,SA,aBRoOT->pcSo',Hbar['AAAA'],c['iAa'],gamma1['AA'],lambda3['aAAaAA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('OABR,pcTa,RT,SA,aBoO->pcSo',Hbar['AAAA'],c['iAa'],gamma1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +0.50000000 * np.einsum('OABR,pcTa,RT,aBSoOA->pcSo',Hbar['AAAA'],c['iAa'],gamma1['AA'],lambda3['aAAaAA'],optimize=True)
    sigma['iAa'] += -0.25000000 * np.einsum('OABR,pcTa,ST,aBRoOA->pcSo',Hbar['AAAA'],c['iAa'],gamma1['AA'],lambda3['aAAaAA'],optimize=True)
    sigma['iAa'] += +0.50000000 * np.einsum('OABR,pcTa,BSOA,aRoT->pcSo',Hbar['AAAA'],c['iAa'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += +0.50000000 * np.einsum('OABR,pcTa,BROT,aSoA->pcSo',Hbar['AAAA'],c['iAa'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('OABR,pcTa,RSAT,aBoO->pcSo',Hbar['AAAA'],c['iAa'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
    sigma['iAa'] += -0.25000000 * np.einsum('OABR,pcTa,aBRSoOAT->pcSo',Hbar['AAAA'],c['iAa'],lambda4['aAAAaAAA'],optimize=True)
    sigma['cIa'] += -0.25000000 * np.einsum('OABR,pkCa,aBRoOA->pkCo',Hbar['AAAA'],c['cIa'],lambda3['aAAaAA'],optimize=True)
    sigma['aIv'] += +0.25000000 * np.einsum('OABR,paCe,oBRaOA->poCe',Hbar['AAAA'],c['aIv'],lambda3['aAAaAA'],optimize=True)
    sigma['aIa'] += -0.25000000 * np.einsum('OABR,pC,aBRoOA->paCo',Hbar['AAAA'],c['I'],lambda3['aAAaAA'],optimize=True)
    sigma['aIa'] += +0.25000000 * np.einsum('OABR,pbCr,ro,aBRbOA->paCo',Hbar['AAAA'],c['aIa'],eta1['aa'],lambda3['aAAaAA'],optimize=True)
    sigma['aIa'] += -0.25000000 * np.einsum('OABR,pbCr,ab,rBRoOA->paCo',Hbar['AAAA'],c['aIa'],gamma1['aa'],lambda3['aAAaAA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('OABR,pbCr,aBbO,rRoA->paCo',Hbar['AAAA'],c['aIa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('OABR,pbCr,rRbA,aBoO->paCo',Hbar['AAAA'],c['aIa'],lambda2['aAaA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +0.25000000 * np.einsum('OABR,pbCr,arBRobOA->paCo',Hbar['AAAA'],c['aIa'],lambda4['aaAAaaAA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('OABR,pCST,TA,RS,aBoO->paCo',Hbar['AAAA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -0.50000000 * np.einsum('OABR,pCST,TA,aBRoOS->paCo',Hbar['AAAA'],c['IAA'],eta1['AA'],lambda3['aAAaAA'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('OABR,pCST,RS,aBToOA->paCo',Hbar['AAAA'],c['IAA'],gamma1['AA'],lambda3['aAAaAA'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('OABR,pCST,BTOA,aRoS->paCo',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += +0.50000000 * np.einsum('OABR,pCST,BROS,aToA->paCo',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('OABR,pCST,RTAS,aBoO->paCo',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
    sigma['aIa'] += -0.25000000 * np.einsum('OABR,pCST,aBRToOAS->paCo',Hbar['AAAA'],c['IAA'],lambda4['aAAAaAAA'],optimize=True)
    sigma['I'] += -0.25000000 * np.einsum('OABR,poCa,aBRoOA->pC',Hbar['AAAA'],c['aIa'],lambda3['aAAaAA'],optimize=True)
    sigma['I'] += +0.50000000 * np.einsum('OABR,pCST,TA,BROS->pC',Hbar['AAAA'],c['IAA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['I'] += -0.50000000 * np.einsum('OABR,pCST,RS,BTOA->pC',Hbar['AAAA'],c['IAA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['I'] += +0.25000000 * np.einsum('OABR,pCST,BRTOAS->pC',Hbar['AAAA'],c['IAA'],lambda3['AAAAAA'],optimize=True)
    sigma['IIA'] += -0.25000000 * np.einsum('OABR,pCDT,TA,BROS->pCDS',Hbar['AAAA'],c['IIA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IIA'] += +0.25000000 * np.einsum('OABR,pCDT,BS,RTOA->pCDS',Hbar['AAAA'],c['IIA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IIA'] += -0.12500000 * np.einsum('OABR,pCDT,BRTOAS->pCDS',Hbar['AAAA'],c['IIA'],lambda3['AAAAAA'],optimize=True)
    sigma['ICA'] += -0.50000000 * np.einsum('OABR,pCKT,TA,BROS->pCKS',Hbar['AAAA'],c['ICA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['ICA'] += +0.50000000 * np.einsum('OABR,pCKT,BS,RTOA->pCKS',Hbar['AAAA'],c['ICA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['ICA'] += -0.25000000 * np.einsum('OABR,pCKT,BRTOAS->pCKS',Hbar['AAAA'],c['ICA'],lambda3['AAAAAA'],optimize=True)
    sigma['IAV'] += +0.50000000 * np.einsum('OABR,pCTE,SO,BRAT->pCSE',Hbar['AAAA'],c['IAV'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAV'] += -0.50000000 * np.einsum('OABR,pCTE,RT,BSOA->pCSE',Hbar['AAAA'],c['IAV'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAV'] += +0.25000000 * np.einsum('OABR,pCTE,BRSOAT->pCSE',Hbar['AAAA'],c['IAV'],lambda3['AAAAAA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('OABR,pC,RS,BTOA->pCTS',Hbar['AAAA'],c['I'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('OABR,pC,TO,BRAS->pCTS',Hbar['AAAA'],c['I'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +0.25000000 * np.einsum('OABR,pC,BRTOAS->pCTS',Hbar['AAAA'],c['I'],lambda3['AAAAAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('OABR,poCa,BS,TO,aRoA->pCTS',Hbar['AAAA'],c['aIa'],eta1['AA'],gamma1['AA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -0.50000000 * np.einsum('OABR,poCa,RS,aBToOA->pCTS',Hbar['AAAA'],c['aIa'],eta1['AA'],lambda3['aAAaAA'],optimize=True)
    sigma['IAA'] += -0.50000000 * np.einsum('OABR,poCa,TO,aBRoAS->pCTS',Hbar['AAAA'],c['aIa'],gamma1['AA'],lambda3['aAAaAA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('OABR,poCa,BTOA,aRoS->pCTS',Hbar['AAAA'],c['aIa'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('OABR,poCa,BROS,aToA->pCTS',Hbar['AAAA'],c['aIa'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('OABR,poCa,BTOS,aRoA->pCTS',Hbar['AAAA'],c['aIa'],lambda2['AAAA'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += -0.25000000 * np.einsum('OABR,poCa,aBRToOAS->pCTS',Hbar['AAAA'],c['aIa'],lambda4['aAAAaAAA'],optimize=True)
    sigma['IAA'] += -0.50000000 * np.einsum('OABR,pCUV,VA,TO,BRSU->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('OABR,pCUV,VA,RU,BTOS->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -0.50000000 * np.einsum('OABR,pCUV,VA,TU,BROS->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -0.50000000 * np.einsum('OABR,pCUV,VA,BRTOSU->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],lambda3['AAAAAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('OABR,pCUV,BS,VA,RU,TO->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],eta1['AA'],gamma1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('OABR,pCUV,BS,TO,RVAU->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -0.50000000 * np.einsum('OABR,pCUV,BS,RU,TVOA->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('OABR,pCUV,BS,TU,RVOA->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('OABR,pCUV,RS,VA,BTOU->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],eta1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('OABR,pCUV,RS,BTVOAU->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],lambda3['AAAAAA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('OABR,pCUV,VS,TO,BRAU->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -0.50000000 * np.einsum('OABR,pCUV,VS,RU,BTOA->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +0.25000000 * np.einsum('OABR,pCUV,VS,BRTOAU->pCTS',Hbar['AAAA'],c['IAA'],eta1['AA'],lambda3['AAAAAA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('OABR,pCUV,TO,BRVASU->pCTS',Hbar['AAAA'],c['IAA'],gamma1['AA'],lambda3['AAAAAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('OABR,pCUV,RU,TO,BVAS->pCTS',Hbar['AAAA'],c['IAA'],gamma1['AA'],gamma1['AA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('OABR,pCUV,RU,BTVOAS->pCTS',Hbar['AAAA'],c['IAA'],gamma1['AA'],lambda3['AAAAAA'],optimize=True)
    sigma['IAA'] += -0.25000000 * np.einsum('OABR,pCUV,TU,BRVOAS->pCTS',Hbar['AAAA'],c['IAA'],gamma1['AA'],lambda3['AAAAAA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('OABR,pCUV,BROU,TVAS->pCTS',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('OABR,pCUV,BTOU,RVAS->pCTS',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('OABR,pCUV,RVAU,BTOS->pCTS',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -0.50000000 * np.einsum('OABR,pCUV,TVAU,BROS->pCTS',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +0.25000000 * np.einsum('OABR,pCUV,BRSU,TVOA->pCTS',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +0.50000000 * np.einsum('OABR,pCUV,RTSU,BVOA->pCTS',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += -0.50000000 * np.einsum('OABR,pCUV,RVSU,BTOA->pCTS',Hbar['AAAA'],c['IAA'],lambda2['AAAA'],lambda2['AAAA'],optimize=True)
    sigma['IAA'] += +0.25000000 * np.einsum('OABR,pCUV,BRTVOASU->pCTS',Hbar['AAAA'],c['IAA'],lambda4['AAAAAAAA'],optimize=True)
    return sigma

def build_sigma_vector_s(einsum, c, Hbar, gamma1, eta1, lambda2, lambda3, lambda4, first_row):
    sigma = {key: np.zeros(c[key].shape) for key in c.keys()}
    sigma['iIv'] += +1.00000000 * np.einsum('pcCe->pcCe',c['iIv'],optimize=True)
    sigma['iIa'] += +1.00000000 * np.einsum('pcCa,ao->pcCo',c['iIa'],eta1['aa'],optimize=True)
    sigma['iCv'] += +1.00000000 * np.einsum('pcKe->pcKe',c['iCv'],optimize=True)
    sigma['iCa'] += +1.00000000 * np.einsum('pcKa,ao->pcKo',c['iCa'],eta1['aa'],optimize=True)
    sigma['iAv'] += +1.00000000 * np.einsum('pcAe,OA->pcOe',c['iAv'],gamma1['AA'],optimize=True)
    sigma['iAa'] += +1.00000000 * np.einsum('pcAa,ao,OA->pcOo',c['iAa'],eta1['aa'],gamma1['AA'],optimize=True)
    sigma['iAa'] += -1.00000000 * np.einsum('pcAa,aOoA->pcOo',c['iAa'],lambda2['aAaA'],optimize=True)
    sigma['cIv'] += +1.00000000 * np.einsum('pkCe->pkCe',c['cIv'],optimize=True)
    sigma['cIa'] += +1.00000000 * np.einsum('pkCa,ao->pkCo',c['cIa'],eta1['aa'],optimize=True)
    sigma['aIv'] += +1.00000000 * np.einsum('paCe,oa->poCe',c['aIv'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('pbCr,ro,ab->paCo',c['aIa'],eta1['aa'],gamma1['aa'],optimize=True)
    sigma['aIa'] += +1.00000000 * np.einsum('pbCr,arob->paCo',c['aIa'],lambda2['aaaa'],optimize=True)
    sigma['aIa'] += -1.00000000 * np.einsum('pCOA,aAoO->paCo',c['IAA'],lambda2['aAaA'],optimize=True)
    sigma['I'] += +1.00000000 * np.einsum('pC->pC',c['I'],optimize=True)
    sigma['IIV'] += +0.50000000 * np.einsum('pCDE->pCDE',c['IIV'],optimize=True)
    sigma['IIA'] += +0.50000000 * np.einsum('pCDA,AO->pCDO',c['IIA'],eta1['AA'],optimize=True)
    sigma['ICV'] += +1.00000000 * np.einsum('pCKE->pCKE',c['ICV'],optimize=True)
    sigma['ICA'] += +1.00000000 * np.einsum('pCKA,AO->pCKO',c['ICA'],eta1['AA'],optimize=True)
    sigma['IAV'] += +1.00000000 * np.einsum('pCAE,OA->pCOE',c['IAV'],gamma1['AA'],optimize=True)
    sigma['IAA'] += -1.00000000 * np.einsum('poCa,aAoO->pCAO',c['aIa'],lambda2['aAaA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('pCBR,RO,AB->pCAO',c['IAA'],eta1['AA'],gamma1['AA'],optimize=True)
    sigma['IAA'] += +1.00000000 * np.einsum('pCBR,AROB->pCAO',c['IAA'],lambda2['AAAA'],optimize=True)
    return sigma

def build_sigma_vector_p(einsum, c, Hbar, gamma1, eta1, lambda2, lambda3, lambda4, first_row):
    sigma = {key: np.zeros(c[key].shape) for key in c.keys()}
    sigma['I'] += +1.00000000 * np.einsum('pC->pC',c['I'],optimize=True)
    return sigma

def apply_S12(eom_dsrg, ndim, t, transpose=False):
    Xt = np.zeros((ndim, 1))
    i_start_xt = 0
    i_start_t = 0

    template = eom_dsrg.template_c
    num_op, num_ortho = eom_dsrg.S12.ICA.shape
    i_end_xt, i_end_t = i_start_xt + (num_op if not transpose else num_ortho), i_start_t + (num_ortho if not transpose else num_op)
    Xt[i_start_xt:i_end_xt, :] += (eom_dsrg.S12.ICA @ t[i_start_t:i_end_t].reshape(-1, 1) if not transpose else eom_dsrg.S12.ICA.T @ t[i_start_t:i_end_t].reshape(-1, 1))
    i_start_xt, i_start_t = i_end_xt, i_end_t
    num_op, num_ortho = eom_dsrg.S12.IIA.shape
    i_end_xt, i_end_t = i_start_xt + (num_op if not transpose else num_ortho), i_start_t + (num_ortho if not transpose else num_op)
    Xt[i_start_xt:i_end_xt, :] += (eom_dsrg.S12.IIA @ t[i_start_t:i_end_t].reshape(-1, 1) if not transpose else eom_dsrg.S12.IIA.T @ t[i_start_t:i_end_t].reshape(-1, 1))
    i_start_xt, i_start_t = i_end_xt, i_end_t
    num_op, num_ortho = eom_dsrg.S12.I.shape
    i_end_xt, i_end_t = i_start_xt + (num_op if not transpose else num_ortho), i_start_t + (num_ortho if not transpose else num_op)
    Xt[i_start_xt:i_end_xt, :] += (eom_dsrg.S12.I @ t[i_start_t:i_end_t].reshape(-1, 1) if not transpose else eom_dsrg.S12.I.T @ t[i_start_t:i_end_t].reshape(-1, 1))
    i_start_xt, i_start_t = i_end_xt, i_end_t
    num_op, num_ortho = eom_dsrg.S12.IAV.shape
    i_end_xt, i_end_t = i_start_xt + (num_op if not transpose else num_ortho), i_start_t + (num_ortho if not transpose else num_op)
    Xt[i_start_xt:i_end_xt, :] += (eom_dsrg.S12.IAV @ t[i_start_t:i_end_t].reshape(-1, 1) if not transpose else eom_dsrg.S12.IAV.T @ t[i_start_t:i_end_t].reshape(-1, 1))
    i_start_xt, i_start_t = i_end_xt, i_end_t
    num_op, num_ortho = eom_dsrg.S12.ICV.shape
    i_end_xt, i_end_t = i_start_xt + (num_op if not transpose else num_ortho), i_start_t + (num_ortho if not transpose else num_op)
    Xt[i_start_xt:i_end_xt, :] += (eom_dsrg.S12.ICV @ t[i_start_t:i_end_t].reshape(-1, 1) if not transpose else eom_dsrg.S12.ICV.T @ t[i_start_t:i_end_t].reshape(-1, 1))
    i_start_xt, i_start_t = i_end_xt, i_end_t
    num_op, num_ortho = eom_dsrg.S12.IIV.shape
    i_end_xt, i_end_t = i_start_xt + (num_op if not transpose else num_ortho), i_start_t + (num_ortho if not transpose else num_op)
    Xt[i_start_xt:i_end_xt, :] += (eom_dsrg.S12.IIV @ t[i_start_t:i_end_t].reshape(-1, 1) if not transpose else eom_dsrg.S12.IIV.T @ t[i_start_t:i_end_t].reshape(-1, 1))
    i_start_xt, i_start_t = i_end_xt, i_end_t
    num_op, num_ortho = eom_dsrg.S12.iAa.shape
    i_end_xt, i_end_t = i_start_xt + (num_op if not transpose else num_ortho), i_start_t + (num_ortho if not transpose else num_op)
    Xt[i_start_xt:i_end_xt, :] += (eom_dsrg.S12.iAa @ t[i_start_t:i_end_t].reshape(-1, 1) if not transpose else eom_dsrg.S12.iAa.T @ t[i_start_t:i_end_t].reshape(-1, 1))
    i_start_xt, i_start_t = i_end_xt, i_end_t
    num_op, num_ortho = eom_dsrg.S12.iCa.shape
    i_end_xt, i_end_t = i_start_xt + (num_op if not transpose else num_ortho), i_start_t + (num_ortho if not transpose else num_op)
    Xt[i_start_xt:i_end_xt, :] += (eom_dsrg.S12.iCa @ t[i_start_t:i_end_t].reshape(-1, 1) if not transpose else eom_dsrg.S12.iCa.T @ t[i_start_t:i_end_t].reshape(-1, 1))
    i_start_xt, i_start_t = i_end_xt, i_end_t
    num_op, num_ortho = eom_dsrg.S12.cIa.shape
    i_end_xt, i_end_t = i_start_xt + (num_op if not transpose else num_ortho), i_start_t + (num_ortho if not transpose else num_op)
    Xt[i_start_xt:i_end_xt, :] += (eom_dsrg.S12.cIa @ t[i_start_t:i_end_t].reshape(-1, 1) if not transpose else eom_dsrg.S12.cIa.T @ t[i_start_t:i_end_t].reshape(-1, 1))
    i_start_xt, i_start_t = i_end_xt, i_end_t
    num_op, num_ortho = eom_dsrg.S12.iIa.shape
    i_end_xt, i_end_t = i_start_xt + (num_op if not transpose else num_ortho), i_start_t + (num_ortho if not transpose else num_op)
    Xt[i_start_xt:i_end_xt, :] += (eom_dsrg.S12.iIa @ t[i_start_t:i_end_t].reshape(-1, 1) if not transpose else eom_dsrg.S12.iIa.T @ t[i_start_t:i_end_t].reshape(-1, 1))
    i_start_xt, i_start_t = i_end_xt, i_end_t
    num_op, num_ortho = eom_dsrg.S12.iAv.shape
    i_end_xt, i_end_t = i_start_xt + (num_op if not transpose else num_ortho), i_start_t + (num_ortho if not transpose else num_op)
    Xt[i_start_xt:i_end_xt, :] += (eom_dsrg.S12.iAv @ t[i_start_t:i_end_t].reshape(-1, 1) if not transpose else eom_dsrg.S12.iAv.T @ t[i_start_t:i_end_t].reshape(-1, 1))
    i_start_xt, i_start_t = i_end_xt, i_end_t
    num_op, num_ortho = eom_dsrg.S12.iCv.shape
    i_end_xt, i_end_t = i_start_xt + (num_op if not transpose else num_ortho), i_start_t + (num_ortho if not transpose else num_op)
    Xt[i_start_xt:i_end_xt, :] += (eom_dsrg.S12.iCv @ t[i_start_t:i_end_t].reshape(-1, 1) if not transpose else eom_dsrg.S12.iCv.T @ t[i_start_t:i_end_t].reshape(-1, 1))
    i_start_xt, i_start_t = i_end_xt, i_end_t
    num_op, num_ortho = eom_dsrg.S12.aIv.shape
    i_end_xt, i_end_t = i_start_xt + (num_op if not transpose else num_ortho), i_start_t + (num_ortho if not transpose else num_op)
    Xt[i_start_xt:i_end_xt, :] += (eom_dsrg.S12.aIv @ t[i_start_t:i_end_t].reshape(-1, 1) if not transpose else eom_dsrg.S12.aIv.T @ t[i_start_t:i_end_t].reshape(-1, 1))
    i_start_xt, i_start_t = i_end_xt, i_end_t
    num_op, num_ortho = eom_dsrg.S12.cIv.shape
    i_end_xt, i_end_t = i_start_xt + (num_op if not transpose else num_ortho), i_start_t + (num_ortho if not transpose else num_op)
    Xt[i_start_xt:i_end_xt, :] += (eom_dsrg.S12.cIv @ t[i_start_t:i_end_t].reshape(-1, 1) if not transpose else eom_dsrg.S12.cIv.T @ t[i_start_t:i_end_t].reshape(-1, 1))
    i_start_xt, i_start_t = i_end_xt, i_end_t
    num_op, num_ortho = eom_dsrg.S12.iIv.shape
    i_end_xt, i_end_t = i_start_xt + (num_op if not transpose else num_ortho), i_start_t + (num_ortho if not transpose else num_op)
    Xt[i_start_xt:i_end_xt, :] += (eom_dsrg.S12.iIv @ t[i_start_t:i_end_t].reshape(-1, 1) if not transpose else eom_dsrg.S12.iIv.T @ t[i_start_t:i_end_t].reshape(-1, 1))
    i_start_xt, i_start_t = i_end_xt, i_end_t
    num_op, num_ortho = eom_dsrg.S12.IAA.shape
    i_end_xt, i_end_t = i_start_xt + (num_op if not transpose else num_ortho), i_start_t + (num_ortho if not transpose else num_op)
    Xt[i_start_xt:i_end_xt, :] += (eom_dsrg.S12.IAA @ t[i_start_t:i_end_t].reshape(-1, 1) if not transpose else eom_dsrg.S12.IAA.T @ t[i_start_t:i_end_t].reshape(-1, 1))
    i_start_xt, i_start_t = i_end_xt, i_end_t
    return Xt

build_first_row = NotImplemented
build_transition_dipole = NotImplemented
